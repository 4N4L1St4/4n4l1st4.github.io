---
title: "Blue Team: O que Ã© Blue Team ?"
date: 2025-06-26 16:30:00 -0300
categories: [Blue Team, Nivel 1]
tags: [Teorica]
description: ""
image:
  path: /assets/img/000/capa.webp
  alt: IlustraÃ§Ã£o de um computador moderno com elementos de cÃ³digo e processamento
---

# ğŸ”µ 1. Blue Team: IntroduÃ§Ã£o Ã  SeguranÃ§a da InformaÃ§Ã£o

A atuaÃ§Ã£o de um profissional de Blue Team comeÃ§a com a compreensÃ£o dos **fundamentos da SeguranÃ§a da InformaÃ§Ã£o**. Nesta introduÃ§Ã£o, vocÃª vai entender os pilares CIA, os tipos de ameaÃ§as, os riscos associados e os principais controles de proteÃ§Ã£o utilizados para manter os ambientes seguros.

NÃ£o hÃ¡ defesa eficaz sem entender o que estamos tentando proteger.

## ğŸ” O que Ã© SeguranÃ§a da InformaÃ§Ã£o?

SeguranÃ§a da InformaÃ§Ã£o Ã© o conjunto de prÃ¡ticas, polÃ­ticas e processos voltados para proteger dados e sistemas contra acessos nÃ£o autorizados, danos, vazamentos e interrupÃ§Ãµes.


## ğŸ§± PrincÃ­pios Fundamentais â€“ Modelo **CIA**

O modelo CIA representa os **trÃªs pilares essenciais da seguranÃ§a**:

- **C â€“ Confidencialidade (Confidentiality):**  
  Garante que as informaÃ§Ãµes sejam acessadas apenas por pessoas autorizadas.  
  *Ex: Criptografia, autenticaÃ§Ã£o de dois fatores.*

- **I â€“ Integridade (Integrity):**  
  Assegura que os dados nÃ£o sejam alterados indevidamente, mantendo sua exatidÃ£o e confiabilidade.  
  *Ex: Checksums, logs de auditoria, controle de versÃµes.*

- **A â€“ Disponibilidade (Availability):**  
  Garante que os sistemas e dados estejam disponÃ­veis sempre que necessÃ¡rio.  
  *Ex: Backup, balanceamento de carga, redundÃ¢ncia.*


## âš ï¸ Tipos Comuns de AmeaÃ§as

Uma **ameaÃ§a** Ã© qualquer evento ou agente que tenha o potencial de causar dano Ã  informaÃ§Ã£o ou aos sistemas.

- **Malwares:** vÃ­rus, worms, trojans, ransomware  
- **Ataques de rede:** DDoS, sniffing, spoofing  
- **AmeaÃ§as internas:** usuÃ¡rios mal-intencionados ou negligentes  
- **Phishing e engenharia social**  
- **Vulnerabilidades exploradas (zero-day, exploits)**


## ğŸ¯ Risco em SeguranÃ§a

**Risco = AmeaÃ§a Ã— Vulnerabilidade Ã— Impacto**

O risco Ã© a **probabilidade de um incidente ocorrer**, levando em conta a existÃªncia de vulnerabilidades e o impacto que isso pode gerar.

*Exemplo:*  
Um servidor exposto Ã  internet sem patch Ã© uma vulnerabilidade. Se uma ameaÃ§a conhecida explorar essa falha, o risco Ã© elevado.


## ğŸ›¡ï¸ Controles de SeguranÃ§a

Os **controles** sÃ£o mecanismos implementados para reduzir riscos, prevenir, detectar ou responder a incidentes.

### ğŸ”’ Tipos de Controles:

- **Preventivos:** impedem que incidentes ocorram  
  *Ex: Firewall, autenticaÃ§Ã£o multifator, polÃ­ticas de senha*

- **Detectivos:** identificam que algo estÃ¡ acontecendo  
  *Ex: SIEM, IDS, logs, alertas*

- **Corretivos:** minimizam o dano apÃ³s um incidente  
  *Ex: Backup, plano de resposta a incidentes, restauraÃ§Ã£o de sistemas*

- **Deterrentes:** desestimulam aÃ§Ãµes maliciosas  
  *Ex: CÃ¢meras, avisos de monitoramento, polÃ­ticas visÃ­veis*


## ğŸ§  Por que isso Ã© importante para o Blue Team?

Um analista Blue Team deve conhecer profundamente esses fundamentos para:

- Compreender e classificar incidentes de forma adequada  
- Escolher os controles certos para cada tipo de risco  
- Monitorar eventos com foco em ameaÃ§as reais  
- Aplicar boas prÃ¡ticas com base no modelo CIA

# ğŸ”µ 2. O que Ã© Blue Team?

O **Blue Team** Ã© o grupo responsÃ¡vel pela **defesa cibernÃ©tica** de uma organizaÃ§Ã£o. Sua missÃ£o Ã© proteger sistemas, redes, aplicaÃ§Ãµes e dados contra ameaÃ§as internas e externas, detectando, respondendo e mitigando ataques em tempo real.


## ğŸ¯ Objetivo

Garantir a **resiliÃªncia e seguranÃ§a contÃ­nua** do ambiente de TI, monitorando atividades, detectando anomalias e **respondendo rapidamente a incidentes de seguranÃ§a**.

Enquanto o Red Team pensa como o inimigo, o Blue Team protege como um guardiÃ£o incansÃ¡vel.

## ğŸ›¡ï¸ Atividades Comuns

- Monitoramento contÃ­nuo de redes e sistemas  
- AnÃ¡lise e correlaÃ§Ã£o de logs (com SIEMs)  
- DetecÃ§Ã£o e resposta a incidentes (SOC, CSIRT)  
- Threat Hunting (busca ativa por ameaÃ§as)  
- AplicaÃ§Ã£o de patches e hardening de sistemas  
- GestÃ£o de vulnerabilidades  
- AnÃ¡lise de malwares e forense digital  
- ImplementaÃ§Ã£o de polÃ­ticas e controles de seguranÃ§a  


## ğŸ”„ Ciclo de Trabalho

1. **Monitorar** (com ferramentas como SIEM e EDR)  
2. **Detectar** comportamentos anÃ´malos  
3. **Responder** a incidentes rapidamente  
4. **Recuperar** sistemas afetados  
5. **Aprimorar** defesas com base no aprendizado


## ğŸ§  Perfis do Time

- Analista SOC (nÃ­veis 1, 2 e 3)  
- Analista de Resposta a Incidentes (CSIRT)  
- Threat Hunter  
- Especialista em Forense  
- Blue Team Engineer / Security Analyst  
- Profissionais com certificaÃ§Ãµes como:  
  - CompTIA Security+  
  - GCIA, GCIH (SANS)  
  - CEH (Certified Ethical Hacker)  
  - Blue Team Level 1/2 (BTL1, BTL2)


## ğŸ› ï¸ Ferramentas Usadas

- **SIEMs**: Splunk, ELK, QRadar, Microsoft Sentinel  
- **EDR/XDR**: CrowdStrike, SentinelOne, Microsoft Defender  
- **SOAR**: Cortex XSOAR, IBM Resilient  
- **Forense**: Autopsy, Volatility, FTK  
- **AnÃ¡lise de TrÃ¡fego**: Wireshark, Zeek, Suricata  
- **GestÃ£o de vulnerabilidades**: Nessus, Qualys, OpenVAS


## ğŸ¤ RelaÃ§Ã£o com Outros Times

- **Red Team (ğŸ”´):** Testa as defesas da equipe azul com ataques simulados  
- **Purple Team (ğŸŸ£):** Integra Red + Blue para melhorar continuamente ambos  
- **White Team (âšª):** Supervisiona e define as regras dos exercÃ­cios  


## ğŸ“š Frameworks e ReferÃªncias

- **MITRE ATT&CK for Defense**  
- NIST 800-61 (Guia de Resposta a Incidentes)  
- CIS Controls v8  
- NIST CSF (Cybersecurity Framework)


## âœ… BenefÃ­cios para a OrganizaÃ§Ã£o

- ReduÃ§Ã£o de tempo de resposta a incidentes  
- Menor risco de vazamentos e perdas de dados  
- DetecÃ§Ã£o precoce de ameaÃ§as  
- ResiliÃªncia operacional frente a ataques  
- Melhoria contÃ­nua da postura de seguranÃ§a

# ğŸ”µ 3. Blue Team: Fundamentos de Redes

Para atuar de forma eficaz na defesa cibernÃ©tica, um profissional Blue Team precisa compreender os **fundamentos das redes**. Esses conhecimentos sÃ£o essenciais para analisar trÃ¡fego, detectar comportamentos anÃ´malos e identificar ameaÃ§as que se propagam pela rede.

A base de toda defesa Ã© entender como o trÃ¡fego legÃ­timo se comporta.

## ğŸ§± Modelo OSI â€“ A Estrutura da ComunicaÃ§Ã£o

O **modelo OSI** (Open Systems Interconnection) divide a comunicaÃ§Ã£o em **7 camadas**, facilitando a anÃ¡lise de como os dados trafegam.

| Camada | Nome                      | FunÃ§Ã£o Principal                                |
|--------|---------------------------|--------------------------------------------------|
| 7      | AplicaÃ§Ã£o                 | InteraÃ§Ã£o com o usuÃ¡rio (HTTP, DNS, FTP)         |
| 6      | ApresentaÃ§Ã£o              | Criptografia, compressÃ£o (TLS, JPEG)             |
| 5      | SessÃ£o                    | Controle de sessÃµes (RPC, NetBIOS)               |
| 4      | Transporte                | Controle de fluxo (TCP, UDP)                     |
| 3      | Rede                      | Roteamento e endereÃ§amento (IP)                  |
| 2      | Enlace de Dados           | MAC, switches, detecÃ§Ã£o de erros                 |
| 1      | FÃ­sica                    | Cabos, sinais, hubs                              |


## ğŸŒ EndereÃ§amento IP (IPv4)

O endereÃ§o IP (Internet Protocol) identifica um dispositivo em uma rede.  
Exemplo de IPv4: `192.168.0.10`

- **Classe A, B, C**: categorias de endereÃ§os  
- **IP privado:** nÃ£o acessÃ­vel da internet (ex: 192.168.x.x)  
- **IP pÃºblico:** utilizado para comunicaÃ§Ã£o externa  
- **MÃ¡scara de sub-rede:** define o tamanho da rede (ex: 255.255.255.0)


## ğŸ“¡ Protocolo DNS

O **DNS (Domain Name System)** traduz nomes de domÃ­nio (ex: google.com) para endereÃ§os IP.

- **Tipo de registro:** A (IPv4), AAAA (IPv6), MX (e-mail), TXT (SPF, DKIM)  
- **ResoluÃ§Ã£o direta e reversa**  
- **Ataques comuns:** DNS spoofing, tunneling, amplification


## ğŸŒ Protocolo HTTP/HTTPS

O **HTTP (Hypertext Transfer Protocol)** Ã© o protocolo da web.  
O **HTTPS** Ã© a versÃ£o segura (com TLS).

- **MÃ©todos comuns:** GET, POST, PUT, DELETE  
- **CÃ³digos de resposta:**  
  - 200 OK  
  - 403 Forbidden  
  - 404 Not Found  
  - 500 Internal Server Error  
- **CabeÃ§alhos importantes:** User-Agent, Host, Cookie  


## ğŸ” Protocolos TCP e UDP

### ğŸ§© TCP (Transmission Control Protocol)

- ConfiÃ¡vel (garante entrega)  
- Utiliza o **three-way handshake** (SYN, SYN-ACK, ACK)  
- AplicaÃ§Ãµes: HTTP, HTTPS, SSH, SMTP

### ğŸ§© UDP (User Datagram Protocol)

- NÃ£o confiÃ¡vel (sem garantia de entrega)  
- Mais rÃ¡pido, usado em streaming, DNS, VoIP  
- AplicaÃ§Ãµes: DNS, DHCP, SNMP, NTP


## ğŸ›¡ï¸ RelevÃ¢ncia para o Blue Team

Dominar os conceitos de redes Ã© essencial para:

- Analisar **pacotes com Wireshark**  
- Compreender alertas de **IDS/IPS (Snort, Suricata)**  
- Criar **regras de detecÃ§Ã£o em SIEM**  
- Monitorar trÃ¡fego anÃ´malo e identificar **exfiltraÃ§Ãµes de dados**  
- Investigar **tÃ©cnicas de C2** e **comunicaÃ§Ã£o maliciosa**

# ğŸ”µ 4. Blue Team: Leitura e InterpretaÃ§Ã£o de Pacotes com Wireshark

O **Wireshark** Ã© uma das ferramentas mais importantes para profissionais de seguranÃ§a da informaÃ§Ã£o, especialmente para o time Blue Team. Ele permite a anÃ¡lise de trÃ¡fego de rede em tempo real ou capturado em arquivos `.pcap`, ajudando na investigaÃ§Ã£o de incidentes, anomalias e comportamento malicioso.

Quem domina o trÃ¡fego de rede tem o poder de entender, prever e bloquear ataques antes que causem dano.

## ğŸ¬ O que Ã© o Wireshark?

O **Wireshark** Ã© um analisador de pacotes gratuito e de cÃ³digo aberto usado para capturar e inspecionar o trÃ¡fego de rede atÃ© o nÃ­vel de cada bit, seguindo o modelo OSI.


## ğŸ“¦ O que Ã© um pacote?

Um **pacote de rede** Ã© uma unidade de dados transmitida entre dispositivos em uma rede. Ele contÃ©m informaÃ§Ãµes sobre origem, destino, tipo de protocolo, dados e muito mais.


## ğŸ“¥ Como capturar pacotes com Wireshark?

1. **Selecionar a interface de rede ativa** (ex: Ethernet ou Wi-Fi)<br>
2. Clicar em **"Start capturing packets"**<br>
3. Observar os pacotes sendo listados em tempo real<br>
4. Utilizar **filtros** para refinar a captura e anÃ¡lise<br>


## ğŸ¯ Filtros de Captura e de ExibiÃ§Ã£o

### ğŸ”¹ Filtros de captura (antes de iniciar):
- `tcp port 80` â†’ captura somente trÃ¡fego HTTP  
- `host 192.168.1.10` â†’ trÃ¡fego de um IP especÃ­fico  

### ğŸ”¹ Filtros de exibiÃ§Ã£o (durante a anÃ¡lise):
- `http` â†’ exibe apenas pacotes HTTP  
- `ip.addr == 8.8.8.8` â†’ qualquer pacote com esse IP  
- `tcp.flags.syn == 1` â†’ pacotes SYN (inÃ­cio de conexÃ£o TCP)  


## ğŸ” Estrutura de um pacote (exemplo TCP)

Ao clicar em um pacote, o Wireshark mostra:

1. **Camada fÃ­sica / Ethernet**: origem e destino MAC  
2. **IP**: endereÃ§o de origem e destino  
3. **TCP/UDP**: portas, flags (SYN, ACK, RST, etc.)  
4. **AplicaÃ§Ã£o**: conteÃºdo HTTP, DNS, FTP, etc.  


## ğŸ› ï¸ Exemplos prÃ¡ticos

### âœ… Verificando handshake TCP:

Use o filtro: `tcp.flags.syn == 1 && tcp.flags.ack == 0`  
VocÃª verÃ¡ o pacote **SYN**, sinalizando o inÃ­cio de uma conexÃ£o.

### âœ… Inspecionando requisiÃ§Ã£o HTTP:

Use o filtro: `http.request`  
VocÃª pode visualizar o mÃ©todo (GET/POST), o `User-Agent` e o `Host`.

### âœ… Identificando exfiltraÃ§Ã£o via DNS:

Use o filtro: `dns`  
AnÃ¡lise de consultas suspeitas como `abc123.attacker.com` pode indicar tunneling.


## ğŸ›¡ï¸ AplicaÃ§Ãµes para o Blue Team

- AnÃ¡lise de trÃ¡fego em incidentes de seguranÃ§a  
- DetecÃ§Ã£o de comunicaÃ§Ã£o com C2 (Command & Control)  
- InvestigaÃ§Ã£o de ataques (ex: DNS tunneling, malware callbacks)  
- AnÃ¡lise de exfiltraÃ§Ã£o de dados  
- CompreensÃ£o de ataques como scans, DoS, brute-force  


## ğŸ“‚ Fontes de arquivos `.pcap` para treino

- [https://www.malware-traffic-analysis.net](https://www.malware-traffic-analysis.net)  
- [https://www.netresec.com/?page=PcapFiles](https://www.netresec.com/?page=PcapFiles)  
- [https://www.tracewrangler.com/samplepcaps](https://www.tracewrangler.com/samplepcaps)


## ğŸ“˜ Dica extra

Salve sessÃµes suspeitas como `.pcap` e crie seu repositÃ³rio de ameaÃ§as para futura referÃªncia. Isso ajuda a montar uma **base de IOC comportamental**.

# ğŸ”µ 5. Blue Team: Logs do Windows e Linux â€“ Onde EstÃ£o e Como Ler

Um dos principais pilares da atuaÃ§Ã£o do Blue Team Ã© a **anÃ¡lise de logs**. Eles sÃ£o a base para detecÃ§Ã£o de ameaÃ§as, resposta a incidentes e investigaÃ§Ã£o forense. Saber **onde os logs ficam armazenados** e **como interpretÃ¡-los** Ã© essencial para qualquer analista de seguranÃ§a.

Logs sÃ£o como a caixa preta de um sistema: quem sabe lÃª-los, entende tudo o que aconteceu â€“ e o que estÃ¡ prestes a acontecer.

## ğŸªŸ Logs no Windows

O Windows registra diversos eventos importantes em seus **logs de eventos (Event Logs)**. Esses logs podem ser visualizados usando o **Event Viewer** (`eventvwr.msc`) ou exportados para anÃ¡lise posterior.

### ğŸ—‚ï¸ Principais categorias de logs:

| Log                   | Caminho no Event Viewer                         | O que contÃ©m                                |
|-----------------------|--------------------------------------------------|----------------------------------------------|
| **Application**       | Event Viewer â†’ Windows Logs â†’ Application       | Erros de aplicativos, falhas de sistema      |
| **System**            | Event Viewer â†’ Windows Logs â†’ System            | Driver, kernel, falhas de hardware           |
| **Security**          | Event Viewer â†’ Windows Logs â†’ Security          | Eventos de login, tentativas de acesso       |
| **Setup**             | Event Viewer â†’ Windows Logs â†’ Setup             | InstalaÃ§Ãµes, atualizaÃ§Ãµes                     |
| **Forwarded Events**  | Event Viewer â†’ Applications and Services Logs   | Logs de eventos recebidos via forwarding     |


### ğŸ” Eventos de seguranÃ§a importantes:

| Evento ID | DescriÃ§Ã£o                                     |
|-----------|-----------------------------------------------|
| 4624      | Logon bem-sucedido                            |
| 4625      | Tentativa de logon falha                      |
| 4688      | CriaÃ§Ã£o de processo                           |
| 4697      | InstalaÃ§Ã£o de novo serviÃ§o                    |
| 4719      | PolÃ­tica de auditoria alterada                |
| 4720â€“4732 | CriaÃ§Ã£o/modificaÃ§Ã£o de contas e grupos        |


### ğŸ“ Local fÃ­sico dos logs:

- Caminho: `C:\Windows\System32\winevt\Logs\`  
- ExtensÃ£o: `.evtx`  
- Leitura com: Event Viewer, PowerShell, ou ferramentas como **Log Parser**, **EventLog Explorer**


## ğŸ§ Logs no Linux

No Linux, os logs geralmente sÃ£o armazenados em arquivos de texto localizados em `/var/log`. O sistema de logging pode variar (ex: `rsyslog`, `journald`, `syslog-ng`), mas a estrutura geral se mantÃ©m.

### ğŸ—‚ï¸ Principais arquivos de log:

| Caminho                  | DescriÃ§Ã£o                                      |
|--------------------------|------------------------------------------------|
| `/var/log/syslog`        | Log geral do sistema (Debian/Ubuntu)           |
| `/var/log/messages`      | Log geral do sistema (RHEL/CentOS)             |
| `/var/log/auth.log`      | Log de autenticaÃ§Ã£o e sudo (Debian/Ubuntu)     |
| `/var/log/secure`        | Log de autenticaÃ§Ã£o (RHEL/CentOS)              |
| `/var/log/boot.log`      | Mensagens de inicializaÃ§Ã£o do sistema          |
| `/var/log/kern.log`      | Logs do kernel                                 |
| `/var/log/faillog`       | Tentativas de login invÃ¡lidas                  |
| `/var/log/wtmp` / `last` | HistÃ³rico de logins                            |


### ğŸ” Como visualizar logs:

- `cat /var/log/auth.log` â€“ imprime o conteÃºdo  
- `tail -f /var/log/syslog` â€“ monitora em tempo real  
- `grep "sshd" /var/log/auth.log` â€“ filtra por palavra-chave  
- `journalctl` â€“ visualiza logs do `systemd` (em distribuiÃ§Ãµes modernas)


## ğŸ›¡ï¸ Por que isso importa para o Blue Team?

- Monitorar **logons suspeitos**, escaladas de privilÃ©gio e uso do sudo  
- Detectar **criaÃ§Ãµes de usuÃ¡rios, serviÃ§os ou processos anÃ´malos**  
- Verificar **tentativas de brute-force**, malware persistente e atividades fora do horÃ¡rio normal  
- Correlacionar logs entre Windows e Linux para detectar **movimentaÃ§Ã£o lateral**  


## ğŸ§° Ferramentas Ãºteis para anÃ¡lise de logs

- **Windows:** Event Viewer, PowerShell, EventLog Explorer, Log Parser  
- **Linux:** journalctl, grep, ausearch, Logwatch  
- **SIEMs:** Splunk, ELK, Wazuh, Sentinel (para ingestÃ£o e anÃ¡lise centralizada)


## ğŸ§  Dica prÃ¡tica

Crie um **checklist de eventos crÃ­ticos** para monitorar em cada sistema e aplique filtros regulares para identificar padrÃµes. Isso economiza tempo e aumenta a eficÃ¡cia na detecÃ§Ã£o.

# ğŸ”µ 6. Blue Team: SeguranÃ§a em AutenticaÃ§Ã£o â€“ MFA, Hashes, Senhas e Tokens

A **autenticaÃ§Ã£o segura** Ã© uma das primeiras linhas de defesa contra acessos nÃ£o autorizados. O Blue Team precisa entender profundamente os mecanismos modernos de autenticaÃ§Ã£o para proteger usuÃ¡rios, sistemas e redes.

Senhas sÃ£o como escovas de dentes: pessoais, devem ser trocadas regularmente e nunca compartilhadas.

## ğŸ” O que Ã© AutenticaÃ§Ã£o?

**AutenticaÃ§Ã£o** Ã© o processo de verificar se um usuÃ¡rio ou sistema Ã© realmente quem diz ser.  
Ela geralmente envolve um ou mais dos seguintes fatores:

- **Algo que vocÃª sabe** â†’ senha, PIN  
- **Algo que vocÃª tem** â†’ token, celular  
- **Algo que vocÃª Ã©** â†’ biometria  


## ğŸ”¢ MFA â€“ AutenticaÃ§Ã£o Multifator

O **MFA (Multi-Factor Authentication)** adiciona camadas de seguranÃ§a exigindo mais de um fator de autenticaÃ§Ã£o.

### âœ… Exemplos de MFA:
- Senha + cÃ³digo via SMS  
- Senha + token no aplicativo (Google Authenticator, Microsoft Authenticator)  
- PIN + impressÃ£o digital  

### ğŸ¯ Vantagens do MFA:
- Dificulta o uso de credenciais vazadas  
- Reduz risco de ataques por forÃ§a bruta  
- Mitiga sequestro de sessÃ£o e phishing simples  

### âš ï¸ AtenÃ§Ã£o:
- SMS como 2FA Ã© melhor do que nada, mas ainda **vulnerÃ¡vel a SIM Swap**  
- Sempre prefira aplicativos de MFA ou chaves FIDO2/YubiKey


## ğŸ”‘ Hashes de Senhas

As senhas **nunca devem ser armazenadas em texto claro**. Elas devem ser convertidas em **hashes**, uma representaÃ§Ã£o criptogrÃ¡fica que nÃ£o pode ser revertida diretamente.

### ğŸ” O que Ã© um hash?
Um hash Ã© o resultado de aplicar uma funÃ§Ã£o matemÃ¡tica a uma entrada (senha), gerando uma saÃ­da de tamanho fixo.

### ğŸ”¹ Exemplos de funÃ§Ãµes de hash:
- **MD5** â€“ desatualizado e inseguro  
- **SHA-1** â€“ tambÃ©m inseguro  
- **SHA-256** â€“ mais forte, mas puro ainda nÃ£o ideal para senhas  
- **bcrypt, scrypt, Argon2** â€“ recomendadas para proteger senhas

### âš ï¸ Boa prÃ¡tica:
Sempre aplicar **salting** (adicionar dados Ãºnicos Ã  senha antes de gerar o hash) para evitar ataques com rainbow tables.


## ğŸ” Senhas: Boas PrÃ¡ticas

- Tamanho mÃ­nimo recomendado: **12 caracteres**  
- Evite usar informaÃ§Ãµes pessoais (nome, data, time)  
- Use **gerenciadores de senhas** (Bitwarden, 1Password, KeePass)  
- Nunca reutilize senhas entre sistemas  
- Habilite MFA sempre que possÃ­vel  


## ğŸ« Tokens de Acesso

Tokens sÃ£o **credenciais temporÃ¡rias e controladas**, usadas para autenticaÃ§Ã£o e autorizaÃ§Ã£o.

### ğŸ”¹ Tipos comuns:

| Tipo         | Uso                                 |
|--------------|--------------------------------------|
| **TOTP**     | Token baseado em tempo (Google Auth) |
| **JWT**      | JSON Web Token, comum em APIs        |
| **OAuth2**   | AutorizaÃ§Ã£o delegada (Google Login)  |
| **FIDO2/WebAuthn** | AutenticaÃ§Ã£o por chave fÃ­sica ou biometria |

### ğŸ” JWT (JSON Web Token):
- ContÃ©m: header, payload, signature  
- Usado para autenticaÃ§Ã£o em aplicaÃ§Ãµes web  
- Deve ser assinado e, idealmente, criptografado  

### âš ï¸ Riscos:
- Tokens expostos em URL, console ou header podem ser interceptados  
- Falta de expiraÃ§Ã£o ou revogaÃ§Ã£o Ã© um problema comum  


## ğŸ›¡ï¸ RelevÃ¢ncia para o Blue Team

- Monitorar **falhas de login repetidas** (brute-force)  
- Detectar **acessos sem MFA** ou **tokens reutilizados**  
- Validar seguranÃ§a do armazenamento de senhas  
- Criar **alertas de login suspeito (localizaÃ§Ã£o, horÃ¡rio, device)**  
- Auxiliar na **educaÃ§Ã£o de usuÃ¡rios** e adoÃ§Ã£o de boas prÃ¡ticas  


## ğŸ§° Ferramentas Ãºteis

- **Have I Been Pwned** â€“ verificaÃ§Ã£o de vazamentos de senha  
- **Authy / Google Authenticator** â€“ MFA apps  
- **YubiKey / SoloKey** â€“ autenticaÃ§Ã£o com chave fÃ­sica  
- **Hashcat / John the Ripper** â€“ auditoria de hashes (uso Ã©tico)  
- **Vault / AWS Secrets Manager** â€“ gerenciamento de segredos corporativos

# ğŸ”µ 7. Blue Team: Tipos de Ataques Comuns â€“ Phishing, Malware, Brute-Force e MITM

Todo profissional de Blue Team precisa conhecer os principais **tipos de ataques** utilizados por ameaÃ§as cibernÃ©ticas. Reconhecer seus padrÃµes e comportamentos Ã© essencial para **prevenir, detectar e responder** de forma eficaz.

VocÃª sÃ³ pode se defender daquilo que Ã© capaz de reconhecer.

## ğŸ£ Phishing â€“ Engenharia Social DisfarÃ§ada

O **phishing** Ã© um dos ataques mais comuns e eficazes. Consiste em **enganar o usuÃ¡rio** para que ele entregue informaÃ§Ãµes confidenciais, como senhas ou dados bancÃ¡rios.

### ğŸ“Œ CaracterÃ­sticas:
- E-mails ou mensagens falsas com aparÃªncia legÃ­tima  
- Links que levam a sites clonados (ex: "banc0.com" em vez de "banco.com")  
- Anexos maliciosos (PDFs, Excel com macros, etc.)

### ğŸ” Como detectar:
- Erros de ortografia e domÃ­nio estranho  
- SolicitaÃ§Ãµes urgentes ou ameaÃ§adoras  
- Arquivos suspeitos anexados

### ğŸ›¡ï¸ Defesa Blue Team:
- Filtros de e-mail (SPF, DKIM, DMARC)  
- Treinamento de usuÃ¡rios  
- Sandboxing de anexos  
- Monitoramento de cliques e redirecionamentos


## ğŸ¦  Malware â€“ Software Malicioso

O **malware** Ã© qualquer programa criado com a intenÃ§Ã£o de causar dano ou obter acesso nÃ£o autorizado a sistemas.

### ğŸ§© Tipos comuns:
- **Ransomware:** criptografa arquivos e exige resgate  
- **Spyware:** coleta informaÃ§Ãµes sem consentimento  
- **Trojans:** disfarÃ§ado como software legÃ­timo  
- **Worms:** se replicam pela rede  
- **Rootkits:** ocultam presenÃ§a de atacantes  

### ğŸ›¡ï¸ Defesa Blue Team:
- EDR com detecÃ§Ã£o comportamental  
- Lista de bloqueio (blacklist) de hashes e domÃ­nios  
- AnÃ¡lise de IOC (hashes, conexÃµes, artefatos)  
- Monitoramento de criaÃ§Ã£o de processos e serviÃ§os (Windows ID 4688)


## ğŸ” Brute-Force â€“ Adivinhando Senhas

Ataques de forÃ§a bruta consistem em **tentar vÃ¡rias combinaÃ§Ãµes de senha** atÃ© acertar a correta. Variantes incluem:

- **Ataque direto:** tenta muitas senhas em um mesmo login  
- **Ataque de dicionÃ¡rio:** usa listas comuns de senhas  
- **Credential stuffing:** tenta combinaÃ§Ãµes vazadas de outros serviÃ§os  

### ğŸ” IndÃ­cios em logs:
- MÃºltiplas tentativas de login falhadas (Windows Event 4625)  
- VÃ¡rios IPs tentando logar em um mesmo usuÃ¡rio  
- Tentativas fora do horÃ¡rio habitual  

### ğŸ›¡ï¸ Defesa Blue Team:
- MFA obrigatÃ³rio  
- LimitaÃ§Ã£o de tentativas (lockout temporÃ¡rio)  
- Monitoramento e alerta de comportamento anÃ´malo  
- Regras de detecÃ§Ã£o em SIEM (por IP, por usuÃ¡rio, por hora)


## ğŸ•µï¸ MITM â€“ Man-in-the-Middle

No **MITM (homem-no-meio)**, o atacante intercepta a comunicaÃ§Ã£o entre duas partes para roubar dados, redirecionar trÃ¡fego ou modificar conteÃºdo.

### ğŸ¯ Exemplos:
- Captura de trÃ¡fego em redes Wi-Fi pÃºblicas  
- DNS spoofing (redireciona sites legÃ­timos para falsos)  
- SSL stripping (remove criptografia HTTPS)

### ğŸ›¡ï¸ Defesa Blue Team:
- EncriptaÃ§Ã£o forte de ponta a ponta (HTTPS, TLS)  
- DNSSEC e HSTS nos serviÃ§os da empresa  
- Certificados digitais vÃ¡lidos e monitorados  
- Monitoramento de certificados suspeitos e certificados wildcard fora do padrÃ£o


## ğŸ”„ ConclusÃ£o

Compreender esses ataques Ã© o primeiro passo para montar **controles, alertas e respostas eficientes**. O Blue Team atua de forma proativa e reativa para conter e impedir esses vetores de ataque.


## ğŸ§  Dica prÃ¡tica:

Crie uma **matriz de ameaÃ§as** no seu ambiente listando:

- Vetores mais comuns (e-mail, web, rede, endpoint)  
- Tipos de ataques associados  
- Controles jÃ¡ existentes e lacunas  
- IOCs e exemplos reais para treinar detecÃ§Ã£o

# ğŸ”µ Blue Team: IntroduÃ§Ã£o ao SIEM (conceito, uso, eventos)

Um dos principais aliados do Blue Team na detecÃ§Ã£o de ameaÃ§as Ã© o **SIEM** â€“ uma ferramenta que centraliza, organiza e analisa eventos de seguranÃ§a. Dominar o uso do SIEM Ã© essencial para prevenir, detectar e responder a incidentes em tempo real.

O SIEM Ã© o radar do Blue Team â€“ sem ele, vocÃª estÃ¡ voando Ã s cegas.

## ğŸ§  O que Ã© um SIEM?

**SIEM** significa *Security Information and Event Management*.  
Ã‰ uma soluÃ§Ã£o que coleta, armazena, correlaciona e analisa **eventos de seguranÃ§a** gerados por dispositivos, sistemas e aplicaÃ§Ãµes.


## ğŸ¯ Objetivos principais do SIEM:

- **Centralizar logs** de diversos dispositivos (servidores, firewalls, endpoints, etc.)  
- **Detectar ameaÃ§as em tempo real** por meio de regras de correlaÃ§Ã£o  
- **Gerar alertas de seguranÃ§a** baseados em comportamentos anÃ´malos  
- **Apoiar investigaÃ§Ãµes e resposta a incidentes**  
- **Cumprir requisitos de auditoria e conformidade**


## ğŸ—‚ï¸ Fontes comuns de eventos no SIEM

Um SIEM pode receber eventos de praticamente qualquer sistema. Exemplos:

- **Windows:** eventos de logon (4624, 4625), criaÃ§Ã£o de processo (4688)  
- **Linux:** logs de autenticaÃ§Ã£o (`/var/log/auth.log`), sudo, SSH  
- **Firewalls:** conexÃµes permitidas/bloqueadas, NAT, regras violadas  
- **EDR/AntivÃ­rus:** detecÃ§Ã£o de malware, execuÃ§Ã£o suspeita  
- **ServiÃ§os em nuvem:** AWS CloudTrail, Azure Monitor, Google Cloud Logging  
- **AplicaÃ§Ãµes:** falhas de autenticaÃ§Ã£o, aÃ§Ãµes crÃ­ticas de usuÃ¡rios  


## ğŸ” Exemplo de evento no SIEM (Windows)

```json
{
  "EventID": 4625,
  "AccountName": "admin",
  "LogonType": 3,
  "IPAddress": "10.10.10.15",
  "Status": "0xC000006A",
  "TimeCreated": "2025-06-26T22:15:00"
}
```

Esse evento indica uma **tentativa de logon falha** em uma conexÃ£o de rede (tipo 3), vinda do IP `10.10.10.15`.


## âš™ï¸ Como o SIEM funciona (fluxo geral)

1. **Coleta:** agentes ou forwarders enviam logs dos dispositivos  
2. **NormalizaÃ§Ã£o:** dados brutos sÃ£o estruturados em um formato comum  
3. **IndexaÃ§Ã£o:** eventos sÃ£o armazenados para consulta rÃ¡pida  
4. **CorrelaÃ§Ã£o:** regras detectam padrÃµes de ataque ou anomalias  
5. **Alerta:** notificaÃ§Ãµes sÃ£o geradas com base nas regras  
6. **AnÃ¡lise:** analistas investigam eventos por meio de dashboards e buscas  
7. **Resposta:** aÃ§Ãµes manuais ou automÃ¡ticas sÃ£o iniciadas


## ğŸ“Œ Exemplos de uso prÃ¡tico no Blue Team

- Detectar **tentativas de brute-force** com mÃºltiplos eventos 4625  
- Identificar **movimentaÃ§Ã£o lateral** por logons RDP fora do padrÃ£o  
- Monitorar **execuÃ§Ãµes de comandos perigosos** (ex: PowerShell + base64)  
- Correlacionar logs de firewall com eventos de endpoint  
- Criar alertas baseados em **horÃ¡rios anÃ´malos de login** ou **usuÃ¡rios privilegiados**


## ğŸ› ï¸ Exemplos de ferramentas SIEM

| Nome         | Tipo        | ComentÃ¡rio                                 |
|--------------|-------------|--------------------------------------------|
| **Splunk**   | Comercial   | Muito robusto, flexÃ­vel e escalÃ¡vel        |
| **ELK Stack**| Open-source | Elastic + Logstash + Kibana                |
| **Wazuh**    | Open-source | SIEM com foco em seguranÃ§a e compliance    |
| **Microsoft Sentinel** | Cloud | Integrado ao Azure, fÃ¡cil de automatizar |
| **Graylog**  | Open-source | Interface simples e eficaz                 |


## ğŸ§  Dica para iniciantes:

Comece aprendendo a **buscar eventos especÃ­ficos**, como:

- `EventID=4625` â†’ logons falhos  
- `cmd.exe` OU `powershell.exe` â†’ execuÃ§Ã£o de comandos  
- `src_ip:10.0.0.* AND dst_port:3389` â†’ acessos RDP

Aos poucos, avance para **regras de correlaÃ§Ã£o personalizadas**, alertas automatizados e uso de dashboards.

# ğŸ”µ Blue Team: Treinamento â€“ Splunk Fundamentals 1 (MÃ³dulos 1 e 2)

O curso **Splunk Fundamentals 1** Ã© a porta de entrada oficial para o uso do Splunk, uma das ferramentas de SIEM mais poderosas do mercado. Os **mÃ³dulos 1 e 2** apresentam os conceitos bÃ¡sicos de uso da plataforma, essenciais para analistas de Blue Team.

Buscar Ã© o novo modo de investigar â€“ e no Splunk, a linguagem Ã© poder.

## ğŸ¯ Objetivo do curso

Capacitar o aluno a navegar pela interface do Splunk, executar buscas bÃ¡sicas, usar comandos essenciais e compreender a estrutura dos dados.  

O conteÃºdo Ã© gratuito e online, disponÃ­vel na [Splunk Education](https://www.splunk.com/en_us/training.html).

## ğŸ“˜ MÃ³dulo 1 â€“ IntroduÃ§Ã£o ao Splunk

### ğŸ”¹ O que Ã© Splunk?

O Splunk Ã© uma plataforma que permite coletar, indexar, pesquisar, visualizar e correlacionar dados de qualquer fonte (logs, mÃ©tricas, eventos). Ele Ã© amplamente utilizado para:

- Monitoramento de seguranÃ§a (SIEM)  
- Observabilidade de sistemas  
- Resposta a incidentes  
- DetecÃ§Ã£o de ameaÃ§as  

### ğŸ§± Componentes principais:

- **Indexer:** onde os dados sÃ£o armazenados e indexados  
- **Search Head:** onde o usuÃ¡rio faz buscas e visualizaÃ§Ãµes  
- **Forwarder:** envia dados para o Indexer  
- **Deployment Server:** gerencia configuraÃ§Ãµes em larga escala  

### ğŸ§­ Navegando pela interface:

- **Search & Reporting:** painel principal de buscas  
- **Data Summary:** visualiza hosts, fontes e tipos de dados  
- **Apps:** mÃ³dulos adicionais como Enterprise Security  
- **Settings:** configuraÃ§Ãµes de dados, usuÃ¡rios e permissÃµes  

## ğŸ“˜ MÃ³dulo 2 â€“ Executando Buscas no Splunk

### ğŸ” Sintaxe bÃ¡sica de busca:

As buscas no Splunk comeÃ§am com a palavra `search` (opcional) e utilizam filtros por palavras-chave, campos e comandos.  

**Exemplo simples:**

```spl
index=main error
```

Retorna eventos no Ã­ndice `main` que contenham a palavra "error".


### ğŸ—ƒï¸ Filtros comuns:

- `index=` â†’ especifica qual Ã­ndice de dados usar  
- `source=` â†’ arquivo ou origem dos dados  
- `sourcetype=` â†’ tipo de dado (ex: `WinEventLog:Security`)  
- `host=` â†’ hostname de onde veio o log  

**Exemplo:**

```spl
index=ossec source="/var/log/auth.log" action=denied
```

### ğŸ§  Dica: Usar o botÃ£o **"Data Summary"** para descobrir os Ã­ndices, fontes e tipos mais usados antes de buscar.

### ğŸ“Š VisualizaÃ§Ãµes bÃ¡sicas:

ApÃ³s executar uma busca, o Splunk permite criar grÃ¡ficos a partir dos resultados com comandos como:

```spl
index=firewall action=blocked | stats count by src_ip
```
Esse comando conta quantas vezes cada IP de origem foi bloqueado.


### ğŸ”§ Operadores Ãºteis:

| Operador     | DescriÃ§Ã£o                         |
|--------------|-----------------------------------|
| `AND`        | Ambos os termos devem existir     |
| `OR`         | Um ou outro pode existir          |
| `NOT`        | Exclui eventos com esse termo     |
| `=`          | Busca por campo igual a valor     |
| `!=`         | Campo diferente do valor          |

## ğŸ§  Para praticar:

- Use os **datasets de demonstraÃ§Ã£o** disponÃ­veis na instÃ¢ncia Splunk do curso  
- Crie buscas simples por falhas de login, comandos executados ou IPs suspeitos  
- Experimente filtros com `index=`, `source=`, `sourcetype=`, `host=`

## ğŸš€ PrÃ³ximos mÃ³dulos

Nos mÃ³dulos seguintes, o curso aborda:

- Uso avanÃ§ado do `stats`, `table`, `timechart`  
- CriaÃ§Ã£o de dashboards  
- Alertas e relatÃ³rios programados  

# ğŸ”µ Blue Team: Treinamento â€“ Splunk Fundamentals 1 (MÃ³dulos 3 e 4)

Dando continuidade ao treinamento oficial **Splunk Fundamentals 1**, os mÃ³dulos 3 e 4 aprofundam o uso da linguagem de busca do Splunk, introduzindo **campos, visualizaÃ§Ãµes, estatÃ­sticas e comandos avanÃ§ados**. SÃ£o fundamentais para analistas de seguranÃ§a que desejam criar investigaÃ§Ãµes mais precisas e dashboards informativos.

Comandos como `stats` e `eval` transformam o analista de observador em investigador.

## ğŸ“˜ MÃ³dulo 3 â€“ Usando Campos no Splunk

### ğŸ“Œ O que sÃ£o Campos?

Campos sÃ£o pares **chave:valor** extraÃ­dos dos eventos (como `src_ip=10.0.0.1`, `status=404`).  
O Splunk **detecta automaticamente** campos comuns, mas vocÃª pode **criar, filtrar e manipular** campos conforme necessÃ¡rio.

### ğŸ” Usando campos em buscas

VocÃª pode usar campos diretamente para refinar resultados:

{{code}}spl
index=web sourcetype=access_combined status=404
{{end}}

Isso retorna apenas eventos onde o status da requisiÃ§Ã£o HTTP Ã© 404.

### ğŸ”§ Campos personalizados (rex, eval)

VocÃª pode criar novos campos temporÃ¡rios durante a busca:

#### ğŸ“Œ `eval` â†’ Cria campos com lÃ³gica simples

{{code}}spl
... | eval risco=if(status==500, "alto", "baixo")
{{end}}

#### ğŸ“Œ `rex` â†’ Extrai campos usando expressÃµes regulares

{{code}}spl
... | rex field=_raw "user=(?<username>\w+)"
{{end}}

Esse exemplo cria um campo chamado `username` extraÃ­do do conteÃºdo de `_raw`.

### ğŸ§° Comando `fields`

Usado para **mostrar ou ocultar** campos no resultado:

{{code}}spl
... | fields username, src_ip
{{end}}

## ğŸ“˜ MÃ³dulo 4 â€“ Usando EstatÃ­sticas e VisualizaÃ§Ãµes

### ğŸ“Š Comando `stats`

O `stats` permite agregar dados e gerar resumos estatÃ­sticos.  
Exemplo: contar eventos por endereÃ§o IP:

{{code}}spl
index=firewall action=blocked | stats count by src_ip
{{end}}

### ğŸ“Š Outros comandos estatÃ­sticos:

| Comando          | FunÃ§Ã£o                          |
|------------------|----------------------------------|
| `count`          | Conta eventos                   |
| `sum`            | Soma valores numÃ©ricos          |
| `avg`            | MÃ©dia                           |
| `min` / `max`    | MÃ­nimo / MÃ¡ximo                 |
| `dc`             | Distinct count (valores Ãºnicos) |

### ğŸ§® Exemplo com mÃºltiplas mÃ©tricas:

{{code}}spl
index=web status=* | stats count, dc(clientip) by status
{{end}}

Conta o nÃºmero total de eventos e o nÃºmero de IPs Ãºnicos por status HTTP.


### ğŸ“ˆ VisualizaÃ§Ãµes no Splunk

VocÃª pode transformar buscas em **grÃ¡ficos interativos**, como:

- **Barras** (por quantidade)  
- **Pizza** (por distribuiÃ§Ã£o)  
- **Linha do tempo** (eventos ao longo do tempo)  
- **Mapa geogrÃ¡fico** (com dados de localizaÃ§Ã£o)  

#### Exemplo com `timechart`:

{{code}}spl
index=web status=200 | timechart count by host
{{end}}

Mostra quantos eventos 200 ocorreram ao longo do tempo, por host.

### ğŸ“‹ Comando `table`

Mostra os dados em forma de tabela personalizada:

{{code}}spl
index=auth action=failure | table _time, user, src_ip
{{end}}

## âœ… Dicas prÃ¡ticas:

- Combine `stats`, `eval`, `table` e `fields` para criar visualizaÃ§Ãµes ricas  
- Use `timechart` para anÃ¡lises temporais (com base em `_time`)  
- Utilize `dc(field)` para identificar **diversidade** de valores, Ãºtil em anÃ¡lise de comportamento  
- Evite usar `search *` (buscas amplas demais)

## ğŸ§  Exemplo de caso real:

> "Queremos descobrir os 10 IPs que mais geraram falhas de autenticaÃ§Ã£o nos Ãºltimos 7 dias."

Busca possÃ­vel:

{{code}}spl
index=auth action=failure | stats count by src_ip | sort - count | head 10
{{end}}

# ğŸ”µ Blue Team: Estudo de Casos â€“ Alertas Comuns em SOC

Um SOC (Security Operations Center) monitora constantemente eventos em tempo real com base em **alertas automÃ¡ticos**. Esses alertas sÃ£o essenciais para identificar atividades suspeitas, ameaÃ§as ou violaÃ§Ãµes em andamento.

Este estudo de caso apresenta **exemplos reais de alertas comuns**, especialmente Ãºteis para analistas de Blue Team iniciantes e intermediÃ¡rios.

Alertas nÃ£o servem para gritar, mas para informar com inteligÃªncia.

## ğŸš¨ 1. Tentativas de Brute-force

### ğŸ¯ Objetivo:
Detectar **mÃºltiplas falhas de autenticaÃ§Ã£o** em um curto perÃ­odo de tempo.

### ğŸ§  LÃ³gica do alerta:
- Muitos eventos de falha de login (Windows Event ID 4625)  
- Mesma origem IP ou mesmo usuÃ¡rio  
- Curto intervalo de tempo

### ğŸ•µï¸ Exemplo em Splunk:

{{code}}spl
index=wineventlog EventCode=4625 
| stats count by src_ip, user 
| where count > 10
{{end}}

Esse alerta detecta IPs ou usuÃ¡rios com mais de 10 falhas de login.

## ğŸš¨ 2. ExecuÃ§Ã£o de Comandos Suspeitos

### ğŸ¯ Objetivo:
Identificar execuÃ§Ãµes de comandos ou scripts potencialmente perigosos.

### ğŸ§  LÃ³gica do alerta:
- DetecÃ§Ã£o de `cmd.exe`, `powershell.exe`, `wscript.exe`  
- Comandos com uso de `base64`, `invoke`, `download`, `encodedcommand`

### ğŸ•µï¸ Exemplo em Splunk:

{{code}}spl
index=windows EventCode=4688 
| where CommandLine LIKE "%powershell%" AND CommandLine LIKE "%base64%"
{{end}}

Esse alerta flagra o uso de PowerShell com codificaÃ§Ã£o base64 (comum em malware).

## ğŸš¨ 3. Novo UsuÃ¡rio Criado em HorÃ¡rio Incomum

### ğŸ¯ Objetivo:
Detectar criaÃ§Ã£o de contas suspeitas fora do horÃ¡rio comercial.

### ğŸ§  LÃ³gica do alerta:
- Event ID 4720 (novo usuÃ¡rio)  
- HorÃ¡rio entre 00:00 e 06:00

### ğŸ•µï¸ Exemplo em Splunk:

{{code}}spl
index=wineventlog EventCode=4720 
| eval hour=strftime(_time,"%H") 
| where hour < 6
{{end}}

Esse alerta aponta criaÃ§Ãµes de usuÃ¡rio entre meia-noite e 6h da manhÃ£.

## ğŸš¨ 4. Atividade Remota NÃ£o Comum (ex: RDP fora do padrÃ£o)

### ğŸ¯ Objetivo:
Detectar conexÃµes remotas anÃ´malas ou fora do paÃ­s esperado.

### ğŸ§  LÃ³gica do alerta:
- Logons via RDP (LogonType=10)  
- PaÃ­s/IP fora do perfil da empresa

### ğŸ•µï¸ Exemplo:

{{code}}spl
index=wineventlog EventCode=4624 LogonType=10 
| iplocation src_ip 
| search Country!="Brazil"
{{end}}

Esse alerta detecta acessos RDP de fora do paÃ­s.

## ğŸš¨ 5. ExecuÃ§Ã£o de BinÃ¡rios Raros (Living off the Land)

### ğŸ¯ Objetivo:
Detectar o uso de binÃ¡rios do sistema que podem ser abusados (LOLBins).

### âš ï¸ Exemplos:
- `mshta.exe`, `certutil.exe`, `regsvr32.exe`, `rundll32.exe`

### ğŸ•µï¸ Exemplo de alerta:

{{code}}spl
index=windows EventCode=4688 
| search NewProcessName IN ("*mshta.exe", "*certutil.exe", "*regsvr32.exe")
{{end}}

Esses processos sÃ£o frequentemente usados em ataques fileless.

## ğŸ›¡ï¸ Dicas de Blue Team:

- Automatize esses alertas via SIEM para resposta rÃ¡pida  
- Crie **baselines normais** para comparar com desvios  
- Utilize blocos como `threat_intel`, `lookup`, `geoip` para enriquecer alertas  
- Combine logs de endpoints, rede e identidade para mais precisÃ£o

## âœ… ConclusÃ£o

Dominar alertas comuns permite que o analista:

- ğŸ•’ Ganhe agilidade na triagem de incidentes  
- ğŸš© Reduza falsos positivos com ajustes finos  
- ğŸ“ˆ FortaleÃ§a regras com base em observaÃ§Ãµes reais  
- ğŸ’¡ Evolua o SOC para um modelo mais inteligente e preditivo

# ğŸ”µ Blue Team: SimulaÃ§Ã£o com ELK Stack â€“ IngestÃ£o de Logs e Buscas

O **ELK Stack** (Elasticsearch, Logstash e Kibana) Ã© uma das ferramentas mais usadas para centralizaÃ§Ã£o de logs, buscas e visualizaÃ§Ãµes em ambientes de seguranÃ§a.  
Essa simulaÃ§Ã£o mostra como fazer uma ingestÃ£o bÃ¡sica de logs e executar buscas Ãºteis para o Blue Team.

Com ELK, atÃ© um simples log do sistema se transforma em inteligÃªncia de seguranÃ§a.

## ğŸ“¦ O que Ã© o ELK Stack?

- **Elasticsearch:** mecanismo de busca e armazenamento dos dados indexados  
- **Logstash:** pipeline de coleta, transformaÃ§Ã£o e envio de logs  
- **Kibana:** interface web para visualizaÃ§Ã£o e anÃ¡lise dos dados  

## ğŸ› ï¸ Ambiente da simulaÃ§Ã£o

- ELK local ou via Docker  
- Logstash configurado para receber logs de arquivos locais (ex: `/var/log/auth.log`)  
- Kibana acessÃ­vel em `http://localhost:5601`  
- Logs simulados de Linux e autenticaÃ§Ã£o

## ğŸ“¥ Etapa 1 â€“ IngestÃ£o de logs com Logstash

O Logstash utiliza um **pipeline** com trÃªs seÃ§Ãµes: `input`, `filter` e `output`.

### ğŸ“„ Exemplo de pipeline (`logstash.conf`):

{{code}}bash
input {
  file {
    path => "/var/log/auth.log"
    start_position => "beginning"
  }
}

filter {
  grok {
    match => { "message" => "%{SYSLOGTIMESTAMP:timestamp} %{HOSTNAME:host} sshd.*Failed password for %{USER:user} from %{IP:src_ip}" }
  }
}

output {
  elasticsearch {
    hosts => ["http://localhost:9200"]
    index => "linux-auth"
  }
  stdout { codec => rubydebug }
}
{{end}}

Esse pipeline lÃª falhas de login SSH e envia para o Ã­ndice `linux-auth`.

## ğŸ“Š Etapa 2 â€“ Visualizando no Kibana

1. Acesse o **Kibana** em `http://localhost:5601`  
2. VÃ¡ em **Stack Management > Index Patterns**  
3. Crie um padrÃ£o com o Ã­ndice `linux-auth*`  
4. VÃ¡ em **Discover** para ver os eventos em tempo real

## ğŸ” Etapa 3 â€“ Buscas Ãºteis para Blue Team

### â— Falhas de login SSH

{{code}}kibana
message: "Failed password"
{{end}}

### ğŸ“ˆ Quantidade de falhas por IP

{{code}}kibana
message: "Failed password"
| stats count by src_ip
{{end}}

### ğŸ” IPs com mÃºltiplas tentativas

{{code}}kibana
message: "Failed password"
| stats count by src_ip
| where count > 5
{{end}}

### â±ï¸ Tentativas fora do horÃ¡rio comercial

{{code}}kibana
message: "Failed password"
| eval hour = date_format(timestamp, "H")
| where hour < 6 OR hour > 20
{{end}}

> As buscas no Kibana podem ser feitas com filtros simples ou usando **Lens** e **Visualize** para dashboards.

## ğŸ§  Dicas prÃ¡ticas:

- Use **grok** para estruturar logs sem formataÃ§Ã£o (ex: logs brutos do Linux)  
- Configure **alertas** com o Kibana Alerts (Watcher) ou Elastic Security  
- Combine com **beats** (ex: Filebeat) para facilitar a coleta de logs remotos  
- Visualize falhas e sucessos de login, execuÃ§Ãµes de comando e mudanÃ§as de usuÃ¡rios

## âœ… ConclusÃ£o

Com o ELK Stack, Ã© possÃ­vel construir uma soluÃ§Ã£o poderosa e gratuita para:

- Centralizar logs de servidores, firewalls e endpoints  
- Investigar tentativas de intrusÃ£o em tempo real  
- Criar alertas e relatÃ³rios automatizados  
- Apoiar investigaÃ§Ãµes forenses com base histÃ³rica

# ğŸ”µ Blue Team: Estudo de Logs em SIEM (Sysmon, DNS, Proxy, Endpoint)

O sucesso da anÃ¡lise de seguranÃ§a no SIEM depende da **qualidade dos logs** que ele recebe. Para que o Blue Team consiga detectar comportamentos suspeitos e responder a incidentes de forma eficaz, Ã© essencial compreender os principais tipos de log e o que cada um pode revelar.

Este guia cobre os logs mais importantes no contexto de um SIEM: **Sysmon, DNS, Proxy e Endpoint**.

Quem domina os logs, controla a narrativa de um incidente.

---

## ğŸ§  O que Ã© log no contexto de SIEM?

Logs sÃ£o registros de atividades geradas por sistemas, aplicativos, dispositivos de rede e endpoints. O SIEM coleta, indexa e correlaciona esses eventos para:

- Identificar comportamentos anÃ´malos
- Gerar alertas de seguranÃ§a
- Ajudar na resposta a incidentes
- Facilitar investigaÃ§Ãµes forenses

---

## ğŸ› ï¸ 1. Sysmon (System Monitor)

O Sysmon Ã© uma ferramenta da Microsoft que registra eventos detalhados sobre o sistema operacional. Ele Ã© instalado como um serviÃ§o e produz logs no canal de eventos do Windows.

### Eventos relevantes no SIEM:

| Event ID | DescriÃ§Ã£o                            |
|----------|--------------------------------------|
| 1        | CriaÃ§Ã£o de processo                  |
| 3        | ConexÃ£o de rede                      |
| 7        | CriaÃ§Ã£o de imagem carregada (DLLs)   |
| 11       | CriaÃ§Ã£o de arquivo                   |
| 13       | ModificaÃ§Ã£o de chave do Registro     |

### UtilizaÃ§Ã£o prÃ¡tica:

- Identificar execuÃ§Ã£o de PowerShell suspeito
- Detectar movimentaÃ§Ã£o lateral via processos remotos
- Mapear conexÃµes de rede iniciadas por malware

---

## ğŸŒ 2. Logs de DNS

Os logs de DNS mostram quais domÃ­nios foram consultados por sistemas e usuÃ¡rios, funcionando como uma janela para os alvos de comunicaÃ§Ã£o na rede.

### Dados comuns em logs DNS:

- Nome do domÃ­nio consultado
- IP de origem (host)
- Timestamp da requisiÃ§Ã£o
- Resposta do servidor

### UtilizaÃ§Ã£o prÃ¡tica:

- Detectar conexÃµes com domÃ­nios maliciosos (C2, phishing)
- Identificar tunneling de dados via DNS
- Criar listas de bloqueio a partir de IOCs

---

## ğŸŒ 3. Logs de Proxy

Proxies interceptam o trÃ¡fego web, e seus logs sÃ£o ricos em dados de navegaÃ§Ã£o. Um SIEM bem alimentado com logs de proxy Ã© fundamental para monitorar acesso a conteÃºdo suspeito.

### Campos Ãºteis:

- URL acessada
- MÃ©todo HTTP (GET, POST, etc.)
- CÃ³digo de resposta (200, 403, etc.)
- IP/usuÃ¡rio de origem
- Volume de dados trafegado

### UtilizaÃ§Ã£o prÃ¡tica:

- Detectar acesso a domÃ­nios suspeitos ou proibidos
- Identificar comportamento anÃ´malo de navegaÃ§Ã£o
- Correlacionar usuÃ¡rios com exfiltraÃ§Ã£o de dados

---

## ğŸ’» 4. Logs de Endpoint (EDR/AntivÃ­rus)

Os endpoints sÃ£o a linha de frente contra ameaÃ§as. Ferramentas de EDR (como CrowdStrike, SentinelOne, Defender for Endpoint) geram eventos sobre comportamento de processos, arquivos, usuÃ¡rios e rede.

### Tipos de eventos:

- ExecuÃ§Ã£o de binÃ¡rios
- Acesso/modificaÃ§Ã£o de arquivos
- DetecÃ§Ã£o de malware
- ElevaÃ§Ã£o de privilÃ©gios
- PersistÃªncia suspeita

### UtilizaÃ§Ã£o prÃ¡tica:

- Detectar ransomware ou execuÃ§Ã£o de scripts automatizados
- Correlacionar aÃ§Ãµes maliciosas com o usuÃ¡rio responsÃ¡vel
- Monitorar atividade pÃ³s-comprometimento

---

## ğŸ§© Correlacionando logs no SIEM

O verdadeiro poder de um SIEM estÃ¡ na correlaÃ§Ã£o entre fontes diferentes. Por exemplo:

- Sysmon registra a execuÃ§Ã£o de `powershell.exe`
- DNS mostra conexÃ£o com domÃ­nio suspeito
- Proxy indica upload para serviÃ§o externo
- Endpoint alerta para comportamento anÃ´malo do processo

Essa sequÃªncia pode indicar exfiltraÃ§Ã£o de dados via PowerShell e DNS tunneling.

---

## âœ… ConclusÃ£o

Um bom analista de Blue Team precisa dominar a leitura e interpretaÃ§Ã£o dos logs mais comuns em ambientes corporativos. Entender o **contexto** e o **valor analÃ­tico** de cada tipo de log permite criar alertas eficazes, acelerar investigaÃ§Ãµes e melhorar a postura defensiva da organizaÃ§Ã£o.
---
title: "Blue Team: O que é Blue Team ?"
date: 2025-06-26 16:30:00 -0300
categories: [Blue Team, Nivel 1]
tags: [Teorica]
description: ""
image:
  path: /assets/img/000/capa.webp
  alt: Ilustração de um computador moderno com elementos de código e processamento
---

# 🔵 1. Blue Team: Introdução à Segurança da Informação

A atuação de um profissional de Blue Team começa com a compreensão dos **fundamentos da Segurança da Informação**. Nesta introdução, você vai entender os pilares CIA, os tipos de ameaças, os riscos associados e os principais controles de proteção utilizados para manter os ambientes seguros.

Não há defesa eficaz sem entender o que estamos tentando proteger.

## 🔐 O que é Segurança da Informação?

Segurança da Informação é o conjunto de práticas, políticas e processos voltados para proteger dados e sistemas contra acessos não autorizados, danos, vazamentos e interrupções.


## 🧱 Princípios Fundamentais – Modelo **CIA**

O modelo CIA representa os **três pilares essenciais da segurança**:

- **C – Confidencialidade (Confidentiality):**  
  Garante que as informações sejam acessadas apenas por pessoas autorizadas.  
  *Ex: Criptografia, autenticação de dois fatores.*

- **I – Integridade (Integrity):**  
  Assegura que os dados não sejam alterados indevidamente, mantendo sua exatidão e confiabilidade.  
  *Ex: Checksums, logs de auditoria, controle de versões.*

- **A – Disponibilidade (Availability):**  
  Garante que os sistemas e dados estejam disponíveis sempre que necessário.  
  *Ex: Backup, balanceamento de carga, redundância.*


## ⚠️ Tipos Comuns de Ameaças

Uma **ameaça** é qualquer evento ou agente que tenha o potencial de causar dano à informação ou aos sistemas.

- **Malwares:** vírus, worms, trojans, ransomware  
- **Ataques de rede:** DDoS, sniffing, spoofing  
- **Ameaças internas:** usuários mal-intencionados ou negligentes  
- **Phishing e engenharia social**  
- **Vulnerabilidades exploradas (zero-day, exploits)**


## 🎯 Risco em Segurança

**Risco = Ameaça × Vulnerabilidade × Impacto**

O risco é a **probabilidade de um incidente ocorrer**, levando em conta a existência de vulnerabilidades e o impacto que isso pode gerar.

*Exemplo:*  
Um servidor exposto à internet sem patch é uma vulnerabilidade. Se uma ameaça conhecida explorar essa falha, o risco é elevado.


## 🛡️ Controles de Segurança

Os **controles** são mecanismos implementados para reduzir riscos, prevenir, detectar ou responder a incidentes.

### 🔒 Tipos de Controles:

- **Preventivos:** impedem que incidentes ocorram  
  *Ex: Firewall, autenticação multifator, políticas de senha*

- **Detectivos:** identificam que algo está acontecendo  
  *Ex: SIEM, IDS, logs, alertas*

- **Corretivos:** minimizam o dano após um incidente  
  *Ex: Backup, plano de resposta a incidentes, restauração de sistemas*

- **Deterrentes:** desestimulam ações maliciosas  
  *Ex: Câmeras, avisos de monitoramento, políticas visíveis*


## 🧠 Por que isso é importante para o Blue Team?

Um analista Blue Team deve conhecer profundamente esses fundamentos para:

- Compreender e classificar incidentes de forma adequada  
- Escolher os controles certos para cada tipo de risco  
- Monitorar eventos com foco em ameaças reais  
- Aplicar boas práticas com base no modelo CIA

# 🔵 2. O que é Blue Team?

O **Blue Team** é o grupo responsável pela **defesa cibernética** de uma organização. Sua missão é proteger sistemas, redes, aplicações e dados contra ameaças internas e externas, detectando, respondendo e mitigando ataques em tempo real.


## 🎯 Objetivo

Garantir a **resiliência e segurança contínua** do ambiente de TI, monitorando atividades, detectando anomalias e **respondendo rapidamente a incidentes de segurança**.

Enquanto o Red Team pensa como o inimigo, o Blue Team protege como um guardião incansável.

## 🛡️ Atividades Comuns

- Monitoramento contínuo de redes e sistemas  
- Análise e correlação de logs (com SIEMs)  
- Detecção e resposta a incidentes (SOC, CSIRT)  
- Threat Hunting (busca ativa por ameaças)  
- Aplicação de patches e hardening de sistemas  
- Gestão de vulnerabilidades  
- Análise de malwares e forense digital  
- Implementação de políticas e controles de segurança  


## 🔄 Ciclo de Trabalho

1. **Monitorar** (com ferramentas como SIEM e EDR)  
2. **Detectar** comportamentos anômalos  
3. **Responder** a incidentes rapidamente  
4. **Recuperar** sistemas afetados  
5. **Aprimorar** defesas com base no aprendizado


## 🧠 Perfis do Time

- Analista SOC (níveis 1, 2 e 3)  
- Analista de Resposta a Incidentes (CSIRT)  
- Threat Hunter  
- Especialista em Forense  
- Blue Team Engineer / Security Analyst  
- Profissionais com certificações como:  
  - CompTIA Security+  
  - GCIA, GCIH (SANS)  
  - CEH (Certified Ethical Hacker)  
  - Blue Team Level 1/2 (BTL1, BTL2)


## 🛠️ Ferramentas Usadas

- **SIEMs**: Splunk, ELK, QRadar, Microsoft Sentinel  
- **EDR/XDR**: CrowdStrike, SentinelOne, Microsoft Defender  
- **SOAR**: Cortex XSOAR, IBM Resilient  
- **Forense**: Autopsy, Volatility, FTK  
- **Análise de Tráfego**: Wireshark, Zeek, Suricata  
- **Gestão de vulnerabilidades**: Nessus, Qualys, OpenVAS


## 🤝 Relação com Outros Times

- **Red Team (🔴):** Testa as defesas da equipe azul com ataques simulados  
- **Purple Team (🟣):** Integra Red + Blue para melhorar continuamente ambos  
- **White Team (⚪):** Supervisiona e define as regras dos exercícios  


## 📚 Frameworks e Referências

- **MITRE ATT&CK for Defense**  
- NIST 800-61 (Guia de Resposta a Incidentes)  
- CIS Controls v8  
- NIST CSF (Cybersecurity Framework)


## ✅ Benefícios para a Organização

- Redução de tempo de resposta a incidentes  
- Menor risco de vazamentos e perdas de dados  
- Detecção precoce de ameaças  
- Resiliência operacional frente a ataques  
- Melhoria contínua da postura de segurança

# 🔵 3. Blue Team: Fundamentos de Redes

Para atuar de forma eficaz na defesa cibernética, um profissional Blue Team precisa compreender os **fundamentos das redes**. Esses conhecimentos são essenciais para analisar tráfego, detectar comportamentos anômalos e identificar ameaças que se propagam pela rede.

A base de toda defesa é entender como o tráfego legítimo se comporta.

## 🧱 Modelo OSI – A Estrutura da Comunicação

O **modelo OSI** (Open Systems Interconnection) divide a comunicação em **7 camadas**, facilitando a análise de como os dados trafegam.

| Camada | Nome                      | Função Principal                                |
|--------|---------------------------|--------------------------------------------------|
| 7      | Aplicação                 | Interação com o usuário (HTTP, DNS, FTP)         |
| 6      | Apresentação              | Criptografia, compressão (TLS, JPEG)             |
| 5      | Sessão                    | Controle de sessões (RPC, NetBIOS)               |
| 4      | Transporte                | Controle de fluxo (TCP, UDP)                     |
| 3      | Rede                      | Roteamento e endereçamento (IP)                  |
| 2      | Enlace de Dados           | MAC, switches, detecção de erros                 |
| 1      | Física                    | Cabos, sinais, hubs                              |


## 🌐 Endereçamento IP (IPv4)

O endereço IP (Internet Protocol) identifica um dispositivo em uma rede.  
Exemplo de IPv4: `192.168.0.10`

- **Classe A, B, C**: categorias de endereços  
- **IP privado:** não acessível da internet (ex: 192.168.x.x)  
- **IP público:** utilizado para comunicação externa  
- **Máscara de sub-rede:** define o tamanho da rede (ex: 255.255.255.0)


## 📡 Protocolo DNS

O **DNS (Domain Name System)** traduz nomes de domínio (ex: google.com) para endereços IP.

- **Tipo de registro:** A (IPv4), AAAA (IPv6), MX (e-mail), TXT (SPF, DKIM)  
- **Resolução direta e reversa**  
- **Ataques comuns:** DNS spoofing, tunneling, amplification


## 🌐 Protocolo HTTP/HTTPS

O **HTTP (Hypertext Transfer Protocol)** é o protocolo da web.  
O **HTTPS** é a versão segura (com TLS).

- **Métodos comuns:** GET, POST, PUT, DELETE  
- **Códigos de resposta:**  
  - 200 OK  
  - 403 Forbidden  
  - 404 Not Found  
  - 500 Internal Server Error  
- **Cabeçalhos importantes:** User-Agent, Host, Cookie  


## 🔁 Protocolos TCP e UDP

### 🧩 TCP (Transmission Control Protocol)

- Confiável (garante entrega)  
- Utiliza o **three-way handshake** (SYN, SYN-ACK, ACK)  
- Aplicações: HTTP, HTTPS, SSH, SMTP

### 🧩 UDP (User Datagram Protocol)

- Não confiável (sem garantia de entrega)  
- Mais rápido, usado em streaming, DNS, VoIP  
- Aplicações: DNS, DHCP, SNMP, NTP


## 🛡️ Relevância para o Blue Team

Dominar os conceitos de redes é essencial para:

- Analisar **pacotes com Wireshark**  
- Compreender alertas de **IDS/IPS (Snort, Suricata)**  
- Criar **regras de detecção em SIEM**  
- Monitorar tráfego anômalo e identificar **exfiltrações de dados**  
- Investigar **técnicas de C2** e **comunicação maliciosa**

# 🔵 4. Blue Team: Leitura e Interpretação de Pacotes com Wireshark

O **Wireshark** é uma das ferramentas mais importantes para profissionais de segurança da informação, especialmente para o time Blue Team. Ele permite a análise de tráfego de rede em tempo real ou capturado em arquivos `.pcap`, ajudando na investigação de incidentes, anomalias e comportamento malicioso.

Quem domina o tráfego de rede tem o poder de entender, prever e bloquear ataques antes que causem dano.

## 🐬 O que é o Wireshark?

O **Wireshark** é um analisador de pacotes gratuito e de código aberto usado para capturar e inspecionar o tráfego de rede até o nível de cada bit, seguindo o modelo OSI.


## 📦 O que é um pacote?

Um **pacote de rede** é uma unidade de dados transmitida entre dispositivos em uma rede. Ele contém informações sobre origem, destino, tipo de protocolo, dados e muito mais.


## 📥 Como capturar pacotes com Wireshark?

1. **Selecionar a interface de rede ativa** (ex: Ethernet ou Wi-Fi)<br>
2. Clicar em **"Start capturing packets"**<br>
3. Observar os pacotes sendo listados em tempo real<br>
4. Utilizar **filtros** para refinar a captura e análise<br>


## 🎯 Filtros de Captura e de Exibição

### 🔹 Filtros de captura (antes de iniciar):
- `tcp port 80` → captura somente tráfego HTTP  
- `host 192.168.1.10` → tráfego de um IP específico  

### 🔹 Filtros de exibição (durante a análise):
- `http` → exibe apenas pacotes HTTP  
- `ip.addr == 8.8.8.8` → qualquer pacote com esse IP  
- `tcp.flags.syn == 1` → pacotes SYN (início de conexão TCP)  


## 🔍 Estrutura de um pacote (exemplo TCP)

Ao clicar em um pacote, o Wireshark mostra:

1. **Camada física / Ethernet**: origem e destino MAC  
2. **IP**: endereço de origem e destino  
3. **TCP/UDP**: portas, flags (SYN, ACK, RST, etc.)  
4. **Aplicação**: conteúdo HTTP, DNS, FTP, etc.  


## 🛠️ Exemplos práticos

### ✅ Verificando handshake TCP:

Use o filtro: `tcp.flags.syn == 1 && tcp.flags.ack == 0`  
Você verá o pacote **SYN**, sinalizando o início de uma conexão.

### ✅ Inspecionando requisição HTTP:

Use o filtro: `http.request`  
Você pode visualizar o método (GET/POST), o `User-Agent` e o `Host`.

### ✅ Identificando exfiltração via DNS:

Use o filtro: `dns`  
Análise de consultas suspeitas como `abc123.attacker.com` pode indicar tunneling.


## 🛡️ Aplicações para o Blue Team

- Análise de tráfego em incidentes de segurança  
- Detecção de comunicação com C2 (Command & Control)  
- Investigação de ataques (ex: DNS tunneling, malware callbacks)  
- Análise de exfiltração de dados  
- Compreensão de ataques como scans, DoS, brute-force  


## 📂 Fontes de arquivos `.pcap` para treino

- [https://www.malware-traffic-analysis.net](https://www.malware-traffic-analysis.net)  
- [https://www.netresec.com/?page=PcapFiles](https://www.netresec.com/?page=PcapFiles)  
- [https://www.tracewrangler.com/samplepcaps](https://www.tracewrangler.com/samplepcaps)


## 📘 Dica extra

Salve sessões suspeitas como `.pcap` e crie seu repositório de ameaças para futura referência. Isso ajuda a montar uma **base de IOC comportamental**.

# 🔵 5. Blue Team: Logs do Windows e Linux – Onde Estão e Como Ler

Um dos principais pilares da atuação do Blue Team é a **análise de logs**. Eles são a base para detecção de ameaças, resposta a incidentes e investigação forense. Saber **onde os logs ficam armazenados** e **como interpretá-los** é essencial para qualquer analista de segurança.

Logs são como a caixa preta de um sistema: quem sabe lê-los, entende tudo o que aconteceu – e o que está prestes a acontecer.

## 🪟 Logs no Windows

O Windows registra diversos eventos importantes em seus **logs de eventos (Event Logs)**. Esses logs podem ser visualizados usando o **Event Viewer** (`eventvwr.msc`) ou exportados para análise posterior.

### 🗂️ Principais categorias de logs:

| Log                   | Caminho no Event Viewer                         | O que contém                                |
|-----------------------|--------------------------------------------------|----------------------------------------------|
| **Application**       | Event Viewer → Windows Logs → Application       | Erros de aplicativos, falhas de sistema      |
| **System**            | Event Viewer → Windows Logs → System            | Driver, kernel, falhas de hardware           |
| **Security**          | Event Viewer → Windows Logs → Security          | Eventos de login, tentativas de acesso       |
| **Setup**             | Event Viewer → Windows Logs → Setup             | Instalações, atualizações                     |
| **Forwarded Events**  | Event Viewer → Applications and Services Logs   | Logs de eventos recebidos via forwarding     |


### 🔐 Eventos de segurança importantes:

| Evento ID | Descrição                                     |
|-----------|-----------------------------------------------|
| 4624      | Logon bem-sucedido                            |
| 4625      | Tentativa de logon falha                      |
| 4688      | Criação de processo                           |
| 4697      | Instalação de novo serviço                    |
| 4719      | Política de auditoria alterada                |
| 4720–4732 | Criação/modificação de contas e grupos        |


### 📍 Local físico dos logs:

- Caminho: `C:\Windows\System32\winevt\Logs\`  
- Extensão: `.evtx`  
- Leitura com: Event Viewer, PowerShell, ou ferramentas como **Log Parser**, **EventLog Explorer**


## 🐧 Logs no Linux

No Linux, os logs geralmente são armazenados em arquivos de texto localizados em `/var/log`. O sistema de logging pode variar (ex: `rsyslog`, `journald`, `syslog-ng`), mas a estrutura geral se mantém.

### 🗂️ Principais arquivos de log:

| Caminho                  | Descrição                                      |
|--------------------------|------------------------------------------------|
| `/var/log/syslog`        | Log geral do sistema (Debian/Ubuntu)           |
| `/var/log/messages`      | Log geral do sistema (RHEL/CentOS)             |
| `/var/log/auth.log`      | Log de autenticação e sudo (Debian/Ubuntu)     |
| `/var/log/secure`        | Log de autenticação (RHEL/CentOS)              |
| `/var/log/boot.log`      | Mensagens de inicialização do sistema          |
| `/var/log/kern.log`      | Logs do kernel                                 |
| `/var/log/faillog`       | Tentativas de login inválidas                  |
| `/var/log/wtmp` / `last` | Histórico de logins                            |


### 🔍 Como visualizar logs:

- `cat /var/log/auth.log` – imprime o conteúdo  
- `tail -f /var/log/syslog` – monitora em tempo real  
- `grep "sshd" /var/log/auth.log` – filtra por palavra-chave  
- `journalctl` – visualiza logs do `systemd` (em distribuições modernas)


## 🛡️ Por que isso importa para o Blue Team?

- Monitorar **logons suspeitos**, escaladas de privilégio e uso do sudo  
- Detectar **criações de usuários, serviços ou processos anômalos**  
- Verificar **tentativas de brute-force**, malware persistente e atividades fora do horário normal  
- Correlacionar logs entre Windows e Linux para detectar **movimentação lateral**  


## 🧰 Ferramentas úteis para análise de logs

- **Windows:** Event Viewer, PowerShell, EventLog Explorer, Log Parser  
- **Linux:** journalctl, grep, ausearch, Logwatch  
- **SIEMs:** Splunk, ELK, Wazuh, Sentinel (para ingestão e análise centralizada)


## 🧠 Dica prática

Crie um **checklist de eventos críticos** para monitorar em cada sistema e aplique filtros regulares para identificar padrões. Isso economiza tempo e aumenta a eficácia na detecção.

# 🔵 6. Blue Team: Segurança em Autenticação – MFA, Hashes, Senhas e Tokens

A **autenticação segura** é uma das primeiras linhas de defesa contra acessos não autorizados. O Blue Team precisa entender profundamente os mecanismos modernos de autenticação para proteger usuários, sistemas e redes.

Senhas são como escovas de dentes: pessoais, devem ser trocadas regularmente e nunca compartilhadas.

## 🔐 O que é Autenticação?

**Autenticação** é o processo de verificar se um usuário ou sistema é realmente quem diz ser.  
Ela geralmente envolve um ou mais dos seguintes fatores:

- **Algo que você sabe** → senha, PIN  
- **Algo que você tem** → token, celular  
- **Algo que você é** → biometria  


## 🔢 MFA – Autenticação Multifator

O **MFA (Multi-Factor Authentication)** adiciona camadas de segurança exigindo mais de um fator de autenticação.

### ✅ Exemplos de MFA:
- Senha + código via SMS  
- Senha + token no aplicativo (Google Authenticator, Microsoft Authenticator)  
- PIN + impressão digital  

### 🎯 Vantagens do MFA:
- Dificulta o uso de credenciais vazadas  
- Reduz risco de ataques por força bruta  
- Mitiga sequestro de sessão e phishing simples  

### ⚠️ Atenção:
- SMS como 2FA é melhor do que nada, mas ainda **vulnerável a SIM Swap**  
- Sempre prefira aplicativos de MFA ou chaves FIDO2/YubiKey


## 🔑 Hashes de Senhas

As senhas **nunca devem ser armazenadas em texto claro**. Elas devem ser convertidas em **hashes**, uma representação criptográfica que não pode ser revertida diretamente.

### 🔐 O que é um hash?
Um hash é o resultado de aplicar uma função matemática a uma entrada (senha), gerando uma saída de tamanho fixo.

### 🔹 Exemplos de funções de hash:
- **MD5** – desatualizado e inseguro  
- **SHA-1** – também inseguro  
- **SHA-256** – mais forte, mas puro ainda não ideal para senhas  
- **bcrypt, scrypt, Argon2** – recomendadas para proteger senhas

### ⚠️ Boa prática:
Sempre aplicar **salting** (adicionar dados únicos à senha antes de gerar o hash) para evitar ataques com rainbow tables.


## 🔐 Senhas: Boas Práticas

- Tamanho mínimo recomendado: **12 caracteres**  
- Evite usar informações pessoais (nome, data, time)  
- Use **gerenciadores de senhas** (Bitwarden, 1Password, KeePass)  
- Nunca reutilize senhas entre sistemas  
- Habilite MFA sempre que possível  


## 🎫 Tokens de Acesso

Tokens são **credenciais temporárias e controladas**, usadas para autenticação e autorização.

### 🔹 Tipos comuns:

| Tipo         | Uso                                 |
|--------------|--------------------------------------|
| **TOTP**     | Token baseado em tempo (Google Auth) |
| **JWT**      | JSON Web Token, comum em APIs        |
| **OAuth2**   | Autorização delegada (Google Login)  |
| **FIDO2/WebAuthn** | Autenticação por chave física ou biometria |

### 🔐 JWT (JSON Web Token):
- Contém: header, payload, signature  
- Usado para autenticação em aplicações web  
- Deve ser assinado e, idealmente, criptografado  

### ⚠️ Riscos:
- Tokens expostos em URL, console ou header podem ser interceptados  
- Falta de expiração ou revogação é um problema comum  


## 🛡️ Relevância para o Blue Team

- Monitorar **falhas de login repetidas** (brute-force)  
- Detectar **acessos sem MFA** ou **tokens reutilizados**  
- Validar segurança do armazenamento de senhas  
- Criar **alertas de login suspeito (localização, horário, device)**  
- Auxiliar na **educação de usuários** e adoção de boas práticas  


## 🧰 Ferramentas úteis

- **Have I Been Pwned** – verificação de vazamentos de senha  
- **Authy / Google Authenticator** – MFA apps  
- **YubiKey / SoloKey** – autenticação com chave física  
- **Hashcat / John the Ripper** – auditoria de hashes (uso ético)  
- **Vault / AWS Secrets Manager** – gerenciamento de segredos corporativos

# 🔵 7. Blue Team: Tipos de Ataques Comuns – Phishing, Malware, Brute-Force e MITM

Todo profissional de Blue Team precisa conhecer os principais **tipos de ataques** utilizados por ameaças cibernéticas. Reconhecer seus padrões e comportamentos é essencial para **prevenir, detectar e responder** de forma eficaz.

Você só pode se defender daquilo que é capaz de reconhecer.

## 🎣 Phishing – Engenharia Social Disfarçada

O **phishing** é um dos ataques mais comuns e eficazes. Consiste em **enganar o usuário** para que ele entregue informações confidenciais, como senhas ou dados bancários.

### 📌 Características:
- E-mails ou mensagens falsas com aparência legítima  
- Links que levam a sites clonados (ex: "banc0.com" em vez de "banco.com")  
- Anexos maliciosos (PDFs, Excel com macros, etc.)

### 🔍 Como detectar:
- Erros de ortografia e domínio estranho  
- Solicitações urgentes ou ameaçadoras  
- Arquivos suspeitos anexados

### 🛡️ Defesa Blue Team:
- Filtros de e-mail (SPF, DKIM, DMARC)  
- Treinamento de usuários  
- Sandboxing de anexos  
- Monitoramento de cliques e redirecionamentos


## 🦠 Malware – Software Malicioso

O **malware** é qualquer programa criado com a intenção de causar dano ou obter acesso não autorizado a sistemas.

### 🧩 Tipos comuns:
- **Ransomware:** criptografa arquivos e exige resgate  
- **Spyware:** coleta informações sem consentimento  
- **Trojans:** disfarçado como software legítimo  
- **Worms:** se replicam pela rede  
- **Rootkits:** ocultam presença de atacantes  

### 🛡️ Defesa Blue Team:
- EDR com detecção comportamental  
- Lista de bloqueio (blacklist) de hashes e domínios  
- Análise de IOC (hashes, conexões, artefatos)  
- Monitoramento de criação de processos e serviços (Windows ID 4688)


## 🔐 Brute-Force – Adivinhando Senhas

Ataques de força bruta consistem em **tentar várias combinações de senha** até acertar a correta. Variantes incluem:

- **Ataque direto:** tenta muitas senhas em um mesmo login  
- **Ataque de dicionário:** usa listas comuns de senhas  
- **Credential stuffing:** tenta combinações vazadas de outros serviços  

### 🔍 Indícios em logs:
- Múltiplas tentativas de login falhadas (Windows Event 4625)  
- Vários IPs tentando logar em um mesmo usuário  
- Tentativas fora do horário habitual  

### 🛡️ Defesa Blue Team:
- MFA obrigatório  
- Limitação de tentativas (lockout temporário)  
- Monitoramento e alerta de comportamento anômalo  
- Regras de detecção em SIEM (por IP, por usuário, por hora)


## 🕵️ MITM – Man-in-the-Middle

No **MITM (homem-no-meio)**, o atacante intercepta a comunicação entre duas partes para roubar dados, redirecionar tráfego ou modificar conteúdo.

### 🎯 Exemplos:
- Captura de tráfego em redes Wi-Fi públicas  
- DNS spoofing (redireciona sites legítimos para falsos)  
- SSL stripping (remove criptografia HTTPS)

### 🛡️ Defesa Blue Team:
- Encriptação forte de ponta a ponta (HTTPS, TLS)  
- DNSSEC e HSTS nos serviços da empresa  
- Certificados digitais válidos e monitorados  
- Monitoramento de certificados suspeitos e certificados wildcard fora do padrão


## 🔄 Conclusão

Compreender esses ataques é o primeiro passo para montar **controles, alertas e respostas eficientes**. O Blue Team atua de forma proativa e reativa para conter e impedir esses vetores de ataque.


## 🧠 Dica prática:

Crie uma **matriz de ameaças** no seu ambiente listando:

- Vetores mais comuns (e-mail, web, rede, endpoint)  
- Tipos de ataques associados  
- Controles já existentes e lacunas  
- IOCs e exemplos reais para treinar detecção

# 🔵 Blue Team: Introdução ao SIEM (conceito, uso, eventos)

Um dos principais aliados do Blue Team na detecção de ameaças é o **SIEM** – uma ferramenta que centraliza, organiza e analisa eventos de segurança. Dominar o uso do SIEM é essencial para prevenir, detectar e responder a incidentes em tempo real.

O SIEM é o radar do Blue Team – sem ele, você está voando às cegas.

## 🧠 O que é um SIEM?

**SIEM** significa *Security Information and Event Management*.  
É uma solução que coleta, armazena, correlaciona e analisa **eventos de segurança** gerados por dispositivos, sistemas e aplicações.


## 🎯 Objetivos principais do SIEM:

- **Centralizar logs** de diversos dispositivos (servidores, firewalls, endpoints, etc.)  
- **Detectar ameaças em tempo real** por meio de regras de correlação  
- **Gerar alertas de segurança** baseados em comportamentos anômalos  
- **Apoiar investigações e resposta a incidentes**  
- **Cumprir requisitos de auditoria e conformidade**


## 🗂️ Fontes comuns de eventos no SIEM

Um SIEM pode receber eventos de praticamente qualquer sistema. Exemplos:

- **Windows:** eventos de logon (4624, 4625), criação de processo (4688)  
- **Linux:** logs de autenticação (`/var/log/auth.log`), sudo, SSH  
- **Firewalls:** conexões permitidas/bloqueadas, NAT, regras violadas  
- **EDR/Antivírus:** detecção de malware, execução suspeita  
- **Serviços em nuvem:** AWS CloudTrail, Azure Monitor, Google Cloud Logging  
- **Aplicações:** falhas de autenticação, ações críticas de usuários  


## 🔍 Exemplo de evento no SIEM (Windows)

```json
{
  "EventID": 4625,
  "AccountName": "admin",
  "LogonType": 3,
  "IPAddress": "10.10.10.15",
  "Status": "0xC000006A",
  "TimeCreated": "2025-06-26T22:15:00"
}
```

Esse evento indica uma **tentativa de logon falha** em uma conexão de rede (tipo 3), vinda do IP `10.10.10.15`.


## ⚙️ Como o SIEM funciona (fluxo geral)

1. **Coleta:** agentes ou forwarders enviam logs dos dispositivos  
2. **Normalização:** dados brutos são estruturados em um formato comum  
3. **Indexação:** eventos são armazenados para consulta rápida  
4. **Correlação:** regras detectam padrões de ataque ou anomalias  
5. **Alerta:** notificações são geradas com base nas regras  
6. **Análise:** analistas investigam eventos por meio de dashboards e buscas  
7. **Resposta:** ações manuais ou automáticas são iniciadas


## 📌 Exemplos de uso prático no Blue Team

- Detectar **tentativas de brute-force** com múltiplos eventos 4625  
- Identificar **movimentação lateral** por logons RDP fora do padrão  
- Monitorar **execuções de comandos perigosos** (ex: PowerShell + base64)  
- Correlacionar logs de firewall com eventos de endpoint  
- Criar alertas baseados em **horários anômalos de login** ou **usuários privilegiados**


## 🛠️ Exemplos de ferramentas SIEM

| Nome         | Tipo        | Comentário                                 |
|--------------|-------------|--------------------------------------------|
| **Splunk**   | Comercial   | Muito robusto, flexível e escalável        |
| **ELK Stack**| Open-source | Elastic + Logstash + Kibana                |
| **Wazuh**    | Open-source | SIEM com foco em segurança e compliance    |
| **Microsoft Sentinel** | Cloud | Integrado ao Azure, fácil de automatizar |
| **Graylog**  | Open-source | Interface simples e eficaz                 |


## 🧠 Dica para iniciantes:

Comece aprendendo a **buscar eventos específicos**, como:

- `EventID=4625` → logons falhos  
- `cmd.exe` OU `powershell.exe` → execução de comandos  
- `src_ip:10.0.0.* AND dst_port:3389` → acessos RDP

Aos poucos, avance para **regras de correlação personalizadas**, alertas automatizados e uso de dashboards.

# 🔵 Blue Team: Treinamento – Splunk Fundamentals 1 (Módulos 1 e 2)

O curso **Splunk Fundamentals 1** é a porta de entrada oficial para o uso do Splunk, uma das ferramentas de SIEM mais poderosas do mercado. Os **módulos 1 e 2** apresentam os conceitos básicos de uso da plataforma, essenciais para analistas de Blue Team.

Buscar é o novo modo de investigar – e no Splunk, a linguagem é poder.

## 🎯 Objetivo do curso

Capacitar o aluno a navegar pela interface do Splunk, executar buscas básicas, usar comandos essenciais e compreender a estrutura dos dados.  

O conteúdo é gratuito e online, disponível na [Splunk Education](https://www.splunk.com/en_us/training.html).

## 📘 Módulo 1 – Introdução ao Splunk

### 🔹 O que é Splunk?

O Splunk é uma plataforma que permite coletar, indexar, pesquisar, visualizar e correlacionar dados de qualquer fonte (logs, métricas, eventos). Ele é amplamente utilizado para:

- Monitoramento de segurança (SIEM)  
- Observabilidade de sistemas  
- Resposta a incidentes  
- Detecção de ameaças  

### 🧱 Componentes principais:

- **Indexer:** onde os dados são armazenados e indexados  
- **Search Head:** onde o usuário faz buscas e visualizações  
- **Forwarder:** envia dados para o Indexer  
- **Deployment Server:** gerencia configurações em larga escala  

### 🧭 Navegando pela interface:

- **Search & Reporting:** painel principal de buscas  
- **Data Summary:** visualiza hosts, fontes e tipos de dados  
- **Apps:** módulos adicionais como Enterprise Security  
- **Settings:** configurações de dados, usuários e permissões  

## 📘 Módulo 2 – Executando Buscas no Splunk

### 🔎 Sintaxe básica de busca:

As buscas no Splunk começam com a palavra `search` (opcional) e utilizam filtros por palavras-chave, campos e comandos.  

**Exemplo simples:**

```spl
index=main error
```

Retorna eventos no índice `main` que contenham a palavra "error".


### 🗃️ Filtros comuns:

- `index=` → especifica qual índice de dados usar  
- `source=` → arquivo ou origem dos dados  
- `sourcetype=` → tipo de dado (ex: `WinEventLog:Security`)  
- `host=` → hostname de onde veio o log  

**Exemplo:**

```spl
index=ossec source="/var/log/auth.log" action=denied
```

### 🧠 Dica: Usar o botão **"Data Summary"** para descobrir os índices, fontes e tipos mais usados antes de buscar.

### 📊 Visualizações básicas:

Após executar uma busca, o Splunk permite criar gráficos a partir dos resultados com comandos como:

```spl
index=firewall action=blocked | stats count by src_ip
```
Esse comando conta quantas vezes cada IP de origem foi bloqueado.


### 🔧 Operadores úteis:

| Operador     | Descrição                         |
|--------------|-----------------------------------|
| `AND`        | Ambos os termos devem existir     |
| `OR`         | Um ou outro pode existir          |
| `NOT`        | Exclui eventos com esse termo     |
| `=`          | Busca por campo igual a valor     |
| `!=`         | Campo diferente do valor          |

## 🧠 Para praticar:

- Use os **datasets de demonstração** disponíveis na instância Splunk do curso  
- Crie buscas simples por falhas de login, comandos executados ou IPs suspeitos  
- Experimente filtros com `index=`, `source=`, `sourcetype=`, `host=`

## 🚀 Próximos módulos

Nos módulos seguintes, o curso aborda:

- Uso avançado do `stats`, `table`, `timechart`  
- Criação de dashboards  
- Alertas e relatórios programados  

# 🔵 Blue Team: Treinamento – Splunk Fundamentals 1 (Módulos 3 e 4)

Dando continuidade ao treinamento oficial **Splunk Fundamentals 1**, os módulos 3 e 4 aprofundam o uso da linguagem de busca do Splunk, introduzindo **campos, visualizações, estatísticas e comandos avançados**. São fundamentais para analistas de segurança que desejam criar investigações mais precisas e dashboards informativos.

Comandos como `stats` e `eval` transformam o analista de observador em investigador.

## 📘 Módulo 3 – Usando Campos no Splunk

### 📌 O que são Campos?

Campos são pares **chave:valor** extraídos dos eventos (como `src_ip=10.0.0.1`, `status=404`).  
O Splunk **detecta automaticamente** campos comuns, mas você pode **criar, filtrar e manipular** campos conforme necessário.

### 🔍 Usando campos em buscas

Você pode usar campos diretamente para refinar resultados:

{{code}}spl
index=web sourcetype=access_combined status=404
{{end}}

Isso retorna apenas eventos onde o status da requisição HTTP é 404.

### 🔧 Campos personalizados (rex, eval)

Você pode criar novos campos temporários durante a busca:

#### 📌 `eval` → Cria campos com lógica simples

{{code}}spl
... | eval risco=if(status==500, "alto", "baixo")
{{end}}

#### 📌 `rex` → Extrai campos usando expressões regulares

{{code}}spl
... | rex field=_raw "user=(?<username>\w+)"
{{end}}

Esse exemplo cria um campo chamado `username` extraído do conteúdo de `_raw`.

### 🧰 Comando `fields`

Usado para **mostrar ou ocultar** campos no resultado:

{{code}}spl
... | fields username, src_ip
{{end}}

## 📘 Módulo 4 – Usando Estatísticas e Visualizações

### 📊 Comando `stats`

O `stats` permite agregar dados e gerar resumos estatísticos.  
Exemplo: contar eventos por endereço IP:

{{code}}spl
index=firewall action=blocked | stats count by src_ip
{{end}}

### 📊 Outros comandos estatísticos:

| Comando          | Função                          |
|------------------|----------------------------------|
| `count`          | Conta eventos                   |
| `sum`            | Soma valores numéricos          |
| `avg`            | Média                           |
| `min` / `max`    | Mínimo / Máximo                 |
| `dc`             | Distinct count (valores únicos) |

### 🧮 Exemplo com múltiplas métricas:

{{code}}spl
index=web status=* | stats count, dc(clientip) by status
{{end}}

Conta o número total de eventos e o número de IPs únicos por status HTTP.


### 📈 Visualizações no Splunk

Você pode transformar buscas em **gráficos interativos**, como:

- **Barras** (por quantidade)  
- **Pizza** (por distribuição)  
- **Linha do tempo** (eventos ao longo do tempo)  
- **Mapa geográfico** (com dados de localização)  

#### Exemplo com `timechart`:

{{code}}spl
index=web status=200 | timechart count by host
{{end}}

Mostra quantos eventos 200 ocorreram ao longo do tempo, por host.

### 📋 Comando `table`

Mostra os dados em forma de tabela personalizada:

{{code}}spl
index=auth action=failure | table _time, user, src_ip
{{end}}

## ✅ Dicas práticas:

- Combine `stats`, `eval`, `table` e `fields` para criar visualizações ricas  
- Use `timechart` para análises temporais (com base em `_time`)  
- Utilize `dc(field)` para identificar **diversidade** de valores, útil em análise de comportamento  
- Evite usar `search *` (buscas amplas demais)

## 🧠 Exemplo de caso real:

> "Queremos descobrir os 10 IPs que mais geraram falhas de autenticação nos últimos 7 dias."

Busca possível:

{{code}}spl
index=auth action=failure | stats count by src_ip | sort - count | head 10
{{end}}

# 🔵 Blue Team: Estudo de Casos – Alertas Comuns em SOC

Um SOC (Security Operations Center) monitora constantemente eventos em tempo real com base em **alertas automáticos**. Esses alertas são essenciais para identificar atividades suspeitas, ameaças ou violações em andamento.

Este estudo de caso apresenta **exemplos reais de alertas comuns**, especialmente úteis para analistas de Blue Team iniciantes e intermediários.

Alertas não servem para gritar, mas para informar com inteligência.

## 🚨 1. Tentativas de Brute-force

### 🎯 Objetivo:
Detectar **múltiplas falhas de autenticação** em um curto período de tempo.

### 🧠 Lógica do alerta:
- Muitos eventos de falha de login (Windows Event ID 4625)  
- Mesma origem IP ou mesmo usuário  
- Curto intervalo de tempo

### 🕵️ Exemplo em Splunk:

{{code}}spl
index=wineventlog EventCode=4625 
| stats count by src_ip, user 
| where count > 10
{{end}}

Esse alerta detecta IPs ou usuários com mais de 10 falhas de login.

## 🚨 2. Execução de Comandos Suspeitos

### 🎯 Objetivo:
Identificar execuções de comandos ou scripts potencialmente perigosos.

### 🧠 Lógica do alerta:
- Detecção de `cmd.exe`, `powershell.exe`, `wscript.exe`  
- Comandos com uso de `base64`, `invoke`, `download`, `encodedcommand`

### 🕵️ Exemplo em Splunk:

{{code}}spl
index=windows EventCode=4688 
| where CommandLine LIKE "%powershell%" AND CommandLine LIKE "%base64%"
{{end}}

Esse alerta flagra o uso de PowerShell com codificação base64 (comum em malware).

## 🚨 3. Novo Usuário Criado em Horário Incomum

### 🎯 Objetivo:
Detectar criação de contas suspeitas fora do horário comercial.

### 🧠 Lógica do alerta:
- Event ID 4720 (novo usuário)  
- Horário entre 00:00 e 06:00

### 🕵️ Exemplo em Splunk:

{{code}}spl
index=wineventlog EventCode=4720 
| eval hour=strftime(_time,"%H") 
| where hour < 6
{{end}}

Esse alerta aponta criações de usuário entre meia-noite e 6h da manhã.

## 🚨 4. Atividade Remota Não Comum (ex: RDP fora do padrão)

### 🎯 Objetivo:
Detectar conexões remotas anômalas ou fora do país esperado.

### 🧠 Lógica do alerta:
- Logons via RDP (LogonType=10)  
- País/IP fora do perfil da empresa

### 🕵️ Exemplo:

{{code}}spl
index=wineventlog EventCode=4624 LogonType=10 
| iplocation src_ip 
| search Country!="Brazil"
{{end}}

Esse alerta detecta acessos RDP de fora do país.

## 🚨 5. Execução de Binários Raros (Living off the Land)

### 🎯 Objetivo:
Detectar o uso de binários do sistema que podem ser abusados (LOLBins).

### ⚠️ Exemplos:
- `mshta.exe`, `certutil.exe`, `regsvr32.exe`, `rundll32.exe`

### 🕵️ Exemplo de alerta:

{{code}}spl
index=windows EventCode=4688 
| search NewProcessName IN ("*mshta.exe", "*certutil.exe", "*regsvr32.exe")
{{end}}

Esses processos são frequentemente usados em ataques fileless.

## 🛡️ Dicas de Blue Team:

- Automatize esses alertas via SIEM para resposta rápida  
- Crie **baselines normais** para comparar com desvios  
- Utilize blocos como `threat_intel`, `lookup`, `geoip` para enriquecer alertas  
- Combine logs de endpoints, rede e identidade para mais precisão

## ✅ Conclusão

Dominar alertas comuns permite que o analista:

- 🕒 Ganhe agilidade na triagem de incidentes  
- 🚩 Reduza falsos positivos com ajustes finos  
- 📈 Fortaleça regras com base em observações reais  
- 💡 Evolua o SOC para um modelo mais inteligente e preditivo

# 🔵 Blue Team: Simulação com ELK Stack – Ingestão de Logs e Buscas

O **ELK Stack** (Elasticsearch, Logstash e Kibana) é uma das ferramentas mais usadas para centralização de logs, buscas e visualizações em ambientes de segurança.  
Essa simulação mostra como fazer uma ingestão básica de logs e executar buscas úteis para o Blue Team.

Com ELK, até um simples log do sistema se transforma em inteligência de segurança.

## 📦 O que é o ELK Stack?

- **Elasticsearch:** mecanismo de busca e armazenamento dos dados indexados  
- **Logstash:** pipeline de coleta, transformação e envio de logs  
- **Kibana:** interface web para visualização e análise dos dados  

## 🛠️ Ambiente da simulação

- ELK local ou via Docker  
- Logstash configurado para receber logs de arquivos locais (ex: `/var/log/auth.log`)  
- Kibana acessível em `http://localhost:5601`  
- Logs simulados de Linux e autenticação

## 📥 Etapa 1 – Ingestão de logs com Logstash

O Logstash utiliza um **pipeline** com três seções: `input`, `filter` e `output`.

### 📄 Exemplo de pipeline (`logstash.conf`):

{{code}}bash
input {
  file {
    path => "/var/log/auth.log"
    start_position => "beginning"
  }
}

filter {
  grok {
    match => { "message" => "%{SYSLOGTIMESTAMP:timestamp} %{HOSTNAME:host} sshd.*Failed password for %{USER:user} from %{IP:src_ip}" }
  }
}

output {
  elasticsearch {
    hosts => ["http://localhost:9200"]
    index => "linux-auth"
  }
  stdout { codec => rubydebug }
}
{{end}}

Esse pipeline lê falhas de login SSH e envia para o índice `linux-auth`.

## 📊 Etapa 2 – Visualizando no Kibana

1. Acesse o **Kibana** em `http://localhost:5601`  
2. Vá em **Stack Management > Index Patterns**  
3. Crie um padrão com o índice `linux-auth*`  
4. Vá em **Discover** para ver os eventos em tempo real

## 🔍 Etapa 3 – Buscas úteis para Blue Team

### ❗ Falhas de login SSH

{{code}}kibana
message: "Failed password"
{{end}}

### 📈 Quantidade de falhas por IP

{{code}}kibana
message: "Failed password"
| stats count by src_ip
{{end}}

### 🔎 IPs com múltiplas tentativas

{{code}}kibana
message: "Failed password"
| stats count by src_ip
| where count > 5
{{end}}

### ⏱️ Tentativas fora do horário comercial

{{code}}kibana
message: "Failed password"
| eval hour = date_format(timestamp, "H")
| where hour < 6 OR hour > 20
{{end}}

> As buscas no Kibana podem ser feitas com filtros simples ou usando **Lens** e **Visualize** para dashboards.

## 🧠 Dicas práticas:

- Use **grok** para estruturar logs sem formatação (ex: logs brutos do Linux)  
- Configure **alertas** com o Kibana Alerts (Watcher) ou Elastic Security  
- Combine com **beats** (ex: Filebeat) para facilitar a coleta de logs remotos  
- Visualize falhas e sucessos de login, execuções de comando e mudanças de usuários

## ✅ Conclusão

Com o ELK Stack, é possível construir uma solução poderosa e gratuita para:

- Centralizar logs de servidores, firewalls e endpoints  
- Investigar tentativas de intrusão em tempo real  
- Criar alertas e relatórios automatizados  
- Apoiar investigações forenses com base histórica

# 🔵 Blue Team: Estudo de Logs em SIEM (Sysmon, DNS, Proxy, Endpoint)

O sucesso da análise de segurança no SIEM depende da **qualidade dos logs** que ele recebe. Para que o Blue Team consiga detectar comportamentos suspeitos e responder a incidentes de forma eficaz, é essencial compreender os principais tipos de log e o que cada um pode revelar.

Este guia cobre os logs mais importantes no contexto de um SIEM: **Sysmon, DNS, Proxy e Endpoint**.

Quem domina os logs, controla a narrativa de um incidente.

---

## 🧠 O que é log no contexto de SIEM?

Logs são registros de atividades geradas por sistemas, aplicativos, dispositivos de rede e endpoints. O SIEM coleta, indexa e correlaciona esses eventos para:

- Identificar comportamentos anômalos
- Gerar alertas de segurança
- Ajudar na resposta a incidentes
- Facilitar investigações forenses

---

## 🛠️ 1. Sysmon (System Monitor)

O Sysmon é uma ferramenta da Microsoft que registra eventos detalhados sobre o sistema operacional. Ele é instalado como um serviço e produz logs no canal de eventos do Windows.

### Eventos relevantes no SIEM:

| Event ID | Descrição                            |
|----------|--------------------------------------|
| 1        | Criação de processo                  |
| 3        | Conexão de rede                      |
| 7        | Criação de imagem carregada (DLLs)   |
| 11       | Criação de arquivo                   |
| 13       | Modificação de chave do Registro     |

### Utilização prática:

- Identificar execução de PowerShell suspeito
- Detectar movimentação lateral via processos remotos
- Mapear conexões de rede iniciadas por malware

---

## 🌐 2. Logs de DNS

Os logs de DNS mostram quais domínios foram consultados por sistemas e usuários, funcionando como uma janela para os alvos de comunicação na rede.

### Dados comuns em logs DNS:

- Nome do domínio consultado
- IP de origem (host)
- Timestamp da requisição
- Resposta do servidor

### Utilização prática:

- Detectar conexões com domínios maliciosos (C2, phishing)
- Identificar tunneling de dados via DNS
- Criar listas de bloqueio a partir de IOCs

---

## 🌍 3. Logs de Proxy

Proxies interceptam o tráfego web, e seus logs são ricos em dados de navegação. Um SIEM bem alimentado com logs de proxy é fundamental para monitorar acesso a conteúdo suspeito.

### Campos úteis:

- URL acessada
- Método HTTP (GET, POST, etc.)
- Código de resposta (200, 403, etc.)
- IP/usuário de origem
- Volume de dados trafegado

### Utilização prática:

- Detectar acesso a domínios suspeitos ou proibidos
- Identificar comportamento anômalo de navegação
- Correlacionar usuários com exfiltração de dados

---

## 💻 4. Logs de Endpoint (EDR/Antivírus)

Os endpoints são a linha de frente contra ameaças. Ferramentas de EDR (como CrowdStrike, SentinelOne, Defender for Endpoint) geram eventos sobre comportamento de processos, arquivos, usuários e rede.

### Tipos de eventos:

- Execução de binários
- Acesso/modificação de arquivos
- Detecção de malware
- Elevação de privilégios
- Persistência suspeita

### Utilização prática:

- Detectar ransomware ou execução de scripts automatizados
- Correlacionar ações maliciosas com o usuário responsável
- Monitorar atividade pós-comprometimento

---

## 🧩 Correlacionando logs no SIEM

O verdadeiro poder de um SIEM está na correlação entre fontes diferentes. Por exemplo:

- Sysmon registra a execução de `powershell.exe`
- DNS mostra conexão com domínio suspeito
- Proxy indica upload para serviço externo
- Endpoint alerta para comportamento anômalo do processo

Essa sequência pode indicar exfiltração de dados via PowerShell e DNS tunneling.

---

## ✅ Conclusão

Um bom analista de Blue Team precisa dominar a leitura e interpretação dos logs mais comuns em ambientes corporativos. Entender o **contexto** e o **valor analítico** de cada tipo de log permite criar alertas eficazes, acelerar investigações e melhorar a postura defensiva da organização.
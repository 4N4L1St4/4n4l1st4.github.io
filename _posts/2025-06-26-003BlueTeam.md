---
title: "Blue Team: Leitura e interpretação de pacotes com Wireshark"
date: 2025-06-26 16:30:00 -0300
categories: [Blue Team, Nivel 1]
tags: [Teorica]
description: "Quem domina o tráfego de rede tem o poder de entender, prever e bloquear ataques antes que causem dano."
image:
  path: /assets/img/000/capa.webp
  alt: Ilustração de um computador moderno com elementos de código e processamento
---

# 🔵 Blue Team: Leitura e Interpretação de Pacotes com Wireshark

O **Wireshark** é uma das ferramentas mais importantes para profissionais de segurança da informação, especialmente para o time Blue Team. Ele permite a análise de tráfego de rede em tempo real ou capturado em arquivos `.pcap`, ajudando na investigação de incidentes, anomalias e comportamento malicioso.


## 🐬 O que é o Wireshark?

O **Wireshark** é um analisador de pacotes gratuito e de código aberto usado para capturar e inspecionar o tráfego de rede até o nível de cada bit, seguindo o modelo OSI.


## 📦 O que é um pacote?

Um **pacote de rede** é uma unidade de dados transmitida entre dispositivos em uma rede. Ele contém informações sobre origem, destino, tipo de protocolo, dados e muito mais.


## 📥 Como capturar pacotes com Wireshark?

1. **Selecionar a interface de rede ativa** (ex: Ethernet ou Wi-Fi)<br>
2. Clicar em **"Start capturing packets"**<br>
3. Observar os pacotes sendo listados em tempo real<br>
4. Utilizar **filtros** para refinar a captura e análise<br>


## 🎯 Filtros de Captura e de Exibição

### 🔹 Filtros de captura (antes de iniciar):
- `tcp port 80` → captura somente tráfego HTTP  
- `host 192.168.1.10` → tráfego de um IP específico  

### 🔹 Filtros de exibição (durante a análise):
- `http` → exibe apenas pacotes HTTP  
- `ip.addr == 8.8.8.8` → qualquer pacote com esse IP  
- `tcp.flags.syn == 1` → pacotes SYN (início de conexão TCP)  


## 🔍 Estrutura de um pacote (exemplo TCP)

Ao clicar em um pacote, o Wireshark mostra:

1. **Camada física / Ethernet**: origem e destino MAC  
2. **IP**: endereço de origem e destino  
3. **TCP/UDP**: portas, flags (SYN, ACK, RST, etc.)  
4. **Aplicação**: conteúdo HTTP, DNS, FTP, etc.  


## 🛠️ Exemplos práticos

### ✅ Verificando handshake TCP:

Use o filtro: `tcp.flags.syn == 1 && tcp.flags.ack == 0`  
Você verá o pacote **SYN**, sinalizando o início de uma conexão.

### ✅ Inspecionando requisição HTTP:

Use o filtro: `http.request`  
Você pode visualizar o método (GET/POST), o `User-Agent` e o `Host`.

### ✅ Identificando exfiltração via DNS:

Use o filtro: `dns`  
Análise de consultas suspeitas como `abc123.attacker.com` pode indicar tunneling.


## 🛡️ Aplicações para o Blue Team

- Análise de tráfego em incidentes de segurança  
- Detecção de comunicação com C2 (Command & Control)  
- Investigação de ataques (ex: DNS tunneling, malware callbacks)  
- Análise de exfiltração de dados  
- Compreensão de ataques como scans, DoS, brute-force  


## 📂 Fontes de arquivos `.pcap` para treino

- [https://www.malware-traffic-analysis.net](https://www.malware-traffic-analysis.net)  
- [https://www.netresec.com/?page=PcapFiles](https://www.netresec.com/?page=PcapFiles)  
- [https://www.tracewrangler.com/samplepcaps](https://www.tracewrangler.com/samplepcaps)


## 📘 Dica extra

Salve sessões suspeitas como `.pcap` e crie seu repositório de ameaças para futura referência. Isso ajuda a montar uma **base de IOC comportamental**.

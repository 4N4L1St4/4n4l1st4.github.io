---
title: "Blue Team: Analista de CiberseguranÃ§a JÃºnior"
date: 2025-06-26 16:30:00 -0300
categories: [Blue Team, Nivel 1]
tags: [Teorica]
description: "Profissional em inÃ­cio de carreira, responsÃ¡vel por monitoramento bÃ¡sico, identificaÃ§Ã£o preliminar de ameaÃ§as e suporte Ã s operaÃ§Ãµes de seguranÃ§a. Atua seguindo procedimentos estabelecidos e orientaÃ§Ãµes de profissionais mais experientes, desenvolvendo habilidades tÃ©cnicas e conhecimento do ambiente de seguranÃ§a."
image:
  path: /assets/img/BlueTeamN1.png
  alt: IlustraÃ§Ã£o de um computador moderno com elementos de cÃ³digo e processamento
---

# ğŸ”µ 1. Blue Team: IntroduÃ§Ã£o Ã  SeguranÃ§a da InformaÃ§Ã£o

A atuaÃ§Ã£o de um profissional de Blue Team comeÃ§a com a compreensÃ£o dos **fundamentos da SeguranÃ§a da InformaÃ§Ã£o**. Nesta introduÃ§Ã£o, vocÃª vai entender os pilares CIA, os tipos de ameaÃ§as, os riscos associados e os principais controles de proteÃ§Ã£o utilizados para manter os ambientes seguros.

NÃ£o hÃ¡ defesa eficaz sem entender o que estamos tentando proteger.

## ğŸ” O que Ã© SeguranÃ§a da InformaÃ§Ã£o?

SeguranÃ§a da InformaÃ§Ã£o Ã© o conjunto de prÃ¡ticas, polÃ­ticas e processos voltados para proteger dados e sistemas contra acessos nÃ£o autorizados, danos, vazamentos e interrupÃ§Ãµes.


## ğŸ§± PrincÃ­pios Fundamentais â€“ Modelo **CIA**

O modelo CIA representa os **trÃªs pilares essenciais da seguranÃ§a**:

- **C â€“ Confidencialidade (Confidentiality):**  
  Garante que as informaÃ§Ãµes sejam acessadas apenas por pessoas autorizadas.  
  *Ex: Criptografia, autenticaÃ§Ã£o de dois fatores.*

- **I â€“ Integridade (Integrity):**  
  Assegura que os dados nÃ£o sejam alterados indevidamente, mantendo sua exatidÃ£o e confiabilidade.  
  *Ex: Checksums, logs de auditoria, controle de versÃµes.*

- **A â€“ Disponibilidade (Availability):**  
  Garante que os sistemas e dados estejam disponÃ­veis sempre que necessÃ¡rio.  
  *Ex: Backup, balanceamento de carga, redundÃ¢ncia.*


## âš ï¸ Tipos Comuns de AmeaÃ§as

Uma **ameaÃ§a** Ã© qualquer evento ou agente que tenha o potencial de causar dano Ã  informaÃ§Ã£o ou aos sistemas.

- **Malwares:** vÃ­rus, worms, trojans, ransomware  
- **Ataques de rede:** DDoS, sniffing, spoofing  
- **AmeaÃ§as internas:** usuÃ¡rios mal-intencionados ou negligentes  
- **Phishing e engenharia social**  
- **Vulnerabilidades exploradas (zero-day, exploits)**


## ğŸ¯ Risco em SeguranÃ§a

**Risco = AmeaÃ§a Ã— Vulnerabilidade Ã— Impacto**

O risco Ã© a **probabilidade de um incidente ocorrer**, levando em conta a existÃªncia de vulnerabilidades e o impacto que isso pode gerar.

*Exemplo:*  
Um servidor exposto Ã  internet sem patch Ã© uma vulnerabilidade. Se uma ameaÃ§a conhecida explorar essa falha, o risco Ã© elevado.


## ğŸ›¡ï¸ Controles de SeguranÃ§a

Os **controles** sÃ£o mecanismos implementados para reduzir riscos, prevenir, detectar ou responder a incidentes.

### ğŸ”’ Tipos de Controles:

- **Preventivos:** impedem que incidentes ocorram  
  *Ex: Firewall, autenticaÃ§Ã£o multifator, polÃ­ticas de senha*

- **Detectivos:** identificam que algo estÃ¡ acontecendo  
  *Ex: SIEM, IDS, logs, alertas*

- **Corretivos:** minimizam o dano apÃ³s um incidente  
  *Ex: Backup, plano de resposta a incidentes, restauraÃ§Ã£o de sistemas*

- **Deterrentes:** desestimulam aÃ§Ãµes maliciosas  
  *Ex: CÃ¢meras, avisos de monitoramento, polÃ­ticas visÃ­veis*


## ğŸ§  Por que isso Ã© importante para o Blue Team?

Um analista Blue Team deve conhecer profundamente esses fundamentos para:

- Compreender e classificar incidentes de forma adequada  
- Escolher os controles certos para cada tipo de risco  
- Monitorar eventos com foco em ameaÃ§as reais  
- Aplicar boas prÃ¡ticas com base no modelo CIA

## Perguntas sobre IntroduÃ§Ã£o Ã  SeguranÃ§a da InformaÃ§Ã£o â€“ Blue Team

---

### 1. (Aberta)  
Quais sÃ£o os trÃªs pilares do modelo CIA e qual a principal funÃ§Ã£o de cada um na seguranÃ§a da informaÃ§Ã£o?

---

### 2. (MÃºltipla escolha)  
Qual dos seguintes exemplos representa um **controle preventivo**?

- a) Sistema SIEM que gera alertas em caso de invasÃ£o  
- b) Backup periÃ³dico dos dados crÃ­ticos  
- c) Firewall que bloqueia acessos nÃ£o autorizados  
- d) Plano de resposta a incidentes  

---

### 3. (MÃºltipla escolha)  
O que melhor representa a fÃ³rmula para calcular o risco em seguranÃ§a da informaÃ§Ã£o?

- a) Risco = AmeaÃ§a + Vulnerabilidade + Impacto  
- b) Risco = AmeaÃ§a Ã— Vulnerabilidade Ã— Impacto  
- c) Risco = AmeaÃ§a Ã· Vulnerabilidade Ã— Impacto  
- d) Risco = AmeaÃ§a â€“ Vulnerabilidade + Impacto  


# ğŸ”µ 2. O que Ã© Blue Team?

O **Blue Team** Ã© o grupo responsÃ¡vel pela **defesa cibernÃ©tica** de uma organizaÃ§Ã£o. Sua missÃ£o Ã© proteger sistemas, redes, aplicaÃ§Ãµes e dados contra ameaÃ§as internas e externas, detectando, respondendo e mitigando ataques em tempo real.


## ğŸ¯ Objetivo

Garantir a **resiliÃªncia e seguranÃ§a contÃ­nua** do ambiente de TI, monitorando atividades, detectando anomalias e **respondendo rapidamente a incidentes de seguranÃ§a**.

Enquanto o Red Team pensa como o inimigo, o Blue Team protege como um guardiÃ£o incansÃ¡vel.

## ğŸ›¡ï¸ Atividades Comuns

- Monitoramento contÃ­nuo de redes e sistemas  
- AnÃ¡lise e correlaÃ§Ã£o de logs (com SIEMs)  
- DetecÃ§Ã£o e resposta a incidentes (SOC, CSIRT)  
- Threat Hunting (busca ativa por ameaÃ§as)  
- AplicaÃ§Ã£o de patches e hardening de sistemas  
- GestÃ£o de vulnerabilidades  
- AnÃ¡lise de malwares e forense digital  
- ImplementaÃ§Ã£o de polÃ­ticas e controles de seguranÃ§a  


## ğŸ”„ Ciclo de Trabalho

1. **Monitorar** (com ferramentas como SIEM e EDR)  
2. **Detectar** comportamentos anÃ´malos  
3. **Responder** a incidentes rapidamente  
4. **Recuperar** sistemas afetados  
5. **Aprimorar** defesas com base no aprendizado


## ğŸ§  Perfis do Time

- Analista SOC (nÃ­veis 1, 2 e 3)  
- Analista de Resposta a Incidentes (CSIRT)  
- Threat Hunter  
- Especialista em Forense  
- Blue Team Engineer / Security Analyst  
- Profissionais com certificaÃ§Ãµes como:  
  - CompTIA Security+  
  - GCIA, GCIH (SANS)  
  - CEH (Certified Ethical Hacker)  
  - Blue Team Level 1/2 (BTL1, BTL2)


## ğŸ› ï¸ Ferramentas Usadas

- **SIEMs**: Splunk, ELK, QRadar, Microsoft Sentinel  
- **EDR/XDR**: CrowdStrike, SentinelOne, Microsoft Defender  
- **SOAR**: Cortex XSOAR, IBM Resilient  
- **Forense**: Autopsy, Volatility, FTK  
- **AnÃ¡lise de TrÃ¡fego**: Wireshark, Zeek, Suricata  
- **GestÃ£o de vulnerabilidades**: Nessus, Qualys, OpenVAS


## ğŸ¤ RelaÃ§Ã£o com Outros Times

- **Red Team (ğŸ”´):** Testa as defesas da equipe azul com ataques simulados  
- **Purple Team (ğŸŸ£):** Integra Red + Blue para melhorar continuamente ambos  
- **White Team (âšª):** Supervisiona e define as regras dos exercÃ­cios  


## ğŸ“š Frameworks e ReferÃªncias

- **MITRE ATT&CK for Defense**  
- NIST 800-61 (Guia de Resposta a Incidentes)  
- CIS Controls v8  
- NIST CSF (Cybersecurity Framework)


## âœ… BenefÃ­cios para a OrganizaÃ§Ã£o

- ReduÃ§Ã£o de tempo de resposta a incidentes  
- Menor risco de vazamentos e perdas de dados  
- DetecÃ§Ã£o precoce de ameaÃ§as  
- ResiliÃªncia operacional frente a ataques  
- Melhoria contÃ­nua da postura de seguranÃ§a



# ğŸ”µ 3. Blue Team: Leitura e InterpretaÃ§Ã£o de Pacotes com Wireshark

O **Wireshark** Ã© uma das ferramentas mais importantes para profissionais de seguranÃ§a da informaÃ§Ã£o, especialmente para o time Blue Team. Ele permite a anÃ¡lise de trÃ¡fego de rede em tempo real ou capturado em arquivos `.pcap`, ajudando na investigaÃ§Ã£o de incidentes, anomalias e comportamento malicioso.

Quem domina o trÃ¡fego de rede tem o poder de entender, prever e bloquear ataques antes que causem dano.

## ğŸ¬ O que Ã© o Wireshark?

O **Wireshark** Ã© um analisador de pacotes gratuito e de cÃ³digo aberto usado para capturar e inspecionar o trÃ¡fego de rede atÃ© o nÃ­vel de cada bit, seguindo o modelo OSI.


## ğŸ“¦ O que Ã© um pacote?

Um **pacote de rede** Ã© uma unidade de dados transmitida entre dispositivos em uma rede. Ele contÃ©m informaÃ§Ãµes sobre origem, destino, tipo de protocolo, dados e muito mais.


## ğŸ“¥ Como capturar pacotes com Wireshark?

1. **Selecionar a interface de rede ativa** (ex: Ethernet ou Wi-Fi)<br>
2. Clicar em **"Start capturing packets"**<br>
3. Observar os pacotes sendo listados em tempo real<br>
4. Utilizar **filtros** para refinar a captura e anÃ¡lise<br>


## ğŸ¯ Filtros de Captura e de ExibiÃ§Ã£o

### ğŸ”¹ Filtros de captura (antes de iniciar):
- `tcp port 80` â†’ captura somente trÃ¡fego HTTP  
- `host 192.168.1.10` â†’ trÃ¡fego de um IP especÃ­fico  

### ğŸ”¹ Filtros de exibiÃ§Ã£o (durante a anÃ¡lise):
- `http` â†’ exibe apenas pacotes HTTP  
- `ip.addr == 8.8.8.8` â†’ qualquer pacote com esse IP  
- `tcp.flags.syn == 1` â†’ pacotes SYN (inÃ­cio de conexÃ£o TCP)  


## ğŸ” Estrutura de um pacote (exemplo TCP)

Ao clicar em um pacote, o Wireshark mostra:

1. **Camada fÃ­sica / Ethernet**: origem e destino MAC  
2. **IP**: endereÃ§o de origem e destino  
3. **TCP/UDP**: portas, flags (SYN, ACK, RST, etc.)  
4. **AplicaÃ§Ã£o**: conteÃºdo HTTP, DNS, FTP, etc.  


## ğŸ› ï¸ Exemplos prÃ¡ticos

### âœ… Verificando handshake TCP:

Use o filtro: `tcp.flags.syn == 1 && tcp.flags.ack == 0`  
VocÃª verÃ¡ o pacote **SYN**, sinalizando o inÃ­cio de uma conexÃ£o.

### âœ… Inspecionando requisiÃ§Ã£o HTTP:

Use o filtro: `http.request`  
VocÃª pode visualizar o mÃ©todo (GET/POST), o `User-Agent` e o `Host`.

### âœ… Identificando exfiltraÃ§Ã£o via DNS:

Use o filtro: `dns`  
AnÃ¡lise de consultas suspeitas como `abc123.attacker.com` pode indicar tunneling.


## ğŸ›¡ï¸ AplicaÃ§Ãµes para o Blue Team

- AnÃ¡lise de trÃ¡fego em incidentes de seguranÃ§a  
- DetecÃ§Ã£o de comunicaÃ§Ã£o com C2 (Command & Control)  
- InvestigaÃ§Ã£o de ataques (ex: DNS tunneling, malware callbacks)  
- AnÃ¡lise de exfiltraÃ§Ã£o de dados  
- CompreensÃ£o de ataques como scans, DoS, brute-force  


## ğŸ“‚ Fontes de arquivos `.pcap` para treino

- [https://www.malware-traffic-analysis.net](https://www.malware-traffic-analysis.net)  
- [https://www.netresec.com/?page=PcapFiles](https://www.netresec.com/?page=PcapFiles)  
- [https://www.tracewrangler.com/samplepcaps](https://www.tracewrangler.com/samplepcaps)


## ğŸ“˜ Dica extra

Salve sessÃµes suspeitas como `.pcap` e crie seu repositÃ³rio de ameaÃ§as para futura referÃªncia. Isso ajuda a montar uma **base de IOC comportamental**.

# ğŸ”µ 4. Blue Team: Logs do Windows e Linux â€“ Onde EstÃ£o e Como Ler

Um dos principais pilares da atuaÃ§Ã£o do Blue Team Ã© a **anÃ¡lise de logs**. Eles sÃ£o a base para detecÃ§Ã£o de ameaÃ§as, resposta a incidentes e investigaÃ§Ã£o forense. Saber **onde os logs ficam armazenados** e **como interpretÃ¡-los** Ã© essencial para qualquer analista de seguranÃ§a.

Logs sÃ£o como a caixa preta de um sistema: quem sabe lÃª-los, entende tudo o que aconteceu â€“ e o que estÃ¡ prestes a acontecer.

## ğŸªŸ Logs no Windows

O Windows registra diversos eventos importantes em seus **logs de eventos (Event Logs)**. Esses logs podem ser visualizados usando o **Event Viewer** (`eventvwr.msc`) ou exportados para anÃ¡lise posterior.

### ğŸ—‚ï¸ Principais categorias de logs:

| Log                   | Caminho no Event Viewer                         | O que contÃ©m                                |
|-----------------------|--------------------------------------------------|----------------------------------------------|
| **Application**       | Event Viewer â†’ Windows Logs â†’ Application       | Erros de aplicativos, falhas de sistema      |
| **System**            | Event Viewer â†’ Windows Logs â†’ System            | Driver, kernel, falhas de hardware           |
| **Security**          | Event Viewer â†’ Windows Logs â†’ Security          | Eventos de login, tentativas de acesso       |
| **Setup**             | Event Viewer â†’ Windows Logs â†’ Setup             | InstalaÃ§Ãµes, atualizaÃ§Ãµes                     |
| **Forwarded Events**  | Event Viewer â†’ Applications and Services Logs   | Logs de eventos recebidos via forwarding     |


### ğŸ” Eventos de seguranÃ§a importantes:

| Evento ID | DescriÃ§Ã£o                                     |
|-----------|-----------------------------------------------|
| 4624      | Logon bem-sucedido                            |
| 4625      | Tentativa de logon falha                      |
| 4688      | CriaÃ§Ã£o de processo                           |
| 4697      | InstalaÃ§Ã£o de novo serviÃ§o                    |
| 4719      | PolÃ­tica de auditoria alterada                |
| 4720â€“4732 | CriaÃ§Ã£o/modificaÃ§Ã£o de contas e grupos        |


### ğŸ“ Local fÃ­sico dos logs:

- Caminho: `C:\Windows\System32\winevt\Logs\`  
- ExtensÃ£o: `.evtx`  
- Leitura com: Event Viewer, PowerShell, ou ferramentas como **Log Parser**, **EventLog Explorer**


## ğŸ§ Logs no Linux

No Linux, os logs geralmente sÃ£o armazenados em arquivos de texto localizados em `/var/log`. O sistema de logging pode variar (ex: `rsyslog`, `journald`, `syslog-ng`), mas a estrutura geral se mantÃ©m.

### ğŸ—‚ï¸ Principais arquivos de log:

| Caminho                  | DescriÃ§Ã£o                                      |
|--------------------------|------------------------------------------------|
| `/var/log/syslog`        | Log geral do sistema (Debian/Ubuntu)           |
| `/var/log/messages`      | Log geral do sistema (RHEL/CentOS)             |
| `/var/log/auth.log`      | Log de autenticaÃ§Ã£o e sudo (Debian/Ubuntu)     |
| `/var/log/secure`        | Log de autenticaÃ§Ã£o (RHEL/CentOS)              |
| `/var/log/boot.log`      | Mensagens de inicializaÃ§Ã£o do sistema          |
| `/var/log/kern.log`      | Logs do kernel                                 |
| `/var/log/faillog`       | Tentativas de login invÃ¡lidas                  |
| `/var/log/wtmp` / `last` | HistÃ³rico de logins                            |


### ğŸ” Como visualizar logs:

- `cat /var/log/auth.log` â€“ imprime o conteÃºdo  
- `tail -f /var/log/syslog` â€“ monitora em tempo real  
- `grep "sshd" /var/log/auth.log` â€“ filtra por palavra-chave  
- `journalctl` â€“ visualiza logs do `systemd` (em distribuiÃ§Ãµes modernas)


## ğŸ›¡ï¸ Por que isso importa para o Blue Team?

- Monitorar **logons suspeitos**, escaladas de privilÃ©gio e uso do sudo  
- Detectar **criaÃ§Ãµes de usuÃ¡rios, serviÃ§os ou processos anÃ´malos**  
- Verificar **tentativas de brute-force**, malware persistente e atividades fora do horÃ¡rio normal  
- Correlacionar logs entre Windows e Linux para detectar **movimentaÃ§Ã£o lateral**  


## ğŸ§° Ferramentas Ãºteis para anÃ¡lise de logs

- **Windows:** Event Viewer, PowerShell, EventLog Explorer, Log Parser  
- **Linux:** journalctl, grep, ausearch, Logwatch  
- **SIEMs:** Splunk, ELK, Wazuh, Sentinel (para ingestÃ£o e anÃ¡lise centralizada)


## ğŸ§  Dica prÃ¡tica

Crie um **checklist de eventos crÃ­ticos** para monitorar em cada sistema e aplique filtros regulares para identificar padrÃµes. Isso economiza tempo e aumenta a eficÃ¡cia na detecÃ§Ã£o.

# ğŸ”µ 5. Blue Team: SeguranÃ§a em AutenticaÃ§Ã£o â€“ MFA, Hashes, Senhas e Tokens

A **autenticaÃ§Ã£o segura** Ã© uma das primeiras linhas de defesa contra acessos nÃ£o autorizados. O Blue Team precisa entender profundamente os mecanismos modernos de autenticaÃ§Ã£o para proteger usuÃ¡rios, sistemas e redes.

Senhas sÃ£o como escovas de dentes: pessoais, devem ser trocadas regularmente e nunca compartilhadas.

## ğŸ” O que Ã© AutenticaÃ§Ã£o?

**AutenticaÃ§Ã£o** Ã© o processo de verificar se um usuÃ¡rio ou sistema Ã© realmente quem diz ser.  
Ela geralmente envolve um ou mais dos seguintes fatores:

- **Algo que vocÃª sabe** â†’ senha, PIN  
- **Algo que vocÃª tem** â†’ token, celular  
- **Algo que vocÃª Ã©** â†’ biometria  


## ğŸ”¢ MFA â€“ AutenticaÃ§Ã£o Multifator

O **MFA (Multi-Factor Authentication)** adiciona camadas de seguranÃ§a exigindo mais de um fator de autenticaÃ§Ã£o.

### âœ… Exemplos de MFA:
- Senha + cÃ³digo via SMS  
- Senha + token no aplicativo (Google Authenticator, Microsoft Authenticator)  
- PIN + impressÃ£o digital  

### ğŸ¯ Vantagens do MFA:
- Dificulta o uso de credenciais vazadas  
- Reduz risco de ataques por forÃ§a bruta  
- Mitiga sequestro de sessÃ£o e phishing simples  

### âš ï¸ AtenÃ§Ã£o:
- SMS como 2FA Ã© melhor do que nada, mas ainda **vulnerÃ¡vel a SIM Swap**  
- Sempre prefira aplicativos de MFA ou chaves FIDO2/YubiKey


## ğŸ”‘ Hashes de Senhas

As senhas **nunca devem ser armazenadas em texto claro**. Elas devem ser convertidas em **hashes**, uma representaÃ§Ã£o criptogrÃ¡fica que nÃ£o pode ser revertida diretamente.

### ğŸ” O que Ã© um hash?
Um hash Ã© o resultado de aplicar uma funÃ§Ã£o matemÃ¡tica a uma entrada (senha), gerando uma saÃ­da de tamanho fixo.

### ğŸ”¹ Exemplos de funÃ§Ãµes de hash:
- **MD5** â€“ desatualizado e inseguro  
- **SHA-1** â€“ tambÃ©m inseguro  
- **SHA-256** â€“ mais forte, mas puro ainda nÃ£o ideal para senhas  
- **bcrypt, scrypt, Argon2** â€“ recomendadas para proteger senhas

### âš ï¸ Boa prÃ¡tica:
Sempre aplicar **salting** (adicionar dados Ãºnicos Ã  senha antes de gerar o hash) para evitar ataques com rainbow tables.


## ğŸ” Senhas: Boas PrÃ¡ticas

- Tamanho mÃ­nimo recomendado: **12 caracteres**  
- Evite usar informaÃ§Ãµes pessoais (nome, data, time)  
- Use **gerenciadores de senhas** (Bitwarden, 1Password, KeePass)  
- Nunca reutilize senhas entre sistemas  
- Habilite MFA sempre que possÃ­vel  


## ğŸ« Tokens de Acesso

Tokens sÃ£o **credenciais temporÃ¡rias e controladas**, usadas para autenticaÃ§Ã£o e autorizaÃ§Ã£o.

### ğŸ”¹ Tipos comuns:

| Tipo         | Uso                                 |
|--------------|--------------------------------------|
| **TOTP**     | Token baseado em tempo (Google Auth) |
| **JWT**      | JSON Web Token, comum em APIs        |
| **OAuth2**   | AutorizaÃ§Ã£o delegada (Google Login)  |
| **FIDO2/WebAuthn** | AutenticaÃ§Ã£o por chave fÃ­sica ou biometria |

### ğŸ” JWT (JSON Web Token):
- ContÃ©m: header, payload, signature  
- Usado para autenticaÃ§Ã£o em aplicaÃ§Ãµes web  
- Deve ser assinado e, idealmente, criptografado  

### âš ï¸ Riscos:
- Tokens expostos em URL, console ou header podem ser interceptados  
- Falta de expiraÃ§Ã£o ou revogaÃ§Ã£o Ã© um problema comum  


## ğŸ›¡ï¸ RelevÃ¢ncia para o Blue Team

- Monitorar **falhas de login repetidas** (brute-force)  
- Detectar **acessos sem MFA** ou **tokens reutilizados**  
- Validar seguranÃ§a do armazenamento de senhas  
- Criar **alertas de login suspeito (localizaÃ§Ã£o, horÃ¡rio, device)**  
- Auxiliar na **educaÃ§Ã£o de usuÃ¡rios** e adoÃ§Ã£o de boas prÃ¡ticas  


## ğŸ§° Ferramentas Ãºteis

- **Have I Been Pwned** â€“ verificaÃ§Ã£o de vazamentos de senha  
- **Authy / Google Authenticator** â€“ MFA apps  
- **YubiKey / SoloKey** â€“ autenticaÃ§Ã£o com chave fÃ­sica  
- **Hashcat / John the Ripper** â€“ auditoria de hashes (uso Ã©tico)  
- **Vault / AWS Secrets Manager** â€“ gerenciamento de segredos corporativos

# ğŸ”µ 6. Blue Team: Tipos de Ataques Comuns â€“ Phishing, Malware, Brute-Force e MITM

Todo profissional de Blue Team precisa conhecer os principais **tipos de ataques** utilizados por ameaÃ§as cibernÃ©ticas. Reconhecer seus padrÃµes e comportamentos Ã© essencial para **prevenir, detectar e responder** de forma eficaz.

VocÃª sÃ³ pode se defender daquilo que Ã© capaz de reconhecer.

## ğŸ£ Phishing â€“ Engenharia Social DisfarÃ§ada

O **phishing** Ã© um dos ataques mais comuns e eficazes. Consiste em **enganar o usuÃ¡rio** para que ele entregue informaÃ§Ãµes confidenciais, como senhas ou dados bancÃ¡rios.

### ğŸ“Œ CaracterÃ­sticas:
- E-mails ou mensagens falsas com aparÃªncia legÃ­tima  
- Links que levam a sites clonados (ex: "banc0.com" em vez de "banco.com")  
- Anexos maliciosos (PDFs, Excel com macros, etc.)

### ğŸ” Como detectar:
- Erros de ortografia e domÃ­nio estranho  
- SolicitaÃ§Ãµes urgentes ou ameaÃ§adoras  
- Arquivos suspeitos anexados

### ğŸ›¡ï¸ Defesa Blue Team:
- Filtros de e-mail (SPF, DKIM, DMARC)  
- Treinamento de usuÃ¡rios  
- Sandboxing de anexos  
- Monitoramento de cliques e redirecionamentos


## ğŸ¦  Malware â€“ Software Malicioso

O **malware** Ã© qualquer programa criado com a intenÃ§Ã£o de causar dano ou obter acesso nÃ£o autorizado a sistemas.

### ğŸ§© Tipos comuns:
- **Ransomware:** criptografa arquivos e exige resgate  
- **Spyware:** coleta informaÃ§Ãµes sem consentimento  
- **Trojans:** disfarÃ§ado como software legÃ­timo  
- **Worms:** se replicam pela rede  
- **Rootkits:** ocultam presenÃ§a de atacantes  

### ğŸ›¡ï¸ Defesa Blue Team:
- EDR com detecÃ§Ã£o comportamental  
- Lista de bloqueio (blacklist) de hashes e domÃ­nios  
- AnÃ¡lise de IOC (hashes, conexÃµes, artefatos)  
- Monitoramento de criaÃ§Ã£o de processos e serviÃ§os (Windows ID 4688)


## ğŸ” Brute-Force â€“ Adivinhando Senhas

Ataques de forÃ§a bruta consistem em **tentar vÃ¡rias combinaÃ§Ãµes de senha** atÃ© acertar a correta. Variantes incluem:

- **Ataque direto:** tenta muitas senhas em um mesmo login  
- **Ataque de dicionÃ¡rio:** usa listas comuns de senhas  
- **Credential stuffing:** tenta combinaÃ§Ãµes vazadas de outros serviÃ§os  

### ğŸ” IndÃ­cios em logs:
- MÃºltiplas tentativas de login falhadas (Windows Event 4625)  
- VÃ¡rios IPs tentando logar em um mesmo usuÃ¡rio  
- Tentativas fora do horÃ¡rio habitual  

### ğŸ›¡ï¸ Defesa Blue Team:
- MFA obrigatÃ³rio  
- LimitaÃ§Ã£o de tentativas (lockout temporÃ¡rio)  
- Monitoramento e alerta de comportamento anÃ´malo  
- Regras de detecÃ§Ã£o em SIEM (por IP, por usuÃ¡rio, por hora)


## ğŸ•µï¸ MITM â€“ Man-in-the-Middle

No **MITM (homem-no-meio)**, o atacante intercepta a comunicaÃ§Ã£o entre duas partes para roubar dados, redirecionar trÃ¡fego ou modificar conteÃºdo.

### ğŸ¯ Exemplos:
- Captura de trÃ¡fego em redes Wi-Fi pÃºblicas  
- DNS spoofing (redireciona sites legÃ­timos para falsos)  
- SSL stripping (remove criptografia HTTPS)

### ğŸ›¡ï¸ Defesa Blue Team:
- EncriptaÃ§Ã£o forte de ponta a ponta (HTTPS, TLS)  
- DNSSEC e HSTS nos serviÃ§os da empresa  
- Certificados digitais vÃ¡lidos e monitorados  
- Monitoramento de certificados suspeitos e certificados wildcard fora do padrÃ£o


## ğŸ”„ ConclusÃ£o

Compreender esses ataques Ã© o primeiro passo para montar **controles, alertas e respostas eficientes**. O Blue Team atua de forma proativa e reativa para conter e impedir esses vetores de ataque.


## ğŸ§  Dica prÃ¡tica:

Crie uma **matriz de ameaÃ§as** no seu ambiente listando:

- Vetores mais comuns (e-mail, web, rede, endpoint)  
- Tipos de ataques associados  
- Controles jÃ¡ existentes e lacunas  
- IOCs e exemplos reais para treinar detecÃ§Ã£o



# ğŸ”µ 7. Blue Team: Ciclo de Resposta a Incidentes â€“ NIST 800-61

A Resposta a Incidentes Ã© um dos pilares do trabalho de um Blue Team. O guia **NIST SP 800-61 Revision 2**, publicado pelo *National Institute of Standards and Technology (NIST)*, fornece uma estrutura robusta e amplamente utilizada para gerenciar e responder a incidentes de seguranÃ§a da informaÃ§Ã£o.

Esse ciclo ajuda equipes de SOC, CSIRT e Blue Team a se prepararem, identificarem e lidarem com ameaÃ§as de forma sistemÃ¡tica.

Responder a incidentes sem preparo Ã© como apagar incÃªndios com os olhos vendados.

---

## ğŸ§­ As 4 Fases da Resposta a Incidentes (segundo o NIST 800-61)

---

## 1. ğŸ§° PreparaÃ§Ã£o (Preparation)

Nesta fase, a organizaÃ§Ã£o toma medidas **antes de qualquer incidente ocorrer** para garantir uma resposta eficiente.

### AÃ§Ãµes comuns:
- CriaÃ§Ã£o de um plano de resposta a incidentes (PRI)
- DefiniÃ§Ã£o de equipe responsÃ¡vel (SOC, CSIRT)
- Treinamentos e simulaÃ§Ãµes (tabletops, red team)
- InventÃ¡rio de ativos crÃ­ticos
- ImplementaÃ§Ã£o de ferramentas (SIEM, EDR, firewall)
- DefiniÃ§Ã£o de canais de comunicaÃ§Ã£o

> **Objetivo:** estar pronto para reagir com rapidez e eficiÃªncia.

---

## 2. ğŸ” DetecÃ§Ã£o e AnÃ¡lise (Detection and Analysis)

Esta fase inicia quando **um evento suspeito Ã© detectado**. Nem todo evento Ã© um incidente, por isso Ã© necessÃ¡rio fazer triagem e anÃ¡lise.

### Fontes de detecÃ§Ã£o:
- Alertas do SIEM
- Logs de sistema (Windows, Linux, AD)
- Ferramentas de monitoramento (IDS, EDR, AV)
- Relatos de usuÃ¡rios
- Threat intelligence (feeds de IOC)

### AÃ§Ãµes:
- Validar se o evento Ã© um incidente
- Classificar o tipo (malware, acesso indevido, negaÃ§Ã£o de serviÃ§o, etc.)
- Medir impacto e escopo
- Priorizar e documentar

> **Objetivo:** confirmar o incidente e entender sua gravidade.

---

## 3. ğŸ›¡ï¸ ContenÃ§Ã£o, ErradicaÃ§Ã£o e RecuperaÃ§Ã£o (Containment, Eradication, and Recovery)

ApÃ³s a confirmaÃ§Ã£o, o time deve **conter os danos**, **remover o agente da ameaÃ§a** e **restaurar os sistemas afetados**.

### ContenÃ§Ã£o:
- Isolar a mÃ¡quina comprometida
- Desativar contas suspeitas
- Bloquear IPs/domÃ­nios maliciosos

### ErradicaÃ§Ã£o:
- Remover malware
- Corrigir vulnerabilidades exploradas
- Aplicar patches de seguranÃ§a

### RecuperaÃ§Ã£o:
- Restaurar sistemas a partir de backups
- Verificar a integridade de arquivos
- Monitorar o ambiente apÃ³s o incidente

> **Objetivo:** minimizar o impacto, remover a ameaÃ§a e restaurar a normalidade.

---

## 4. ğŸ“˜ PÃ³s-Incidente (Post-Incident Activity)

ApÃ³s o incidente, Ã© fundamental **aprender com o ocorrido** para evitar recorrÃªncias.

### AÃ§Ãµes:
- Conduzir liÃ§Ãµes aprendidas (post-mortem)
- Atualizar procedimentos e polÃ­ticas
- Melhorar ferramentas e regras do SIEM
- Treinar equipes com base no caso
- Reportar Ã s partes interessadas

> **Objetivo:** fortalecer a maturidade da seguranÃ§a e prevenir reincidÃªncia.

---

## ğŸ“Œ ImportÃ¢ncia para o Blue Team

A adoÃ§Ã£o do NIST 800-61 permite que o Blue Team:

- Tenha processos claros e padronizados
- Responda rapidamente com aÃ§Ãµes coordenadas
- Melhore continuamente sua defesa
- Ganhe respaldo em auditorias e conformidade (ex: LGPD, ISO 27001)

---

## ğŸ§  Dica prÃ¡tica:

Monte **playbooks de resposta a incidentes** com base nesse ciclo, contendo:

- Tipo de incidente
- AÃ§Ãµes passo a passo
- Ponto de contato (POC)
- EvidÃªncias a serem coletadas
- Ferramentas a utilizar

# ğŸ”µ 8. Blue Team: IOC â€“ O que sÃ£o e como detectar

Um dos pilares da anÃ¡lise de ameaÃ§as e resposta a incidentes no Blue Team Ã© o uso de **IOCs â€“ Indicators of Compromise**. Eles ajudam a **identificar sinais de que uma mÃ¡quina, rede ou conta pode ter sido comprometida**.

Dominar o conceito de IOC e como usÃ¡-los em ferramentas como SIEM, EDR ou antivÃ­rus Ã© essencial para detectar ataques em seus estÃ¡gios iniciais.

Cada IOC Ã© como uma pegada na cena do crime â€“ siga as pegadas e vocÃª encontrarÃ¡ o invasor.

---

## ğŸ“Œ O que sÃ£o IOCs?

**IOC (Indicator of Compromise)** Ã© qualquer evidÃªncia digital que indica que **uma ameaÃ§a pode ter atuado ou estar atuando** em um sistema ou rede.

Eles sÃ£o usados para **detecÃ§Ã£o**, **correlaÃ§Ã£o** e **resposta a incidentes**, servindo como uma trilha de pistas deixada por atacantes.

---

## ğŸ“‚ Tipos comuns de IOCs

| Tipo               | Exemplo                                         |
|--------------------|-------------------------------------------------|
| Hashes de arquivos | `MD5`, `SHA256` de malware ou arquivos alterados |
| EndereÃ§os IP       | IPs maliciosos usados em ataques ou C2          |
| DomÃ­nios/URLs      | DomÃ­nios usados para phishing ou C2             |
| Nomes de arquivos  | `invoice.exe`, `payload.docm`                   |
| Strings de logs    | "powershell -enc", "cmd /c net user hacker"     |
| Chaves de Registro | PersistÃªncia maliciosa no Windows               |
| Processos suspeitos| ExecuÃ§Ãµes fora do padrÃ£o (`regsvr32`, `certutil`)|
| Artefatos de memÃ³ria | DLLs injetadas, beaconing, mutexes            |

---

## ğŸ§  Como os IOCs sÃ£o usados?

1. **DetecÃ§Ã£o preventiva:** o SIEM ou EDR alerta quando um IOC conhecido aparece no ambiente  
2. **Hunting (caÃ§a a ameaÃ§as):** busca ativa por IOCs em logs histÃ³ricos  
3. **CorrelaÃ§Ãµes:** IOCs relacionados a comportamentos anÃ´malos ajudam a confirmar ataques  
4. **RestriÃ§Ãµes automÃ¡ticas:** bloqueio de IPs/domÃ­nios via firewall ou DNS  
5. **Resposta rÃ¡pida:** uso de listas para isolar ativos, usuÃ¡rios ou sessÃµes

---

## ğŸ” Como detectar IOCs em ferramentas de seguranÃ§a

### 1. SIEM (ex: Splunk, ELK, QRadar)

```splunk
index=windows process_name="certutil.exe"
```

```splunk
index=dns query="malicious-domain.com"
```

### 2. EDR (ex: CrowdStrike, SentinelOne)

- Detecta e alerta em tempo real o uso de comandos suspeitos ou arquivos com hash malicioso  
- Permite hunting por IOC e isolamento de endpoints

### 3. Threat Intelligence Feeds

VocÃª pode integrar listas externas (feeds) com o SIEM para correlacionar eventos automaticamente:

- AlienVault OTX  
- MISP  
- Abuse.ch  
- Open Threat Exchange  
- Feeds privados ou comerciais

---

## ğŸ§ª Exemplo prÃ¡tico de hunting com IOC

**IOC:** IP malicioso `185.100.87.84`

**Busca no SIEM:**

```splunk
index=firewall src_ip="185.100.87.84"
```

**IOC:** Hash SHA256 de malware

```splunk
index=edr file_hash="a7c5f7df123456..."
```

**IOC:** ExecuÃ§Ã£o de PowerShell com base64

```splunk
index=sysmon process_name="powershell.exe" CommandLine="*base64*"
```

---

## âš ï¸ LimitaÃ§Ãµes dos IOCs

- **SÃ£o estÃ¡ticos**: atacantes podem mudar facilmente domÃ­nios e IPs  
- **FÃ¡ceis de evadir**: pequenas alteraÃ§Ãµes em malware geram hashes diferentes  
- **Melhor usados com contexto**: IOCs sozinhos nem sempre provam uma invasÃ£o

> Por isso, use IOCs junto com **anÃ¡lise comportamental (UEBA)** e **detecÃ§Ã£o por heurÃ­stica**.

---

## âœ… ConclusÃ£o

IOCs sÃ£o ferramentas valiosas de detecÃ§Ã£o e resposta, mas devem ser **tratados como pistas, nÃ£o como provas absolutas**. Um analista de Blue Team eficaz usa IOCs como parte de um arsenal maior que inclui:

- Telemetria de endpoint  
- Logs de rede e autenticaÃ§Ã£o  
- Threat hunting manual  
- CorrelaÃ§Ã£o com outros indicadores

# ğŸ”µ 9. Blue Team: MITRE ATT&CK Framework â€“ TÃ©cnicas e TÃ¡ticas

O **MITRE ATT&CK** Ã© um framework amplamente adotado no mundo da seguranÃ§a da informaÃ§Ã£o. Ele documenta **tÃ¡ticas, tÃ©cnicas e procedimentos (TTPs)** usados por atacantes reais em fases de um ataque.

Para o Blue Team, o ATT&CK serve como um **mapa de comportamento adversÃ¡rio** que pode ser usado para detecÃ§Ã£o, correlaÃ§Ã£o, hunting e melhoria contÃ­nua das defesas.

Quem conhece o inimigo, nÃ£o serÃ¡ surpreendido. Quem conhece seu prÃ³prio ambiente, jÃ¡ venceu metade da batalha.

---

## ğŸ§© O que Ã© o MITRE ATT&CK?

- Criado pela MITRE Corporation  
- Baseado em observaÃ§Ãµes do mundo real  
- Organizado por **tÃ¡ticas** (objetivos do atacante) e **tÃ©cnicas** (como o atacante alcanÃ§a esses objetivos)  
- DisponÃ­vel para sistemas corporativos, nuvem, mobile e ICS

---

## ğŸ§­ Estrutura do framework

O ATT&CK Ã© dividido em:

### ğŸ“Œ TÃ¡ticas  
SÃ£o **as metas do atacante em cada fase do ataque**, como:

| TÃ¡tica                    | DescriÃ§Ã£o                                |
|---------------------------|--------------------------------------------|
| Initial Access            | Como o atacante entra no sistema           |
| Execution                 | Como ele executa cÃ³digo malicioso          |
| Persistence               | Como mantÃ©m o acesso                       |
| Privilege Escalation      | Como eleva privilÃ©gios                     |
| Defense Evasion           | Como evita ser detectado                   |
| Credential Access         | Roubo de credenciais                       |
| Discovery                 | Coleta de informaÃ§Ãµes sobre o ambiente     |
| Lateral Movement          | MovimentaÃ§Ã£o lateral na rede               |
| Collection                | Coleta de dados                            |
| Exfiltration              | ExtraÃ§Ã£o de dados                          |
| Command and Control (C2)  | ComunicaÃ§Ã£o com servidores do atacante     |

Cada tÃ¡tica contÃ©m **vÃ¡rias tÃ©cnicas** e atÃ© **subtÃ©cnicas**.

---

## ğŸ› ï¸ Exemplo prÃ¡tico de tÃ¡tica + tÃ©cnica

### ğŸ¯ TÃ¡tica: Execution  
**Objetivo:** executar cÃ³digo malicioso apÃ³s acesso.

### TÃ©cnica: T1059 â€“ Command and Scripting Interpreter  
Exemplos: `powershell`, `bash`, `cmd`, `python`, `wscript`

```splunk
index=sysmon EventCode=1 CommandLine="powershell*"
```

---

## ğŸ“Š Como o Blue Team usa o ATT&CK?

- **Mapeamento de detecÃ§Ãµes:** quais tÃ©cnicas seu SIEM jÃ¡ cobre?  
- **Gap analysis:** identificar o que **nÃ£o** estÃ¡ sendo monitorado  
- **Hunting guiado:** buscar por comportamentos adversÃ¡rios com base nas tÃ©cnicas  
- **Resposta a incidentes:** entender as fases e possÃ­veis movimentos do atacante  
- **SimulaÃ§Ãµes:** simular tÃ©cnicas para testar defesas (ex: red team)

---

## ğŸ” Ferramentas de apoio

- [attack.mitre.org](https://attack.mitre.org) â€“ consulta oficial  
- MITRE Navigator â€“ mapa visual das detecÃ§Ãµes e coberturas  
- Sigma Rules â€“ regras SIEM alinhadas ao ATT&CK  
- Atomic Red Team â€“ simulaÃ§Ã£o de tÃ©cnicas especÃ­ficas  
- Caldera (MITRE) â€“ automaÃ§Ã£o de adversarial em laboratÃ³rio

---

## ğŸ“˜ Exemplo de uso em uma investigaÃ§Ã£o

Suponha que vocÃª detecte a execuÃ§Ã£o de `mshta.exe` com uma URL remota:

- TÃ¡tica: **Execution**  
- TÃ©cnica: **T1218.005 â€“ Mshta** (Signed Binary Proxy Execution)

```splunk
index=windows EventCode=4688 NewProcessName="*mshta.exe" CommandLine="*http*"
```

O Blue Team pode buscar por esse IOC e correlacionar com outros como conexÃµes DNS, C2 e coleta de dados para prever o prÃ³ximo passo.

---

## ğŸ§  Dica prÃ¡tica

Monte uma **matriz personalizada ATT&CK** para sua empresa:

- Relacione tÃ©cnicas relevantes para seu setor (ex: saÃºde, financeiro, OT)  
- Classifique quais jÃ¡ tÃªm detecÃ§Ã£o (verde), quais estÃ£o em desenvolvimento (amarelo), e quais nÃ£o cobrem (vermelho)  
- Atualize a cada nova versÃ£o do ATT&CK (lanÃ§ada semestralmente)

---

## âœ… ConclusÃ£o

O MITRE ATT&CK transforma o trabalho do Blue Team de **reativo para proativo**, permitindo que a equipe antecipe movimentos adversÃ¡rios, melhore sua postura defensiva e direcione esforÃ§os para Ã¡reas mais crÃ­ticas.

# ğŸ”µ 10. Blue Team: IntroduÃ§Ã£o ao Threat Hunting

**Threat Hunting**, ou **caÃ§a a ameaÃ§as**, Ã© uma abordagem proativa na seguranÃ§a cibernÃ©tica, onde analistas buscam evidÃªncias de ameaÃ§as que conseguiram passar pelas defesas automatizadas como antivÃ­rus, firewalls e SIEM.

Ao invÃ©s de esperar por alertas, o caÃ§ador de ameaÃ§as analisa dados, comportamentos e hipÃ³teses com base em inteligÃªncia e anomalias. Ã‰ uma prÃ¡tica essencial para equipes de **Blue Team mais maduras**.

CaÃ§ar ameaÃ§as Ã© buscar o invisÃ­vel antes que ele se torne inevitÃ¡vel.

---

## ğŸ§  O que Ã© Threat Hunting?

Threat Hunting Ã© o processo de **buscar ativamente sinais de intrusÃ£o** em ambientes, mesmo na ausÃªncia de alertas. A ideia central Ã©:  
> "Assuma que vocÃª jÃ¡ foi comprometido."

O caÃ§ador de ameaÃ§as utiliza logs, telemetria, inteligÃªncia de ameaÃ§as (TI) e contexto para identificar **atividades suspeitas ou maliciosas** que passaram despercebidas.

---

## ğŸ” Por que fazer Threat Hunting?

- Identificar ataques em estÃ¡gios iniciais  
- Descobrir ameaÃ§as sem gerar alertas (fileless, living off the land)  
- Testar hipÃ³teses e validar a eficÃ¡cia das defesas  
- Melhorar regras do SIEM e EDR  
- Desenvolver inteligÃªncia prÃ³pria da organizaÃ§Ã£o

---

## ğŸ› ï¸ Fontes de dados comuns

- Sysmon (eventos de processo, rede, DLLs, etc.)  
- DNS logs (consultas de domÃ­nios)  
- Logs de proxy (URLs acessadas)  
- Active Directory (criaÃ§Ã£o de contas, grupos, etc.)  
- Firewall (trÃ¡fego interno/externo)  
- EDR (telemetria detalhada dos endpoints)

---

## ğŸ“˜ Tipos de abordagem

### 1. **Based on Hypothesis (baseado em hipÃ³tese)**  
Inicia com uma hipÃ³tese, geralmente baseada em TTPs ou inteligÃªncia:

> *"E se um atacante estiver usando PowerShell com base64 para manter persistÃªncia?"*

```splunk
index=sysmon EventCode=1 CommandLine="*powershell*" CommandLine="*base64*"
```

### 2. **IOC-based Hunting (baseado em indicadores)**  
Busca por indicadores de ameaÃ§a (hash, IP, domÃ­nio) a partir de feeds ou relatÃ³rios.

```splunk
index=firewall src_ip="185.100.87.84"
```

### 3. **Analytics-Driven Hunting (baseado em anÃ¡lise de comportamento)**  
Identifica anomalias nos dados, como processos incomuns, picos de atividade ou movimentaÃ§Ãµes laterais.

```splunk
index=sysmon EventCode=3
| stats count by dest_ip, user
| where count > 50
```

---

## ğŸ“Š Ferramentas Ãºteis

- SIEM (Splunk, ELK, QRadar)  
- EDRs (CrowdStrike, SentinelOne, Defender)  
- MITRE ATT&CK (para mapear tÃ©cnicas)  
- Sigma Rules (regras hunting compatÃ­veis com SIEM)  
- Velociraptor, Kusto, LimaCharlie, KAPE (para forense e coleta)

---

## ğŸ§  Dica de Hunting bÃ¡sico

> HipÃ³tese: "UsuÃ¡rios executando scripts do Office para baixar payloads maliciosos"

Busca:

```splunk
index=sysmon EventCode=1 ParentImage="*winword.exe" CommandLine="*http*"
```

---

## ğŸ§© IntegraÃ§Ã£o com MITRE ATT&CK

Cada hunt pode ser mapeada a uma **tÃ¡tica/tÃ©cnica** do ATT&CK, por exemplo:

- T1059 â€“ Command and Scripting Interpreter  
- T1218 â€“ Signed Binary Proxy Execution  
- T1086 â€“ PowerShell  
- T1204 â€“ User Execution

Isso ajuda a **padronizar** e **documentar** os hunts para reuso e melhoria contÃ­nua.

---

## âœ… ConclusÃ£o

Threat Hunting Ã© essencial para:

- Descobrir ameaÃ§as avanÃ§adas  
- Aprimorar defesas e regras de detecÃ§Ã£o  
- Reduzir o tempo mÃ©dio de detecÃ§Ã£o (MTTD)  
- Antecipar movimentos do atacante

Com o tempo, o caÃ§ador se torna **um analista estratÃ©gico**, ajudando a construir resiliÃªncia cibernÃ©tica.

# ğŸ”µ 11. Blue Team: IntroduÃ§Ã£o ao Threat Hunting

**Threat Hunting**, ou **caÃ§a a ameaÃ§as**, Ã© uma abordagem proativa na seguranÃ§a cibernÃ©tica, onde analistas buscam evidÃªncias de ameaÃ§as que conseguiram passar pelas defesas automatizadas como antivÃ­rus, firewalls e SIEM.

Ao invÃ©s de esperar por alertas, o caÃ§ador de ameaÃ§as analisa dados, comportamentos e hipÃ³teses com base em inteligÃªncia e anomalias. Ã‰ uma prÃ¡tica essencial para equipes de **Blue Team mais maduras**.

CaÃ§ar ameaÃ§as Ã© buscar o invisÃ­vel antes que ele se torne inevitÃ¡vel.

---

## ğŸ§  O que Ã© Threat Hunting?

Threat Hunting Ã© o processo de **buscar ativamente sinais de intrusÃ£o** em ambientes, mesmo na ausÃªncia de alertas. A ideia central Ã©:  
> "Assuma que vocÃª jÃ¡ foi comprometido."

O caÃ§ador de ameaÃ§as utiliza logs, telemetria, inteligÃªncia de ameaÃ§as (TI) e contexto para identificar **atividades suspeitas ou maliciosas** que passaram despercebidas.

---

## ğŸ” Por que fazer Threat Hunting?

- Identificar ataques em estÃ¡gios iniciais  
- Descobrir ameaÃ§as sem gerar alertas (fileless, living off the land)  
- Testar hipÃ³teses e validar a eficÃ¡cia das defesas  
- Melhorar regras do SIEM e EDR  
- Desenvolver inteligÃªncia prÃ³pria da organizaÃ§Ã£o

---

## ğŸ› ï¸ Fontes de dados comuns

- Sysmon (eventos de processo, rede, DLLs, etc.)  
- DNS logs (consultas de domÃ­nios)  
- Logs de proxy (URLs acessadas)  
- Active Directory (criaÃ§Ã£o de contas, grupos, etc.)  
- Firewall (trÃ¡fego interno/externo)  
- EDR (telemetria detalhada dos endpoints)

---

## ğŸ“˜ Tipos de abordagem

### 1. **Based on Hypothesis (baseado em hipÃ³tese)**  
Inicia com uma hipÃ³tese, geralmente baseada em TTPs ou inteligÃªncia:

> *"E se um atacante estiver usando PowerShell com base64 para manter persistÃªncia?"*

```splunk
index=sysmon EventCode=1 CommandLine="*powershell*" CommandLine="*base64*"
```

### 2. **IOC-based Hunting (baseado em indicadores)**  
Busca por indicadores de ameaÃ§a (hash, IP, domÃ­nio) a partir de feeds ou relatÃ³rios.

```splunk
index=firewall src_ip="185.100.87.84"
```

### 3. **Analytics-Driven Hunting (baseado em anÃ¡lise de comportamento)**  
Identifica anomalias nos dados, como processos incomuns, picos de atividade ou movimentaÃ§Ãµes laterais.

```splunk
index=sysmon EventCode=3
| stats count by dest_ip, user
| where count > 50
```

---

## ğŸ“Š Ferramentas Ãºteis

- SIEM (Splunk, ELK, QRadar)  
- EDRs (CrowdStrike, SentinelOne, Defender)  
- MITRE ATT&CK (para mapear tÃ©cnicas)  
- Sigma Rules (regras hunting compatÃ­veis com SIEM)  
- Velociraptor, Kusto, LimaCharlie, KAPE (para forense e coleta)

---

## ğŸ§  Dica de Hunting bÃ¡sico

> HipÃ³tese: "UsuÃ¡rios executando scripts do Office para baixar payloads maliciosos"

Busca:

```splunk
index=sysmon EventCode=1 ParentImage="*winword.exe" CommandLine="*http*"
```

---

## ğŸ§© IntegraÃ§Ã£o com MITRE ATT&CK

Cada hunt pode ser mapeada a uma **tÃ¡tica/tÃ©cnica** do ATT&CK, por exemplo:

- T1059 â€“ Command and Scripting Interpreter  
- T1218 â€“ Signed Binary Proxy Execution  
- T1086 â€“ PowerShell  
- T1204 â€“ User Execution

Isso ajuda a **padronizar** e **documentar** os hunts para reuso e melhoria contÃ­nua.

---

## âœ… ConclusÃ£o

Threat Hunting Ã© essencial para:

- Descobrir ameaÃ§as avanÃ§adas  
- Aprimorar defesas e regras de detecÃ§Ã£o  
- Reduzir o tempo mÃ©dio de detecÃ§Ã£o (MTTD)  
- Antecipar movimentos do atacante

Com o tempo, o caÃ§ador se torna **um analista estratÃ©gico**, ajudando a construir resiliÃªncia cibernÃ©tica.

---

# ğŸ”µ 12. Blue Team: Instalar e Configurar Security Onion em uma VM

**Security Onion** Ã© uma distribuiÃ§Ã£o Linux baseada em Ubuntu voltada para **monitoramento, detecÃ§Ã£o e resposta a incidentes**. Ela integra ferramentas como Zeek, Suricata, Wazuh, TheHive, Kibana, Elasticsearch e muito mais â€“ tudo pronto para uso por Blue Teams.

Instalar o Security Onion em uma VM Ã© a melhor forma de montar seu **lab de SOC caseiro** e comeÃ§ar a aprender anÃ¡lise de trÃ¡fego, eventos e alertas reais.

Se vocÃª quer aprender Blue Team de verdade, comece onde as ameaÃ§as chegam: nos logs e pacotes.

---

## ğŸ› ï¸ PrÃ©-requisitos

- **VirtualBox ou VMware Workstation**  
- Pelo menos **8 GB de RAM** (recomendado 12 GB)  
- **2 CPUs ou mais**  
- Disco de **mÃ­nimo 100 GB**  
- ISO do [Security Onion](https://securityonion.net/)  
- ConexÃ£o de rede em modo **Bridged** ou **Host-only** (para anÃ¡lise de trÃ¡fego externo ou simulado)

---

## ğŸ“¦ Passo a passo de instalaÃ§Ã£o

### 1. ğŸ”½ Baixar o ISO

Acesse:  
https://securityonion.net/download

Baixe a ISO mais recente (ex: `securityonion-2.4.x.iso`)

---

### 2. ğŸ–¥ï¸ Criar uma VM

- Sistema: Linux > Ubuntu (64-bit)  
- CPU: 2 ou mais  
- RAM: 8 a 16 GB  
- Disco: 100 GB (dinamicamente alocado)  
- Placa de rede: **Bridged Adapter** ou **Host-only Adapter**

---

### 3. ğŸ”§ Iniciar instalaÃ§Ã£o

- Monte a ISO como CD  
- Boot pela ISO  
- Escolha a opÃ§Ã£o **Install Security Onion 2.4**  
- Siga as instruÃ§Ãµes de instalaÃ§Ã£o como em qualquer Ubuntu Server

---

## âš™ï¸ Configurar o Security Onion apÃ³s instalaÃ§Ã£o

ApÃ³s o primeiro boot, vocÃª verÃ¡ uma tela para iniciar a **configuraÃ§Ã£o inicial**:

### 1. ğŸ“¡ Escolha do modo de instalaÃ§Ã£o

Security Onion oferece 3 modos principais:

| Modo       | DescriÃ§Ã£o                              |
|------------|------------------------------------------|
| Standalone | Tudo em uma Ãºnica VM                    |
| Evaluation | Ideal para testes; menos recursos       |
| Distributed| Dividido entre sensores, manager, etc. |

**Escolha `Standalone` ou `Evaluation` para labs.**

---

### 2. ğŸ“ConfiguraÃ§Ãµes bÃ¡sicas

VocÃª serÃ¡ guiado por um script de configuraÃ§Ã£o (`so-setup`):

- Nome do sensor  
- IP da mÃ¡quina  
- Interface de monitoramento (ex: `eth1`)  
- Interface de gerenciamento (ex: `eth0`)  
- Senha do administrador  
- Ativar Elastic Stack, Suricata, Zeek, etc.

---

### 3. â³ Aguardar instalaÃ§Ã£o dos componentes

O sistema irÃ¡ instalar todos os containers e serviÃ§os via Docker. Isso pode levar **15â€“30 minutos** dependendo da mÃ¡quina.

---

## ğŸ”“ Acessar a interface web

Abra o navegador e acesse:

```text
https://<ip_da_vm>

Credenciais:

- UsuÃ¡rio: `admin`  
- Senha: definida durante a instalaÃ§Ã£o

VocÃª terÃ¡ acesso ao **Security Onion Console (SOC)**, com painÃ©is como:

- **Alerts** (Suricata, Zeek, etc.)  
- **Hunt** (busca por logs)  
- **PCAPs**  
- **Cases (TheHive)**  
- **Dashboards (Kibana)**

---

## ğŸ§ª Testar ingestÃ£o de trÃ¡fego

VocÃª pode simular trÃ¡fego para testar detecÃ§Ãµes:

1. **Ping ou curl em domÃ­nios externos**  
2. **Usar Kali Linux na mesma rede e rodar scripts (ex: nmap)**  
3. **Gerar logs com ferramentas como [Invoke-AtomicRedTeam](https://github.com/redcanaryco/invoke-atomicredteam)**  
4. **Usar scripts como `wget http://testmyids.com` para simular alertas**

---

## ğŸ“Œ Dicas finais

- Use **Snapshots da VM** antes de alteraÃ§Ãµes maiores  
- Monitore o uso de disco/RAM â€” pode crescer rÃ¡pido  
- Estude os logs em `/opt/so/logs/` para entender o backend  
- Explore os dashboards e detecÃ§Ãµes no Kibana  
- Configure outra VM como **target** para testes realistas (ex: Windows com Sysmon)

---

## âœ… ConclusÃ£o

Instalar o Security Onion em uma VM Ã© um excelente primeiro passo para:

- Criar um laboratÃ³rio SOC funcional  
- Estudar anÃ¡lise de trÃ¡fego e eventos reais  
- Aprender como funcionam ferramentas como Zeek, Suricata, Elastic, TheHive

# ğŸ¯ Blue Team: Simular Ataque com Logs Falsos e Analisar no SIEM

Simular ataques com **logs falsos** Ã© uma das melhores formas de treinar equipes de Blue Team em um ambiente controlado. Com isso, Ã© possÃ­vel validar regras de detecÃ§Ã£o, visualizar eventos no SIEM e praticar investigaÃ§Ãµes sem comprometer ambientes reais.

Neste guia, vocÃª aprenderÃ¡ a criar logs simulados, injetÃ¡-los no SIEM (ex: ELK Stack) e analisÃ¡-los como se fosse um incidente real.

Quem treina no simulado, atua com precisÃ£o no real.

---

## ğŸ¯ Objetivo

- Criar eventos de ataque falsos (simulados)  
- Injetar os logs no SIEM (Kibana/Elasticsearch)  
- Visualizar, buscar e interpretar os eventos  
- Praticar hunting e anÃ¡lise tÃ¡tica

---

## ğŸ§ª CenÃ¡rio simulado: ataque por brute-force

Vamos simular um cenÃ¡rio onde um atacante tenta invadir um servidor por forÃ§a bruta (brute-force), gerando mÃºltiplas tentativas de login com falha.

---

## ğŸ—‚ï¸ 1. Criar os logs falsos

Use um arquivo `.json` ou `.csv` com estrutura parecida com os logs reais.

### ğŸ“ Exemplo de log simulado (`brute_force.json`):

```json
{
  "timestamp": "2025-06-27T15:42:00Z",
  "event_type": "authentication_failure",
  "username": "admin",
  "src_ip": "185.100.87.84",
  "message": "Falha de login por senha incorreta",
  "system": "ssh",
  "log_level": "warning"
}
```

Copie esse evento vÃ¡rias vezes, variando o horÃ¡rio ou IP para parecer realista.

---

## ğŸš€ 2. Injetar logs no ELK (Elasticsearch)

### OpÃ§Ã£o 1: via Logstash

Crie um arquivo de configuraÃ§Ã£o Logstash (`logstash-brute.conf`):

```bash
input {
  file {
    path => "/caminho/brute_force.json"
    start_position => "beginning"
    sincedb_path => "/dev/null"
    codec => json
  }
}
filter { }
output {
  elasticsearch {
    hosts => ["http://localhost:9200"]
    index => "brute-simulado"
  }
}
```

Execute:

```bash
logstash -f logstash-brute.conf
```

### OpÃ§Ã£o 2: via script Python com `requests`

```python
import json, requests

with open('brute_force.json') as f:
    data = json.load(f)

r = requests.post('http://localhost:9200/brute-simulado/_doc', json=data)
print(r.status_code)
```

---

## ğŸ§  3. Analisar no Kibana

Acesse:  
http://localhost:5601

1. VÃ¡ atÃ© â€œDiscoverâ€  
2. Escolha o Ã­ndice `brute-simulado`  
3. Visualize os campos como:
   - `src_ip`  
   - `username`  
   - `event_type`  
   - `message`  

VocÃª pode usar filtros como:

```kql
event_type : "authentication_failure" AND username : "admin"
```

---

## ğŸ” 4. Simular anÃ¡lise de incidente

### ğŸ§© Etapas:

- Identifique IPs com mÃºltiplas falhas  
- Verifique o horÃ¡rio e frequÃªncia  
- Busque por sucesso apÃ³s as falhas (comprometimento?)  
- Verifique se houve movimentaÃ§Ã£o lateral (outros sistemas?)

### ğŸ§  HipÃ³tese:

> *O IP `185.100.87.84` tentou invadir via brute-force com a conta "admin".*

---

## ğŸ“ˆ 5. Criar visualizaÃ§Ãµes

- **GrÃ¡fico de falhas por IP**
- **Timeline de tentativas**
- **Mapa de calor por usuÃ¡rio e horÃ¡rio**

No Kibana, crie dashboards para:

- Eventos por minuto  
- Top IPs de origem  
- Contas mais atacadas  

---

## âœ… ConclusÃ£o

Simular logs falsos Ã© uma forma **poderosa, prÃ¡tica e segura** de treinar anÃ¡lise de incidentes. Com poucos comandos, Ã© possÃ­vel construir uma rotina de:

- Teste de regras de detecÃ§Ã£o  
- SimulaÃ§Ã£o de cenÃ¡rios reais  
- Treinamento de SOC e Blue Team

---

# ğŸ”µ 13. Blue Team: AnÃ¡lise de TrÃ¡fego de Malware com Wireshark (Exemplo: Emotet PCAP)

O Wireshark Ã© uma das ferramentas mais poderosas para **analisar trÃ¡fego de rede**. Ao capturar ou abrir um arquivo `.pcap` com trÃ¡fego malicioso, como o gerado por Emotet, Ã© possÃ­vel observar cada etapa do comportamento de um malware: infecÃ§Ã£o, comunicaÃ§Ã£o com C2, downloads de payloads, entre outros.

Neste mÃ³dulo, vamos explorar como analisar um PCAP infectado com **Emotet**, um dos trojans bancÃ¡rios mais sofisticados jÃ¡ observados.

Wireshark nÃ£o mostra apenas pacotes â€“ ele revela histÃ³rias que firewalls tentaram esquecer.

---

## ğŸ§ª O que Ã© um PCAP?

PCAP significa **Packet Capture**. Ã‰ um arquivo que armazena **todos os pacotes capturados** de uma comunicaÃ§Ã£o de rede.

Exemplos de fontes:

- Captura real via Wireshark ou tcpdump  
- Sandbox de malware (ex: Any.Run, MalShare)  
- PCAPs pÃºblicos de repositÃ³rios (ex: Contagio, Malware-Traffic-Analysis.net)

---

## ğŸ› ï¸ Ferramentas necessÃ¡rias

- **Wireshark** (https://www.wireshark.org)  
- PCAP de amostra do Emotet (recomendado: [malware-traffic-analysis.net](https://www.malware-traffic-analysis.net))  
- Ambiente isolado (VM, sem rede ativa, se necessÃ¡rio)

---

## ğŸ” Passos para AnÃ¡lise no Wireshark

### 1. Abrir o arquivo `.pcap`

```bash
File > Open > emotet-infection-example.pcap
```

### 2. Aplicar filtros para trÃ¡fego HTTP

```wireshark
http
```

Observe requisiÃ§Ãµes suspeitas como:

- RequisiÃ§Ãµes POST incomuns  
- User-Agent falsificado  
- DomÃ­nios estranhos ou IPs externos diretos  
- Downloads de `.doc`, `.dll`, `.exe`

---

### 3. Filtrar apenas o trÃ¡fego do host infectado

```wireshark
ip.addr == 192.168.1.101
```

> Substitua pelo IP da mÃ¡quina infectada no cenÃ¡rio simulado.

---

### 4. Identificar beaconing / comunicaÃ§Ã£o com C2

```wireshark
tcp.port == 80 || tcp.port == 443
```

Observe conexÃµes frequentes para o mesmo IP, tamanho pequeno de pacotes, possÃ­veis padrÃµes de periodicidade (indicadores de **beaconing**).

---

### 5. Extrair arquivos maliciosos

Se o malware fez download de arquivos `.exe` ou `.dll`, vocÃª pode exportÃ¡-los via:

```text
File > Export Objects > HTTP
```

Salve os arquivos e, se quiser analisar com seguranÃ§a, use uma sandbox isolada (como [Hybrid Analysis](https://www.hybrid-analysis.com)).

---

## ğŸ§  Indicadores comuns do Emotet

| Tipo         | Exemplo                                       |
|--------------|-----------------------------------------------|
| User-Agent   | `Mozilla/5.0 (Windows NT 10.0...)`             |
| URLs         | `/temp.php`, `/update.php`, `/image.php`      |
| IPs C2       | 45.76.89.103, 185.234.217.101, etc.            |
| Arquivos     | `.doc`, `.xls`, `.exe`                        |
| PadrÃµes      | POST sem resposta, beacon a cada X segundos   |

---

## ğŸ“ˆ Dicas de anÃ¡lise

- Use a aba **Follow TCP Stream** para ver a comunicaÃ§Ã£o completa de um canal  
- Salve partes da comunicaÃ§Ã£o para anÃ¡lise em scripts ou SIEM  
- Combine com IOC hunting (IPs, domÃ­nios, hash MD5 dos arquivos exportados)  
- Documente seus achados: tempo, IP, payload, comportamento

---

## ğŸ§© IntegraÃ§Ã£o com Blue Team

Essa anÃ¡lise complementa:

- CaÃ§a por IOCs no SIEM  
- Regras de bloqueio no firewall/DNS  
- CorrelaÃ§Ã£o com logs de endpoint  
- ReaÃ§Ã£o em incidentes reais

---

## âœ… ConclusÃ£o

Analisar um PCAP malicioso como o do Emotet Ã© uma habilidade essencial para qualquer analista de defesa. Isso permite entender nÃ£o apenas **como o ataque aconteceu**, mas tambÃ©m **como evitÃ¡-lo, detectÃ¡-lo e respondÃª-lo** em tempo real.

# ğŸ”µ 14. Blue Team: Mini-Hunting com MITRE ATT&CK + ELK Stack

O **Mini-Hunting** Ã© uma prÃ¡tica de caÃ§a a ameaÃ§as focada, onde se utiliza um conjunto limitado de tÃ©cnicas para detectar comportamentos suspeitos em dados coletados. Combinando o framework **MITRE ATT&CK** e a poderosa plataforma **ELK Stack** (Elasticsearch, Logstash e Kibana), o analista pode realizar buscas eficientes para identificar atividades maliciosas no ambiente.

CaÃ§ar ameaÃ§as Ã© mais do que reagir â€” Ã© antecipar os passos do adversÃ¡rio com dados e metodologia.

---

## ğŸ¯ Objetivo do Mini-Hunting

- Focar em tÃ©cnicas especÃ­ficas do MITRE ATT&CK  
- Realizar buscas direcionadas em logs armazenados no Elasticsearch  
- Identificar padrÃµes suspeitos com rapidez  
- Validar hipÃ³teses simples para investigaÃ§Ã£o inicial  

---

## ğŸ” Passos para realizar Mini-Hunting com ATT&CK + ELK

### 1. Escolha tÃ©cnicas ATT&CK relevantes

Exemplos para caÃ§a rÃ¡pida:

| TÃ¡tica               | TÃ©cnica                  | CÃ³digo ATT&CK  |
|----------------------|--------------------------|---------------|
| Execution            | PowerShell               | T1059.001     |
| Defense Evasion      | Masquerading             | T1036         |
| Credential Access    | Brute Force              | T1110         |
| Persistence          | Registry Run Keys        | T1547         |

---

### 2. Preparar consultas no Kibana usando DSL Elasticsearch

Exemplo de consulta para detectar execuÃ§Ã£o de PowerShell com comandos codificados:

```json
GET /sysmon-*/_search
{
  "query": {
    "bool": {
      "must": [
        { "match": { "process_name": "powershell.exe" }},
        { "wildcard": { "command_line": "*-enc*" }}
      ]
    }
  }
}
```

---

### 3. Executar buscas e analisar resultados

- Filtrar por eventos com anomalias (comandos codificados, caminhos suspeitos)  
- Observar frequÃªncia, usuÃ¡rios envolvidos, horÃ¡rios e endereÃ§os IP  
- Correlacionar com outras tÃ©cnicas para aumentar confianÃ§a

---

### 4. Criar visualizaÃ§Ãµes simples no Kibana

- GrÃ¡fico de barras: nÃºmero de execuÃ§Ãµes PowerShell por usuÃ¡rio  
- Tabela: eventos de criaÃ§Ã£o de chaves de registro (persistÃªncia)  
- Linha do tempo: tentativas de brute-force ao longo do dia

---

### 5. Documentar hipÃ³teses e resultados

Registre:

- TÃ©cnica investigada  
- Query usada  
- Eventos identificados  
- PrÃ³ximos passos para aprofundar ou mitigar

---

## ğŸ§  Dicas para Mini-Hunting efetivo

- Comece por tÃ©cnicas conhecidas que causam impacto alto  
- Use Sigma para criar regras portÃ¡veis e convertÃª-las para consultas Elasticsearch  
- Periodicamente atualize as consultas com novas tÃ©cnicas do ATT&CK  
- Combine dados de endpoints, rede e logs de sistema

---

## âœ… BenefÃ­cios do Mini-Hunting com ATT&CK + ELK

- Aumento da visibilidade sem necessidade de alertas complexos  
- Processo rÃ¡pido e focado para triagem inicial  
- Base sÃ³lida para escalar para caÃ§as mais detalhadas  
- Facilita alinhamento entre equipe e frameworks reconhecidos

---



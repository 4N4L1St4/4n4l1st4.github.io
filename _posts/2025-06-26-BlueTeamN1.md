---
title: "Blue Team: Analista de Ciberseguran√ßa J√∫nior"
date: 2025-06-26 16:30:00 -0300
categories: [Blue Team, Nivel 1]
tags: [Teorica]
description: "Profissional em in√≠cio de carreira, respons√°vel por monitoramento b√°sico, identifica√ß√£o preliminar de amea√ßas e suporte √†s opera√ß√µes de seguran√ßa. Atua seguindo procedimentos estabelecidos e orienta√ß√µes de profissionais mais experientes, desenvolvendo habilidades t√©cnicas e conhecimento do ambiente de seguran√ßa."
image:
  path: /assets/img/BlueTeamN1.png
  alt: Ilustra√ß√£o de um computador moderno com elementos de c√≥digo e processamento
---

# üîµ 1. Blue Team: Introdu√ß√£o √† Seguran√ßa da Informa√ß√£o

A atua√ß√£o de um profissional de Blue Team come√ßa com a compreens√£o dos **fundamentos da Seguran√ßa da Informa√ß√£o**. Nesta introdu√ß√£o, voc√™ vai entender os pilares CIA, os tipos de amea√ßas, os riscos associados e os principais controles de prote√ß√£o utilizados para manter os ambientes seguros.

N√£o h√° defesa eficaz sem entender o que estamos tentando proteger.

## üîê O que √© Seguran√ßa da Informa√ß√£o?

Seguran√ßa da Informa√ß√£o √© o conjunto de pr√°ticas, pol√≠ticas e processos voltados para proteger dados e sistemas contra acessos n√£o autorizados, danos, vazamentos e interrup√ß√µes.


## üß± Princ√≠pios Fundamentais ‚Äì Modelo **CIA**

O modelo CIA representa os **tr√™s pilares essenciais da seguran√ßa**:

- **C ‚Äì Confidencialidade (Confidentiality):**  
  Garante que as informa√ß√µes sejam acessadas apenas por pessoas autorizadas.  
  *Ex: Criptografia, autentica√ß√£o de dois fatores.*

- **I ‚Äì Integridade (Integrity):**  
  Assegura que os dados n√£o sejam alterados indevidamente, mantendo sua exatid√£o e confiabilidade.  
  *Ex: Checksums, logs de auditoria, controle de vers√µes.*

- **A ‚Äì Disponibilidade (Availability):**  
  Garante que os sistemas e dados estejam dispon√≠veis sempre que necess√°rio.  
  *Ex: Backup, balanceamento de carga, redund√¢ncia.*


## ‚ö†Ô∏è Tipos Comuns de Amea√ßas

Uma **amea√ßa** √© qualquer evento ou agente que tenha o potencial de causar dano √† informa√ß√£o ou aos sistemas.

- **Malwares:** v√≠rus, worms, trojans, ransomware  
- **Ataques de rede:** DDoS, sniffing, spoofing  
- **Amea√ßas internas:** usu√°rios mal-intencionados ou negligentes  
- **Phishing e engenharia social**  
- **Vulnerabilidades exploradas (zero-day, exploits)**


## üéØ Risco em Seguran√ßa

**Risco = Amea√ßa √ó Vulnerabilidade √ó Impacto**

O risco √© a **probabilidade de um incidente ocorrer**, levando em conta a exist√™ncia de vulnerabilidades e o impacto que isso pode gerar.

*Exemplo:*  
Um servidor exposto √† internet sem patch √© uma vulnerabilidade. Se uma amea√ßa conhecida explorar essa falha, o risco √© elevado.


## üõ°Ô∏è Controles de Seguran√ßa

Os **controles** s√£o mecanismos implementados para reduzir riscos, prevenir, detectar ou responder a incidentes.

### üîí Tipos de Controles:

- **Preventivos:** impedem que incidentes ocorram  
  *Ex: Firewall, autentica√ß√£o multifator, pol√≠ticas de senha*

- **Detectivos:** identificam que algo est√° acontecendo  
  *Ex: SIEM, IDS, logs, alertas*

- **Corretivos:** minimizam o dano ap√≥s um incidente  
  *Ex: Backup, plano de resposta a incidentes, restaura√ß√£o de sistemas*

- **Deterrentes:** desestimulam a√ß√µes maliciosas  
  *Ex: C√¢meras, avisos de monitoramento, pol√≠ticas vis√≠veis*


## üß† Por que isso √© importante para o Blue Team?

Um analista Blue Team deve conhecer profundamente esses fundamentos para:

- Compreender e classificar incidentes de forma adequada  
- Escolher os controles certos para cada tipo de risco  
- Monitorar eventos com foco em amea√ßas reais  
- Aplicar boas pr√°ticas com base no modelo CIA

# üîµ 2. O que √© Blue Team?

O **Blue Team** √© o grupo respons√°vel pela **defesa cibern√©tica** de uma organiza√ß√£o. Sua miss√£o √© proteger sistemas, redes, aplica√ß√µes e dados contra amea√ßas internas e externas, detectando, respondendo e mitigando ataques em tempo real.


## üéØ Objetivo

Garantir a **resili√™ncia e seguran√ßa cont√≠nua** do ambiente de TI, monitorando atividades, detectando anomalias e **respondendo rapidamente a incidentes de seguran√ßa**.

Enquanto o Red Team pensa como o inimigo, o Blue Team protege como um guardi√£o incans√°vel.

## üõ°Ô∏è Atividades Comuns

- Monitoramento cont√≠nuo de redes e sistemas  
- An√°lise e correla√ß√£o de logs (com SIEMs)  
- Detec√ß√£o e resposta a incidentes (SOC, CSIRT)  
- Threat Hunting (busca ativa por amea√ßas)  
- Aplica√ß√£o de patches e hardening de sistemas  
- Gest√£o de vulnerabilidades  
- An√°lise de malwares e forense digital  
- Implementa√ß√£o de pol√≠ticas e controles de seguran√ßa  


## üîÑ Ciclo de Trabalho

1. **Monitorar** (com ferramentas como SIEM e EDR)  
2. **Detectar** comportamentos an√¥malos  
3. **Responder** a incidentes rapidamente  
4. **Recuperar** sistemas afetados  
5. **Aprimorar** defesas com base no aprendizado


## üß† Perfis do Time

- Analista SOC (n√≠veis 1, 2 e 3)  
- Analista de Resposta a Incidentes (CSIRT)  
- Threat Hunter  
- Especialista em Forense  
- Blue Team Engineer / Security Analyst  
- Profissionais com certifica√ß√µes como:  
  - CompTIA Security+  
  - GCIA, GCIH (SANS)  
  - CEH (Certified Ethical Hacker)  
  - Blue Team Level 1/2 (BTL1, BTL2)


## üõ†Ô∏è Ferramentas Usadas

- **SIEMs**: Splunk, ELK, QRadar, Microsoft Sentinel  
- **EDR/XDR**: CrowdStrike, SentinelOne, Microsoft Defender  
- **SOAR**: Cortex XSOAR, IBM Resilient  
- **Forense**: Autopsy, Volatility, FTK  
- **An√°lise de Tr√°fego**: Wireshark, Zeek, Suricata  
- **Gest√£o de vulnerabilidades**: Nessus, Qualys, OpenVAS


## ü§ù Rela√ß√£o com Outros Times

- **Red Team (üî¥):** Testa as defesas da equipe azul com ataques simulados  
- **Purple Team (üü£):** Integra Red + Blue para melhorar continuamente ambos  
- **White Team (‚ö™):** Supervisiona e define as regras dos exerc√≠cios  


## üìö Frameworks e Refer√™ncias

- **MITRE ATT&CK for Defense**  
- NIST 800-61 (Guia de Resposta a Incidentes)  
- CIS Controls v8  
- NIST CSF (Cybersecurity Framework)


## ‚úÖ Benef√≠cios para a Organiza√ß√£o

- Redu√ß√£o de tempo de resposta a incidentes  
- Menor risco de vazamentos e perdas de dados  
- Detec√ß√£o precoce de amea√ßas  
- Resili√™ncia operacional frente a ataques  
- Melhoria cont√≠nua da postura de seguran√ßa

# üîµ 3. Blue Team: Fundamentos de Redes

Para atuar de forma eficaz na defesa cibern√©tica, um profissional Blue Team precisa compreender os **fundamentos das redes**. Esses conhecimentos s√£o essenciais para analisar tr√°fego, detectar comportamentos an√¥malos e identificar amea√ßas que se propagam pela rede.

A base de toda defesa √© entender como o tr√°fego leg√≠timo se comporta.

## üß± Modelo OSI ‚Äì A Estrutura da Comunica√ß√£o

O **modelo OSI** (Open Systems Interconnection) divide a comunica√ß√£o em **7 camadas**, facilitando a an√°lise de como os dados trafegam.

| Camada | Nome                      | Fun√ß√£o Principal                                |
|--------|---------------------------|--------------------------------------------------|
| 7      | Aplica√ß√£o                 | Intera√ß√£o com o usu√°rio (HTTP, DNS, FTP)         |
| 6      | Apresenta√ß√£o              | Criptografia, compress√£o (TLS, JPEG)             |
| 5      | Sess√£o                    | Controle de sess√µes (RPC, NetBIOS)               |
| 4      | Transporte                | Controle de fluxo (TCP, UDP)                     |
| 3      | Rede                      | Roteamento e endere√ßamento (IP)                  |
| 2      | Enlace de Dados           | MAC, switches, detec√ß√£o de erros                 |
| 1      | F√≠sica                    | Cabos, sinais, hubs                              |


## üåê Endere√ßamento IP (IPv4)

O endere√ßo IP (Internet Protocol) identifica um dispositivo em uma rede.  
Exemplo de IPv4: `192.168.0.10`

- **Classe A, B, C**: categorias de endere√ßos  
- **IP privado:** n√£o acess√≠vel da internet (ex: 192.168.x.x)  
- **IP p√∫blico:** utilizado para comunica√ß√£o externa  
- **M√°scara de sub-rede:** define o tamanho da rede (ex: 255.255.255.0)


## üì° Protocolo DNS

O **DNS (Domain Name System)** traduz nomes de dom√≠nio (ex: google.com) para endere√ßos IP.

- **Tipo de registro:** A (IPv4), AAAA (IPv6), MX (e-mail), TXT (SPF, DKIM)  
- **Resolu√ß√£o direta e reversa**  
- **Ataques comuns:** DNS spoofing, tunneling, amplification


## üåê Protocolo HTTP/HTTPS

O **HTTP (Hypertext Transfer Protocol)** √© o protocolo da web.  
O **HTTPS** √© a vers√£o segura (com TLS).

- **M√©todos comuns:** GET, POST, PUT, DELETE  
- **C√≥digos de resposta:**  
  - 200 OK  
  - 403 Forbidden  
  - 404 Not Found  
  - 500 Internal Server Error  
- **Cabe√ßalhos importantes:** User-Agent, Host, Cookie  


## üîÅ Protocolos TCP e UDP

### üß© TCP (Transmission Control Protocol)

- Confi√°vel (garante entrega)  
- Utiliza o **three-way handshake** (SYN, SYN-ACK, ACK)  
- Aplica√ß√µes: HTTP, HTTPS, SSH, SMTP

### üß© UDP (User Datagram Protocol)

- N√£o confi√°vel (sem garantia de entrega)  
- Mais r√°pido, usado em streaming, DNS, VoIP  
- Aplica√ß√µes: DNS, DHCP, SNMP, NTP


## üõ°Ô∏è Relev√¢ncia para o Blue Team

Dominar os conceitos de redes √© essencial para:

- Analisar **pacotes com Wireshark**  
- Compreender alertas de **IDS/IPS (Snort, Suricata)**  
- Criar **regras de detec√ß√£o em SIEM**  
- Monitorar tr√°fego an√¥malo e identificar **exfiltra√ß√µes de dados**  
- Investigar **t√©cnicas de C2** e **comunica√ß√£o maliciosa**

# üîµ 4. Blue Team: Leitura e Interpreta√ß√£o de Pacotes com Wireshark

O **Wireshark** √© uma das ferramentas mais importantes para profissionais de seguran√ßa da informa√ß√£o, especialmente para o time Blue Team. Ele permite a an√°lise de tr√°fego de rede em tempo real ou capturado em arquivos `.pcap`, ajudando na investiga√ß√£o de incidentes, anomalias e comportamento malicioso.

Quem domina o tr√°fego de rede tem o poder de entender, prever e bloquear ataques antes que causem dano.

## üê¨ O que √© o Wireshark?

O **Wireshark** √© um analisador de pacotes gratuito e de c√≥digo aberto usado para capturar e inspecionar o tr√°fego de rede at√© o n√≠vel de cada bit, seguindo o modelo OSI.


## üì¶ O que √© um pacote?

Um **pacote de rede** √© uma unidade de dados transmitida entre dispositivos em uma rede. Ele cont√©m informa√ß√µes sobre origem, destino, tipo de protocolo, dados e muito mais.


## üì• Como capturar pacotes com Wireshark?

1. **Selecionar a interface de rede ativa** (ex: Ethernet ou Wi-Fi)<br>
2. Clicar em **"Start capturing packets"**<br>
3. Observar os pacotes sendo listados em tempo real<br>
4. Utilizar **filtros** para refinar a captura e an√°lise<br>


## üéØ Filtros de Captura e de Exibi√ß√£o

### üîπ Filtros de captura (antes de iniciar):
- `tcp port 80` ‚Üí captura somente tr√°fego HTTP  
- `host 192.168.1.10` ‚Üí tr√°fego de um IP espec√≠fico  

### üîπ Filtros de exibi√ß√£o (durante a an√°lise):
- `http` ‚Üí exibe apenas pacotes HTTP  
- `ip.addr == 8.8.8.8` ‚Üí qualquer pacote com esse IP  
- `tcp.flags.syn == 1` ‚Üí pacotes SYN (in√≠cio de conex√£o TCP)  


## üîç Estrutura de um pacote (exemplo TCP)

Ao clicar em um pacote, o Wireshark mostra:

1. **Camada f√≠sica / Ethernet**: origem e destino MAC  
2. **IP**: endere√ßo de origem e destino  
3. **TCP/UDP**: portas, flags (SYN, ACK, RST, etc.)  
4. **Aplica√ß√£o**: conte√∫do HTTP, DNS, FTP, etc.  


## üõ†Ô∏è Exemplos pr√°ticos

### ‚úÖ Verificando handshake TCP:

Use o filtro: `tcp.flags.syn == 1 && tcp.flags.ack == 0`  
Voc√™ ver√° o pacote **SYN**, sinalizando o in√≠cio de uma conex√£o.

### ‚úÖ Inspecionando requisi√ß√£o HTTP:

Use o filtro: `http.request`  
Voc√™ pode visualizar o m√©todo (GET/POST), o `User-Agent` e o `Host`.

### ‚úÖ Identificando exfiltra√ß√£o via DNS:

Use o filtro: `dns`  
An√°lise de consultas suspeitas como `abc123.attacker.com` pode indicar tunneling.


## üõ°Ô∏è Aplica√ß√µes para o Blue Team

- An√°lise de tr√°fego em incidentes de seguran√ßa  
- Detec√ß√£o de comunica√ß√£o com C2 (Command & Control)  
- Investiga√ß√£o de ataques (ex: DNS tunneling, malware callbacks)  
- An√°lise de exfiltra√ß√£o de dados  
- Compreens√£o de ataques como scans, DoS, brute-force  


## üìÇ Fontes de arquivos `.pcap` para treino

- [https://www.malware-traffic-analysis.net](https://www.malware-traffic-analysis.net)  
- [https://www.netresec.com/?page=PcapFiles](https://www.netresec.com/?page=PcapFiles)  
- [https://www.tracewrangler.com/samplepcaps](https://www.tracewrangler.com/samplepcaps)


## üìò Dica extra

Salve sess√µes suspeitas como `.pcap` e crie seu reposit√≥rio de amea√ßas para futura refer√™ncia. Isso ajuda a montar uma **base de IOC comportamental**.

# üîµ 5. Blue Team: Logs do Windows e Linux ‚Äì Onde Est√£o e Como Ler

Um dos principais pilares da atua√ß√£o do Blue Team √© a **an√°lise de logs**. Eles s√£o a base para detec√ß√£o de amea√ßas, resposta a incidentes e investiga√ß√£o forense. Saber **onde os logs ficam armazenados** e **como interpret√°-los** √© essencial para qualquer analista de seguran√ßa.

Logs s√£o como a caixa preta de um sistema: quem sabe l√™-los, entende tudo o que aconteceu ‚Äì e o que est√° prestes a acontecer.

## ü™ü Logs no Windows

O Windows registra diversos eventos importantes em seus **logs de eventos (Event Logs)**. Esses logs podem ser visualizados usando o **Event Viewer** (`eventvwr.msc`) ou exportados para an√°lise posterior.

### üóÇÔ∏è Principais categorias de logs:

| Log                   | Caminho no Event Viewer                         | O que cont√©m                                |
|-----------------------|--------------------------------------------------|----------------------------------------------|
| **Application**       | Event Viewer ‚Üí Windows Logs ‚Üí Application       | Erros de aplicativos, falhas de sistema      |
| **System**            | Event Viewer ‚Üí Windows Logs ‚Üí System            | Driver, kernel, falhas de hardware           |
| **Security**          | Event Viewer ‚Üí Windows Logs ‚Üí Security          | Eventos de login, tentativas de acesso       |
| **Setup**             | Event Viewer ‚Üí Windows Logs ‚Üí Setup             | Instala√ß√µes, atualiza√ß√µes                     |
| **Forwarded Events**  | Event Viewer ‚Üí Applications and Services Logs   | Logs de eventos recebidos via forwarding     |


### üîê Eventos de seguran√ßa importantes:

| Evento ID | Descri√ß√£o                                     |
|-----------|-----------------------------------------------|
| 4624      | Logon bem-sucedido                            |
| 4625      | Tentativa de logon falha                      |
| 4688      | Cria√ß√£o de processo                           |
| 4697      | Instala√ß√£o de novo servi√ßo                    |
| 4719      | Pol√≠tica de auditoria alterada                |
| 4720‚Äì4732 | Cria√ß√£o/modifica√ß√£o de contas e grupos        |


### üìç Local f√≠sico dos logs:

- Caminho: `C:\Windows\System32\winevt\Logs\`  
- Extens√£o: `.evtx`  
- Leitura com: Event Viewer, PowerShell, ou ferramentas como **Log Parser**, **EventLog Explorer**


## üêß Logs no Linux

No Linux, os logs geralmente s√£o armazenados em arquivos de texto localizados em `/var/log`. O sistema de logging pode variar (ex: `rsyslog`, `journald`, `syslog-ng`), mas a estrutura geral se mant√©m.

### üóÇÔ∏è Principais arquivos de log:

| Caminho                  | Descri√ß√£o                                      |
|--------------------------|------------------------------------------------|
| `/var/log/syslog`        | Log geral do sistema (Debian/Ubuntu)           |
| `/var/log/messages`      | Log geral do sistema (RHEL/CentOS)             |
| `/var/log/auth.log`      | Log de autentica√ß√£o e sudo (Debian/Ubuntu)     |
| `/var/log/secure`        | Log de autentica√ß√£o (RHEL/CentOS)              |
| `/var/log/boot.log`      | Mensagens de inicializa√ß√£o do sistema          |
| `/var/log/kern.log`      | Logs do kernel                                 |
| `/var/log/faillog`       | Tentativas de login inv√°lidas                  |
| `/var/log/wtmp` / `last` | Hist√≥rico de logins                            |


### üîç Como visualizar logs:

- `cat /var/log/auth.log` ‚Äì imprime o conte√∫do  
- `tail -f /var/log/syslog` ‚Äì monitora em tempo real  
- `grep "sshd" /var/log/auth.log` ‚Äì filtra por palavra-chave  
- `journalctl` ‚Äì visualiza logs do `systemd` (em distribui√ß√µes modernas)


## üõ°Ô∏è Por que isso importa para o Blue Team?

- Monitorar **logons suspeitos**, escaladas de privil√©gio e uso do sudo  
- Detectar **cria√ß√µes de usu√°rios, servi√ßos ou processos an√¥malos**  
- Verificar **tentativas de brute-force**, malware persistente e atividades fora do hor√°rio normal  
- Correlacionar logs entre Windows e Linux para detectar **movimenta√ß√£o lateral**  


## üß∞ Ferramentas √∫teis para an√°lise de logs

- **Windows:** Event Viewer, PowerShell, EventLog Explorer, Log Parser  
- **Linux:** journalctl, grep, ausearch, Logwatch  
- **SIEMs:** Splunk, ELK, Wazuh, Sentinel (para ingest√£o e an√°lise centralizada)


## üß† Dica pr√°tica

Crie um **checklist de eventos cr√≠ticos** para monitorar em cada sistema e aplique filtros regulares para identificar padr√µes. Isso economiza tempo e aumenta a efic√°cia na detec√ß√£o.

# üîµ 6. Blue Team: Seguran√ßa em Autentica√ß√£o ‚Äì MFA, Hashes, Senhas e Tokens

A **autentica√ß√£o segura** √© uma das primeiras linhas de defesa contra acessos n√£o autorizados. O Blue Team precisa entender profundamente os mecanismos modernos de autentica√ß√£o para proteger usu√°rios, sistemas e redes.

Senhas s√£o como escovas de dentes: pessoais, devem ser trocadas regularmente e nunca compartilhadas.

## üîê O que √© Autentica√ß√£o?

**Autentica√ß√£o** √© o processo de verificar se um usu√°rio ou sistema √© realmente quem diz ser.  
Ela geralmente envolve um ou mais dos seguintes fatores:

- **Algo que voc√™ sabe** ‚Üí senha, PIN  
- **Algo que voc√™ tem** ‚Üí token, celular  
- **Algo que voc√™ √©** ‚Üí biometria  


## üî¢ MFA ‚Äì Autentica√ß√£o Multifator

O **MFA (Multi-Factor Authentication)** adiciona camadas de seguran√ßa exigindo mais de um fator de autentica√ß√£o.

### ‚úÖ Exemplos de MFA:
- Senha + c√≥digo via SMS  
- Senha + token no aplicativo (Google Authenticator, Microsoft Authenticator)  
- PIN + impress√£o digital  

### üéØ Vantagens do MFA:
- Dificulta o uso de credenciais vazadas  
- Reduz risco de ataques por for√ßa bruta  
- Mitiga sequestro de sess√£o e phishing simples  

### ‚ö†Ô∏è Aten√ß√£o:
- SMS como 2FA √© melhor do que nada, mas ainda **vulner√°vel a SIM Swap**  
- Sempre prefira aplicativos de MFA ou chaves FIDO2/YubiKey


## üîë Hashes de Senhas

As senhas **nunca devem ser armazenadas em texto claro**. Elas devem ser convertidas em **hashes**, uma representa√ß√£o criptogr√°fica que n√£o pode ser revertida diretamente.

### üîê O que √© um hash?
Um hash √© o resultado de aplicar uma fun√ß√£o matem√°tica a uma entrada (senha), gerando uma sa√≠da de tamanho fixo.

### üîπ Exemplos de fun√ß√µes de hash:
- **MD5** ‚Äì desatualizado e inseguro  
- **SHA-1** ‚Äì tamb√©m inseguro  
- **SHA-256** ‚Äì mais forte, mas puro ainda n√£o ideal para senhas  
- **bcrypt, scrypt, Argon2** ‚Äì recomendadas para proteger senhas

### ‚ö†Ô∏è Boa pr√°tica:
Sempre aplicar **salting** (adicionar dados √∫nicos √† senha antes de gerar o hash) para evitar ataques com rainbow tables.


## üîê Senhas: Boas Pr√°ticas

- Tamanho m√≠nimo recomendado: **12 caracteres**  
- Evite usar informa√ß√µes pessoais (nome, data, time)  
- Use **gerenciadores de senhas** (Bitwarden, 1Password, KeePass)  
- Nunca reutilize senhas entre sistemas  
- Habilite MFA sempre que poss√≠vel  


## üé´ Tokens de Acesso

Tokens s√£o **credenciais tempor√°rias e controladas**, usadas para autentica√ß√£o e autoriza√ß√£o.

### üîπ Tipos comuns:

| Tipo         | Uso                                 |
|--------------|--------------------------------------|
| **TOTP**     | Token baseado em tempo (Google Auth) |
| **JWT**      | JSON Web Token, comum em APIs        |
| **OAuth2**   | Autoriza√ß√£o delegada (Google Login)  |
| **FIDO2/WebAuthn** | Autentica√ß√£o por chave f√≠sica ou biometria |

### üîê JWT (JSON Web Token):
- Cont√©m: header, payload, signature  
- Usado para autentica√ß√£o em aplica√ß√µes web  
- Deve ser assinado e, idealmente, criptografado  

### ‚ö†Ô∏è Riscos:
- Tokens expostos em URL, console ou header podem ser interceptados  
- Falta de expira√ß√£o ou revoga√ß√£o √© um problema comum  


## üõ°Ô∏è Relev√¢ncia para o Blue Team

- Monitorar **falhas de login repetidas** (brute-force)  
- Detectar **acessos sem MFA** ou **tokens reutilizados**  
- Validar seguran√ßa do armazenamento de senhas  
- Criar **alertas de login suspeito (localiza√ß√£o, hor√°rio, device)**  
- Auxiliar na **educa√ß√£o de usu√°rios** e ado√ß√£o de boas pr√°ticas  


## üß∞ Ferramentas √∫teis

- **Have I Been Pwned** ‚Äì verifica√ß√£o de vazamentos de senha  
- **Authy / Google Authenticator** ‚Äì MFA apps  
- **YubiKey / SoloKey** ‚Äì autentica√ß√£o com chave f√≠sica  
- **Hashcat / John the Ripper** ‚Äì auditoria de hashes (uso √©tico)  
- **Vault / AWS Secrets Manager** ‚Äì gerenciamento de segredos corporativos

# üîµ 7. Blue Team: Tipos de Ataques Comuns ‚Äì Phishing, Malware, Brute-Force e MITM

Todo profissional de Blue Team precisa conhecer os principais **tipos de ataques** utilizados por amea√ßas cibern√©ticas. Reconhecer seus padr√µes e comportamentos √© essencial para **prevenir, detectar e responder** de forma eficaz.

Voc√™ s√≥ pode se defender daquilo que √© capaz de reconhecer.

## üé£ Phishing ‚Äì Engenharia Social Disfar√ßada

O **phishing** √© um dos ataques mais comuns e eficazes. Consiste em **enganar o usu√°rio** para que ele entregue informa√ß√µes confidenciais, como senhas ou dados banc√°rios.

### üìå Caracter√≠sticas:
- E-mails ou mensagens falsas com apar√™ncia leg√≠tima  
- Links que levam a sites clonados (ex: "banc0.com" em vez de "banco.com")  
- Anexos maliciosos (PDFs, Excel com macros, etc.)

### üîç Como detectar:
- Erros de ortografia e dom√≠nio estranho  
- Solicita√ß√µes urgentes ou amea√ßadoras  
- Arquivos suspeitos anexados

### üõ°Ô∏è Defesa Blue Team:
- Filtros de e-mail (SPF, DKIM, DMARC)  
- Treinamento de usu√°rios  
- Sandboxing de anexos  
- Monitoramento de cliques e redirecionamentos


## ü¶† Malware ‚Äì Software Malicioso

O **malware** √© qualquer programa criado com a inten√ß√£o de causar dano ou obter acesso n√£o autorizado a sistemas.

### üß© Tipos comuns:
- **Ransomware:** criptografa arquivos e exige resgate  
- **Spyware:** coleta informa√ß√µes sem consentimento  
- **Trojans:** disfar√ßado como software leg√≠timo  
- **Worms:** se replicam pela rede  
- **Rootkits:** ocultam presen√ßa de atacantes  

### üõ°Ô∏è Defesa Blue Team:
- EDR com detec√ß√£o comportamental  
- Lista de bloqueio (blacklist) de hashes e dom√≠nios  
- An√°lise de IOC (hashes, conex√µes, artefatos)  
- Monitoramento de cria√ß√£o de processos e servi√ßos (Windows ID 4688)


## üîê Brute-Force ‚Äì Adivinhando Senhas

Ataques de for√ßa bruta consistem em **tentar v√°rias combina√ß√µes de senha** at√© acertar a correta. Variantes incluem:

- **Ataque direto:** tenta muitas senhas em um mesmo login  
- **Ataque de dicion√°rio:** usa listas comuns de senhas  
- **Credential stuffing:** tenta combina√ß√µes vazadas de outros servi√ßos  

### üîç Ind√≠cios em logs:
- M√∫ltiplas tentativas de login falhadas (Windows Event 4625)  
- V√°rios IPs tentando logar em um mesmo usu√°rio  
- Tentativas fora do hor√°rio habitual  

### üõ°Ô∏è Defesa Blue Team:
- MFA obrigat√≥rio  
- Limita√ß√£o de tentativas (lockout tempor√°rio)  
- Monitoramento e alerta de comportamento an√¥malo  
- Regras de detec√ß√£o em SIEM (por IP, por usu√°rio, por hora)


## üïµÔ∏è MITM ‚Äì Man-in-the-Middle

No **MITM (homem-no-meio)**, o atacante intercepta a comunica√ß√£o entre duas partes para roubar dados, redirecionar tr√°fego ou modificar conte√∫do.

### üéØ Exemplos:
- Captura de tr√°fego em redes Wi-Fi p√∫blicas  
- DNS spoofing (redireciona sites leg√≠timos para falsos)  
- SSL stripping (remove criptografia HTTPS)

### üõ°Ô∏è Defesa Blue Team:
- Encripta√ß√£o forte de ponta a ponta (HTTPS, TLS)  
- DNSSEC e HSTS nos servi√ßos da empresa  
- Certificados digitais v√°lidos e monitorados  
- Monitoramento de certificados suspeitos e certificados wildcard fora do padr√£o


## üîÑ Conclus√£o

Compreender esses ataques √© o primeiro passo para montar **controles, alertas e respostas eficientes**. O Blue Team atua de forma proativa e reativa para conter e impedir esses vetores de ataque.


## üß† Dica pr√°tica:

Crie uma **matriz de amea√ßas** no seu ambiente listando:

- Vetores mais comuns (e-mail, web, rede, endpoint)  
- Tipos de ataques associados  
- Controles j√° existentes e lacunas  
- IOCs e exemplos reais para treinar detec√ß√£o



# üîµ Blue Team: Ciclo de Resposta a Incidentes ‚Äì NIST 800-61

A Resposta a Incidentes √© um dos pilares do trabalho de um Blue Team. O guia **NIST SP 800-61 Revision 2**, publicado pelo *National Institute of Standards and Technology (NIST)*, fornece uma estrutura robusta e amplamente utilizada para gerenciar e responder a incidentes de seguran√ßa da informa√ß√£o.

Esse ciclo ajuda equipes de SOC, CSIRT e Blue Team a se prepararem, identificarem e lidarem com amea√ßas de forma sistem√°tica.

Responder a incidentes sem preparo √© como apagar inc√™ndios com os olhos vendados.

---

## üß≠ As 4 Fases da Resposta a Incidentes (segundo o NIST 800-61)

---

## 1. üß∞ Prepara√ß√£o (Preparation)

Nesta fase, a organiza√ß√£o toma medidas **antes de qualquer incidente ocorrer** para garantir uma resposta eficiente.

### A√ß√µes comuns:
- Cria√ß√£o de um plano de resposta a incidentes (PRI)
- Defini√ß√£o de equipe respons√°vel (SOC, CSIRT)
- Treinamentos e simula√ß√µes (tabletops, red team)
- Invent√°rio de ativos cr√≠ticos
- Implementa√ß√£o de ferramentas (SIEM, EDR, firewall)
- Defini√ß√£o de canais de comunica√ß√£o

> **Objetivo:** estar pronto para reagir com rapidez e efici√™ncia.

---

## 2. üîç Detec√ß√£o e An√°lise (Detection and Analysis)

Esta fase inicia quando **um evento suspeito √© detectado**. Nem todo evento √© um incidente, por isso √© necess√°rio fazer triagem e an√°lise.

### Fontes de detec√ß√£o:
- Alertas do SIEM
- Logs de sistema (Windows, Linux, AD)
- Ferramentas de monitoramento (IDS, EDR, AV)
- Relatos de usu√°rios
- Threat intelligence (feeds de IOC)

### A√ß√µes:
- Validar se o evento √© um incidente
- Classificar o tipo (malware, acesso indevido, nega√ß√£o de servi√ßo, etc.)
- Medir impacto e escopo
- Priorizar e documentar

> **Objetivo:** confirmar o incidente e entender sua gravidade.

---

## 3. üõ°Ô∏è Conten√ß√£o, Erradica√ß√£o e Recupera√ß√£o (Containment, Eradication, and Recovery)

Ap√≥s a confirma√ß√£o, o time deve **conter os danos**, **remover o agente da amea√ßa** e **restaurar os sistemas afetados**.

### Conten√ß√£o:
- Isolar a m√°quina comprometida
- Desativar contas suspeitas
- Bloquear IPs/dom√≠nios maliciosos

### Erradica√ß√£o:
- Remover malware
- Corrigir vulnerabilidades exploradas
- Aplicar patches de seguran√ßa

### Recupera√ß√£o:
- Restaurar sistemas a partir de backups
- Verificar a integridade de arquivos
- Monitorar o ambiente ap√≥s o incidente

> **Objetivo:** minimizar o impacto, remover a amea√ßa e restaurar a normalidade.

---

## 4. üìò P√≥s-Incidente (Post-Incident Activity)

Ap√≥s o incidente, √© fundamental **aprender com o ocorrido** para evitar recorr√™ncias.

### A√ß√µes:
- Conduzir li√ß√µes aprendidas (post-mortem)
- Atualizar procedimentos e pol√≠ticas
- Melhorar ferramentas e regras do SIEM
- Treinar equipes com base no caso
- Reportar √†s partes interessadas

> **Objetivo:** fortalecer a maturidade da seguran√ßa e prevenir reincid√™ncia.

---

## üìå Import√¢ncia para o Blue Team

A ado√ß√£o do NIST 800-61 permite que o Blue Team:

- Tenha processos claros e padronizados
- Responda rapidamente com a√ß√µes coordenadas
- Melhore continuamente sua defesa
- Ganhe respaldo em auditorias e conformidade (ex: LGPD, ISO 27001)

---

## üß† Dica pr√°tica:

Monte **playbooks de resposta a incidentes** com base nesse ciclo, contendo:

- Tipo de incidente
- A√ß√µes passo a passo
- Ponto de contato (POC)
- Evid√™ncias a serem coletadas
- Ferramentas a utilizar

# üîµ Blue Team: IOC ‚Äì O que s√£o e como detectar

Um dos pilares da an√°lise de amea√ßas e resposta a incidentes no Blue Team √© o uso de **IOCs ‚Äì Indicators of Compromise**. Eles ajudam a **identificar sinais de que uma m√°quina, rede ou conta pode ter sido comprometida**.

Dominar o conceito de IOC e como us√°-los em ferramentas como SIEM, EDR ou antiv√≠rus √© essencial para detectar ataques em seus est√°gios iniciais.

Cada IOC √© como uma pegada na cena do crime ‚Äì siga as pegadas e voc√™ encontrar√° o invasor.

---

## üìå O que s√£o IOCs?

**IOC (Indicator of Compromise)** √© qualquer evid√™ncia digital que indica que **uma amea√ßa pode ter atuado ou estar atuando** em um sistema ou rede.

Eles s√£o usados para **detec√ß√£o**, **correla√ß√£o** e **resposta a incidentes**, servindo como uma trilha de pistas deixada por atacantes.

---

## üìÇ Tipos comuns de IOCs

| Tipo               | Exemplo                                         |
|--------------------|-------------------------------------------------|
| Hashes de arquivos | `MD5`, `SHA256` de malware ou arquivos alterados |
| Endere√ßos IP       | IPs maliciosos usados em ataques ou C2          |
| Dom√≠nios/URLs      | Dom√≠nios usados para phishing ou C2             |
| Nomes de arquivos  | `invoice.exe`, `payload.docm`                   |
| Strings de logs    | "powershell -enc", "cmd /c net user hacker"     |
| Chaves de Registro | Persist√™ncia maliciosa no Windows               |
| Processos suspeitos| Execu√ß√µes fora do padr√£o (`regsvr32`, `certutil`)|
| Artefatos de mem√≥ria | DLLs injetadas, beaconing, mutexes            |

---

## üß† Como os IOCs s√£o usados?

1. **Detec√ß√£o preventiva:** o SIEM ou EDR alerta quando um IOC conhecido aparece no ambiente  
2. **Hunting (ca√ßa a amea√ßas):** busca ativa por IOCs em logs hist√≥ricos  
3. **Correla√ß√µes:** IOCs relacionados a comportamentos an√¥malos ajudam a confirmar ataques  
4. **Restri√ß√µes autom√°ticas:** bloqueio de IPs/dom√≠nios via firewall ou DNS  
5. **Resposta r√°pida:** uso de listas para isolar ativos, usu√°rios ou sess√µes

---

## üîç Como detectar IOCs em ferramentas de seguran√ßa

### 1. SIEM (ex: Splunk, ELK, QRadar)

```splunk
index=windows process_name="certutil.exe"
```

```splunk
index=dns query="malicious-domain.com"
```

### 2. EDR (ex: CrowdStrike, SentinelOne)

- Detecta e alerta em tempo real o uso de comandos suspeitos ou arquivos com hash malicioso  
- Permite hunting por IOC e isolamento de endpoints

### 3. Threat Intelligence Feeds

Voc√™ pode integrar listas externas (feeds) com o SIEM para correlacionar eventos automaticamente:

- AlienVault OTX  
- MISP  
- Abuse.ch  
- Open Threat Exchange  
- Feeds privados ou comerciais

---

## üß™ Exemplo pr√°tico de hunting com IOC

**IOC:** IP malicioso `185.100.87.84`

**Busca no SIEM:**

```splunk
index=firewall src_ip="185.100.87.84"
```

**IOC:** Hash SHA256 de malware

```splunk
index=edr file_hash="a7c5f7df123456..."
```

**IOC:** Execu√ß√£o de PowerShell com base64

```splunk
index=sysmon process_name="powershell.exe" CommandLine="*base64*"
```

---

## ‚ö†Ô∏è Limita√ß√µes dos IOCs

- **S√£o est√°ticos**: atacantes podem mudar facilmente dom√≠nios e IPs  
- **F√°ceis de evadir**: pequenas altera√ß√µes em malware geram hashes diferentes  
- **Melhor usados com contexto**: IOCs sozinhos nem sempre provam uma invas√£o

> Por isso, use IOCs junto com **an√°lise comportamental (UEBA)** e **detec√ß√£o por heur√≠stica**.

---

## ‚úÖ Conclus√£o

IOCs s√£o ferramentas valiosas de detec√ß√£o e resposta, mas devem ser **tratados como pistas, n√£o como provas absolutas**. Um analista de Blue Team eficaz usa IOCs como parte de um arsenal maior que inclui:

- Telemetria de endpoint  
- Logs de rede e autentica√ß√£o  
- Threat hunting manual  
- Correla√ß√£o com outros indicadores

# üîµ Blue Team: MITRE ATT&CK Framework ‚Äì T√©cnicas e T√°ticas

O **MITRE ATT&CK** √© um framework amplamente adotado no mundo da seguran√ßa da informa√ß√£o. Ele documenta **t√°ticas, t√©cnicas e procedimentos (TTPs)** usados por atacantes reais em fases de um ataque.

Para o Blue Team, o ATT&CK serve como um **mapa de comportamento advers√°rio** que pode ser usado para detec√ß√£o, correla√ß√£o, hunting e melhoria cont√≠nua das defesas.

Quem conhece o inimigo, n√£o ser√° surpreendido. Quem conhece seu pr√≥prio ambiente, j√° venceu metade da batalha.

---

## üß© O que √© o MITRE ATT&CK?

- Criado pela MITRE Corporation  
- Baseado em observa√ß√µes do mundo real  
- Organizado por **t√°ticas** (objetivos do atacante) e **t√©cnicas** (como o atacante alcan√ßa esses objetivos)  
- Dispon√≠vel para sistemas corporativos, nuvem, mobile e ICS

---

## üß≠ Estrutura do framework

O ATT&CK √© dividido em:

### üìå T√°ticas  
S√£o **as metas do atacante em cada fase do ataque**, como:

| T√°tica                    | Descri√ß√£o                                |
|---------------------------|--------------------------------------------|
| Initial Access            | Como o atacante entra no sistema           |
| Execution                 | Como ele executa c√≥digo malicioso          |
| Persistence               | Como mant√©m o acesso                       |
| Privilege Escalation      | Como eleva privil√©gios                     |
| Defense Evasion           | Como evita ser detectado                   |
| Credential Access         | Roubo de credenciais                       |
| Discovery                 | Coleta de informa√ß√µes sobre o ambiente     |
| Lateral Movement          | Movimenta√ß√£o lateral na rede               |
| Collection                | Coleta de dados                            |
| Exfiltration              | Extra√ß√£o de dados                          |
| Command and Control (C2)  | Comunica√ß√£o com servidores do atacante     |

Cada t√°tica cont√©m **v√°rias t√©cnicas** e at√© **subt√©cnicas**.

---

## üõ†Ô∏è Exemplo pr√°tico de t√°tica + t√©cnica

### üéØ T√°tica: Execution  
**Objetivo:** executar c√≥digo malicioso ap√≥s acesso.

### T√©cnica: T1059 ‚Äì Command and Scripting Interpreter  
Exemplos: `powershell`, `bash`, `cmd`, `python`, `wscript`

```splunk
index=sysmon EventCode=1 CommandLine="powershell*"
```

---

## üìä Como o Blue Team usa o ATT&CK?

- **Mapeamento de detec√ß√µes:** quais t√©cnicas seu SIEM j√° cobre?  
- **Gap analysis:** identificar o que **n√£o** est√° sendo monitorado  
- **Hunting guiado:** buscar por comportamentos advers√°rios com base nas t√©cnicas  
- **Resposta a incidentes:** entender as fases e poss√≠veis movimentos do atacante  
- **Simula√ß√µes:** simular t√©cnicas para testar defesas (ex: red team)

---

## üîç Ferramentas de apoio

- [attack.mitre.org](https://attack.mitre.org) ‚Äì consulta oficial  
- MITRE Navigator ‚Äì mapa visual das detec√ß√µes e coberturas  
- Sigma Rules ‚Äì regras SIEM alinhadas ao ATT&CK  
- Atomic Red Team ‚Äì simula√ß√£o de t√©cnicas espec√≠ficas  
- Caldera (MITRE) ‚Äì automa√ß√£o de adversarial em laborat√≥rio

---

## üìò Exemplo de uso em uma investiga√ß√£o

Suponha que voc√™ detecte a execu√ß√£o de `mshta.exe` com uma URL remota:

- T√°tica: **Execution**  
- T√©cnica: **T1218.005 ‚Äì Mshta** (Signed Binary Proxy Execution)

```splunk
index=windows EventCode=4688 NewProcessName="*mshta.exe" CommandLine="*http*"
```

O Blue Team pode buscar por esse IOC e correlacionar com outros como conex√µes DNS, C2 e coleta de dados para prever o pr√≥ximo passo.

---

## üß† Dica pr√°tica

Monte uma **matriz personalizada ATT&CK** para sua empresa:

- Relacione t√©cnicas relevantes para seu setor (ex: sa√∫de, financeiro, OT)  
- Classifique quais j√° t√™m detec√ß√£o (verde), quais est√£o em desenvolvimento (amarelo), e quais n√£o cobrem (vermelho)  
- Atualize a cada nova vers√£o do ATT&CK (lan√ßada semestralmente)

---

## ‚úÖ Conclus√£o

O MITRE ATT&CK transforma o trabalho do Blue Team de **reativo para proativo**, permitindo que a equipe antecipe movimentos advers√°rios, melhore sua postura defensiva e direcione esfor√ßos para √°reas mais cr√≠ticas.

# üîµ Blue Team: Introdu√ß√£o ao Threat Hunting

**Threat Hunting**, ou **ca√ßa a amea√ßas**, √© uma abordagem proativa na seguran√ßa cibern√©tica, onde analistas buscam evid√™ncias de amea√ßas que conseguiram passar pelas defesas automatizadas como antiv√≠rus, firewalls e SIEM.

Ao inv√©s de esperar por alertas, o ca√ßador de amea√ßas analisa dados, comportamentos e hip√≥teses com base em intelig√™ncia e anomalias. √â uma pr√°tica essencial para equipes de **Blue Team mais maduras**.

Ca√ßar amea√ßas √© buscar o invis√≠vel antes que ele se torne inevit√°vel.

---

## üß† O que √© Threat Hunting?

Threat Hunting √© o processo de **buscar ativamente sinais de intrus√£o** em ambientes, mesmo na aus√™ncia de alertas. A ideia central √©:  
> "Assuma que voc√™ j√° foi comprometido."

O ca√ßador de amea√ßas utiliza logs, telemetria, intelig√™ncia de amea√ßas (TI) e contexto para identificar **atividades suspeitas ou maliciosas** que passaram despercebidas.

---

## üîç Por que fazer Threat Hunting?

- Identificar ataques em est√°gios iniciais  
- Descobrir amea√ßas sem gerar alertas (fileless, living off the land)  
- Testar hip√≥teses e validar a efic√°cia das defesas  
- Melhorar regras do SIEM e EDR  
- Desenvolver intelig√™ncia pr√≥pria da organiza√ß√£o

---

## üõ†Ô∏è Fontes de dados comuns

- Sysmon (eventos de processo, rede, DLLs, etc.)  
- DNS logs (consultas de dom√≠nios)  
- Logs de proxy (URLs acessadas)  
- Active Directory (cria√ß√£o de contas, grupos, etc.)  
- Firewall (tr√°fego interno/externo)  
- EDR (telemetria detalhada dos endpoints)

---

## üìò Tipos de abordagem

### 1. **Based on Hypothesis (baseado em hip√≥tese)**  
Inicia com uma hip√≥tese, geralmente baseada em TTPs ou intelig√™ncia:

> *"E se um atacante estiver usando PowerShell com base64 para manter persist√™ncia?"*

```splunk
index=sysmon EventCode=1 CommandLine="*powershell*" CommandLine="*base64*"
```

### 2. **IOC-based Hunting (baseado em indicadores)**  
Busca por indicadores de amea√ßa (hash, IP, dom√≠nio) a partir de feeds ou relat√≥rios.

```splunk
index=firewall src_ip="185.100.87.84"
```

### 3. **Analytics-Driven Hunting (baseado em an√°lise de comportamento)**  
Identifica anomalias nos dados, como processos incomuns, picos de atividade ou movimenta√ß√µes laterais.

```splunk
index=sysmon EventCode=3
| stats count by dest_ip, user
| where count > 50
```

---

## üìä Ferramentas √∫teis

- SIEM (Splunk, ELK, QRadar)  
- EDRs (CrowdStrike, SentinelOne, Defender)  
- MITRE ATT&CK (para mapear t√©cnicas)  
- Sigma Rules (regras hunting compat√≠veis com SIEM)  
- Velociraptor, Kusto, LimaCharlie, KAPE (para forense e coleta)

---

## üß† Dica de Hunting b√°sico

> Hip√≥tese: "Usu√°rios executando scripts do Office para baixar payloads maliciosos"

Busca:

```splunk
index=sysmon EventCode=1 ParentImage="*winword.exe" CommandLine="*http*"
```

---

## üß© Integra√ß√£o com MITRE ATT&CK

Cada hunt pode ser mapeada a uma **t√°tica/t√©cnica** do ATT&CK, por exemplo:

- T1059 ‚Äì Command and Scripting Interpreter  
- T1218 ‚Äì Signed Binary Proxy Execution  
- T1086 ‚Äì PowerShell  
- T1204 ‚Äì User Execution

Isso ajuda a **padronizar** e **documentar** os hunts para reuso e melhoria cont√≠nua.

---

## ‚úÖ Conclus√£o

Threat Hunting √© essencial para:

- Descobrir amea√ßas avan√ßadas  
- Aprimorar defesas e regras de detec√ß√£o  
- Reduzir o tempo m√©dio de detec√ß√£o (MTTD)  
- Antecipar movimentos do atacante

Com o tempo, o ca√ßador se torna **um analista estrat√©gico**, ajudando a construir resili√™ncia cibern√©tica.

# üîµ Blue Team: Introdu√ß√£o ao Threat Hunting

**Threat Hunting**, ou **ca√ßa a amea√ßas**, √© uma abordagem proativa na seguran√ßa cibern√©tica, onde analistas buscam evid√™ncias de amea√ßas que conseguiram passar pelas defesas automatizadas como antiv√≠rus, firewalls e SIEM.

Ao inv√©s de esperar por alertas, o ca√ßador de amea√ßas analisa dados, comportamentos e hip√≥teses com base em intelig√™ncia e anomalias. √â uma pr√°tica essencial para equipes de **Blue Team mais maduras**.

Ca√ßar amea√ßas √© buscar o invis√≠vel antes que ele se torne inevit√°vel.

---

## üß† O que √© Threat Hunting?

Threat Hunting √© o processo de **buscar ativamente sinais de intrus√£o** em ambientes, mesmo na aus√™ncia de alertas. A ideia central √©:  
> "Assuma que voc√™ j√° foi comprometido."

O ca√ßador de amea√ßas utiliza logs, telemetria, intelig√™ncia de amea√ßas (TI) e contexto para identificar **atividades suspeitas ou maliciosas** que passaram despercebidas.

---

## üîç Por que fazer Threat Hunting?

- Identificar ataques em est√°gios iniciais  
- Descobrir amea√ßas sem gerar alertas (fileless, living off the land)  
- Testar hip√≥teses e validar a efic√°cia das defesas  
- Melhorar regras do SIEM e EDR  
- Desenvolver intelig√™ncia pr√≥pria da organiza√ß√£o

---

## üõ†Ô∏è Fontes de dados comuns

- Sysmon (eventos de processo, rede, DLLs, etc.)  
- DNS logs (consultas de dom√≠nios)  
- Logs de proxy (URLs acessadas)  
- Active Directory (cria√ß√£o de contas, grupos, etc.)  
- Firewall (tr√°fego interno/externo)  
- EDR (telemetria detalhada dos endpoints)

---

## üìò Tipos de abordagem

### 1. **Based on Hypothesis (baseado em hip√≥tese)**  
Inicia com uma hip√≥tese, geralmente baseada em TTPs ou intelig√™ncia:

> *"E se um atacante estiver usando PowerShell com base64 para manter persist√™ncia?"*

```splunk
index=sysmon EventCode=1 CommandLine="*powershell*" CommandLine="*base64*"
```

### 2. **IOC-based Hunting (baseado em indicadores)**  
Busca por indicadores de amea√ßa (hash, IP, dom√≠nio) a partir de feeds ou relat√≥rios.

```splunk
index=firewall src_ip="185.100.87.84"
```

### 3. **Analytics-Driven Hunting (baseado em an√°lise de comportamento)**  
Identifica anomalias nos dados, como processos incomuns, picos de atividade ou movimenta√ß√µes laterais.

```splunk
index=sysmon EventCode=3
| stats count by dest_ip, user
| where count > 50
```

---

## üìä Ferramentas √∫teis

- SIEM (Splunk, ELK, QRadar)  
- EDRs (CrowdStrike, SentinelOne, Defender)  
- MITRE ATT&CK (para mapear t√©cnicas)  
- Sigma Rules (regras hunting compat√≠veis com SIEM)  
- Velociraptor, Kusto, LimaCharlie, KAPE (para forense e coleta)

---

## üß† Dica de Hunting b√°sico

> Hip√≥tese: "Usu√°rios executando scripts do Office para baixar payloads maliciosos"

Busca:

```splunk
index=sysmon EventCode=1 ParentImage="*winword.exe" CommandLine="*http*"
```

---

## üß© Integra√ß√£o com MITRE ATT&CK

Cada hunt pode ser mapeada a uma **t√°tica/t√©cnica** do ATT&CK, por exemplo:

- T1059 ‚Äì Command and Scripting Interpreter  
- T1218 ‚Äì Signed Binary Proxy Execution  
- T1086 ‚Äì PowerShell  
- T1204 ‚Äì User Execution

Isso ajuda a **padronizar** e **documentar** os hunts para reuso e melhoria cont√≠nua.

---

## ‚úÖ Conclus√£o

Threat Hunting √© essencial para:

- Descobrir amea√ßas avan√ßadas  
- Aprimorar defesas e regras de detec√ß√£o  
- Reduzir o tempo m√©dio de detec√ß√£o (MTTD)  
- Antecipar movimentos do atacante

Com o tempo, o ca√ßador se torna **um analista estrat√©gico**, ajudando a construir resili√™ncia cibern√©tica.

---

# üßÖ Blue Team: Instalar e Configurar Security Onion em uma VM

**Security Onion** √© uma distribui√ß√£o Linux baseada em Ubuntu voltada para **monitoramento, detec√ß√£o e resposta a incidentes**. Ela integra ferramentas como Zeek, Suricata, Wazuh, TheHive, Kibana, Elasticsearch e muito mais ‚Äì tudo pronto para uso por Blue Teams.

Instalar o Security Onion em uma VM √© a melhor forma de montar seu **lab de SOC caseiro** e come√ßar a aprender an√°lise de tr√°fego, eventos e alertas reais.

Se voc√™ quer aprender Blue Team de verdade, comece onde as amea√ßas chegam: nos logs e pacotes.

---

## üõ†Ô∏è Pr√©-requisitos

- **VirtualBox ou VMware Workstation**  
- Pelo menos **8 GB de RAM** (recomendado 12 GB)  
- **2 CPUs ou mais**  
- Disco de **m√≠nimo 100 GB**  
- ISO do [Security Onion](https://securityonion.net/)  
- Conex√£o de rede em modo **Bridged** ou **Host-only** (para an√°lise de tr√°fego externo ou simulado)

---

## üì¶ Passo a passo de instala√ß√£o

### 1. üîΩ Baixar o ISO

Acesse:  
https://securityonion.net/download

Baixe a ISO mais recente (ex: `securityonion-2.4.x.iso`)

---

### 2. üñ•Ô∏è Criar uma VM

- Sistema: Linux > Ubuntu (64-bit)  
- CPU: 2 ou mais  
- RAM: 8 a 16 GB  
- Disco: 100 GB (dinamicamente alocado)  
- Placa de rede: **Bridged Adapter** ou **Host-only Adapter**

---

### 3. üîß Iniciar instala√ß√£o

- Monte a ISO como CD  
- Boot pela ISO  
- Escolha a op√ß√£o **Install Security Onion 2.4**  
- Siga as instru√ß√µes de instala√ß√£o como em qualquer Ubuntu Server

---

## ‚öôÔ∏è Configurar o Security Onion ap√≥s instala√ß√£o

Ap√≥s o primeiro boot, voc√™ ver√° uma tela para iniciar a **configura√ß√£o inicial**:

### 1. üì° Escolha do modo de instala√ß√£o

Security Onion oferece 3 modos principais:

| Modo       | Descri√ß√£o                              |
|------------|------------------------------------------|
| Standalone | Tudo em uma √∫nica VM                    |
| Evaluation | Ideal para testes; menos recursos       |
| Distributed| Dividido entre sensores, manager, etc. |

**Escolha `Standalone` ou `Evaluation` para labs.**

---

### 2. üìçConfigura√ß√µes b√°sicas

Voc√™ ser√° guiado por um script de configura√ß√£o (`so-setup`):

- Nome do sensor  
- IP da m√°quina  
- Interface de monitoramento (ex: `eth1`)  
- Interface de gerenciamento (ex: `eth0`)  
- Senha do administrador  
- Ativar Elastic Stack, Suricata, Zeek, etc.

---

### 3. ‚è≥ Aguardar instala√ß√£o dos componentes

O sistema ir√° instalar todos os containers e servi√ßos via Docker. Isso pode levar **15‚Äì30 minutos** dependendo da m√°quina.

---

## üîì Acessar a interface web

Abra o navegador e acesse:

```text
https://<ip_da_vm>

Credenciais:

- Usu√°rio: `admin`  
- Senha: definida durante a instala√ß√£o

Voc√™ ter√° acesso ao **Security Onion Console (SOC)**, com pain√©is como:

- **Alerts** (Suricata, Zeek, etc.)  
- **Hunt** (busca por logs)  
- **PCAPs**  
- **Cases (TheHive)**  
- **Dashboards (Kibana)**

---

## üß™ Testar ingest√£o de tr√°fego

Voc√™ pode simular tr√°fego para testar detec√ß√µes:

1. **Ping ou curl em dom√≠nios externos**  
2. **Usar Kali Linux na mesma rede e rodar scripts (ex: nmap)**  
3. **Gerar logs com ferramentas como [Invoke-AtomicRedTeam](https://github.com/redcanaryco/invoke-atomicredteam)**  
4. **Usar scripts como `wget http://testmyids.com` para simular alertas**

---

## üìå Dicas finais

- Use **Snapshots da VM** antes de altera√ß√µes maiores  
- Monitore o uso de disco/RAM ‚Äî pode crescer r√°pido  
- Estude os logs em `/opt/so/logs/` para entender o backend  
- Explore os dashboards e detec√ß√µes no Kibana  
- Configure outra VM como **target** para testes realistas (ex: Windows com Sysmon)

---

## ‚úÖ Conclus√£o

Instalar o Security Onion em uma VM √© um excelente primeiro passo para:

- Criar um laborat√≥rio SOC funcional  
- Estudar an√°lise de tr√°fego e eventos reais  
- Aprender como funcionam ferramentas como Zeek, Suricata, Elastic, TheHive

# üéØ Blue Team: Simular Ataque com Logs Falsos e Analisar no SIEM

Simular ataques com **logs falsos** √© uma das melhores formas de treinar equipes de Blue Team em um ambiente controlado. Com isso, √© poss√≠vel validar regras de detec√ß√£o, visualizar eventos no SIEM e praticar investiga√ß√µes sem comprometer ambientes reais.

Neste guia, voc√™ aprender√° a criar logs simulados, injet√°-los no SIEM (ex: ELK Stack) e analis√°-los como se fosse um incidente real.

Quem treina no simulado, atua com precis√£o no real.

---

## üéØ Objetivo

- Criar eventos de ataque falsos (simulados)  
- Injetar os logs no SIEM (Kibana/Elasticsearch)  
- Visualizar, buscar e interpretar os eventos  
- Praticar hunting e an√°lise t√°tica

---

## üß™ Cen√°rio simulado: ataque por brute-force

Vamos simular um cen√°rio onde um atacante tenta invadir um servidor por for√ßa bruta (brute-force), gerando m√∫ltiplas tentativas de login com falha.

---

## üóÇÔ∏è 1. Criar os logs falsos

Use um arquivo `.json` ou `.csv` com estrutura parecida com os logs reais.

### üìÅ Exemplo de log simulado (`brute_force.json`):

```json
{
  "timestamp": "2025-06-27T15:42:00Z",
  "event_type": "authentication_failure",
  "username": "admin",
  "src_ip": "185.100.87.84",
  "message": "Falha de login por senha incorreta",
  "system": "ssh",
  "log_level": "warning"
}
```

Copie esse evento v√°rias vezes, variando o hor√°rio ou IP para parecer realista.

---

## üöÄ 2. Injetar logs no ELK (Elasticsearch)

### Op√ß√£o 1: via Logstash

Crie um arquivo de configura√ß√£o Logstash (`logstash-brute.conf`):

```bash
input {
  file {
    path => "/caminho/brute_force.json"
    start_position => "beginning"
    sincedb_path => "/dev/null"
    codec => json
  }
}
filter { }
output {
  elasticsearch {
    hosts => ["http://localhost:9200"]
    index => "brute-simulado"
  }
}
```

Execute:

```bash
logstash -f logstash-brute.conf
```

### Op√ß√£o 2: via script Python com `requests`

```python
import json, requests

with open('brute_force.json') as f:
    data = json.load(f)

r = requests.post('http://localhost:9200/brute-simulado/_doc', json=data)
print(r.status_code)
```

---

## üß† 3. Analisar no Kibana

Acesse:  
http://localhost:5601

1. V√° at√© ‚ÄúDiscover‚Äù  
2. Escolha o √≠ndice `brute-simulado`  
3. Visualize os campos como:
   - `src_ip`  
   - `username`  
   - `event_type`  
   - `message`  

Voc√™ pode usar filtros como:

```kql
event_type : "authentication_failure" AND username : "admin"
```

---

## üîç 4. Simular an√°lise de incidente

### üß© Etapas:

- Identifique IPs com m√∫ltiplas falhas  
- Verifique o hor√°rio e frequ√™ncia  
- Busque por sucesso ap√≥s as falhas (comprometimento?)  
- Verifique se houve movimenta√ß√£o lateral (outros sistemas?)

### üß† Hip√≥tese:

> *O IP `185.100.87.84` tentou invadir via brute-force com a conta "admin".*

---

## üìà 5. Criar visualiza√ß√µes

- **Gr√°fico de falhas por IP**
- **Timeline de tentativas**
- **Mapa de calor por usu√°rio e hor√°rio**

No Kibana, crie dashboards para:

- Eventos por minuto  
- Top IPs de origem  
- Contas mais atacadas  

---

## ‚úÖ Conclus√£o

Simular logs falsos √© uma forma **poderosa, pr√°tica e segura** de treinar an√°lise de incidentes. Com poucos comandos, √© poss√≠vel construir uma rotina de:

- Teste de regras de detec√ß√£o  
- Simula√ß√£o de cen√°rios reais  
- Treinamento de SOC e Blue Team

---

# üß¨ Blue Team: An√°lise de Tr√°fego de Malware com Wireshark (Exemplo: Emotet PCAP)

O Wireshark √© uma das ferramentas mais poderosas para **analisar tr√°fego de rede**. Ao capturar ou abrir um arquivo `.pcap` com tr√°fego malicioso, como o gerado por Emotet, √© poss√≠vel observar cada etapa do comportamento de um malware: infec√ß√£o, comunica√ß√£o com C2, downloads de payloads, entre outros.

Neste m√≥dulo, vamos explorar como analisar um PCAP infectado com **Emotet**, um dos trojans banc√°rios mais sofisticados j√° observados.

Wireshark n√£o mostra apenas pacotes ‚Äì ele revela hist√≥rias que firewalls tentaram esquecer.

---

## üß™ O que √© um PCAP?

PCAP significa **Packet Capture**. √â um arquivo que armazena **todos os pacotes capturados** de uma comunica√ß√£o de rede.

Exemplos de fontes:

- Captura real via Wireshark ou tcpdump  
- Sandbox de malware (ex: Any.Run, MalShare)  
- PCAPs p√∫blicos de reposit√≥rios (ex: Contagio, Malware-Traffic-Analysis.net)

---

## üõ†Ô∏è Ferramentas necess√°rias

- **Wireshark** (https://www.wireshark.org)  
- PCAP de amostra do Emotet (recomendado: [malware-traffic-analysis.net](https://www.malware-traffic-analysis.net))  
- Ambiente isolado (VM, sem rede ativa, se necess√°rio)

---

## üîç Passos para An√°lise no Wireshark

### 1. Abrir o arquivo `.pcap`

```bash
File > Open > emotet-infection-example.pcap
```

### 2. Aplicar filtros para tr√°fego HTTP

```wireshark
http
```

Observe requisi√ß√µes suspeitas como:

- Requisi√ß√µes POST incomuns  
- User-Agent falsificado  
- Dom√≠nios estranhos ou IPs externos diretos  
- Downloads de `.doc`, `.dll`, `.exe`

---

### 3. Filtrar apenas o tr√°fego do host infectado

```wireshark
ip.addr == 192.168.1.101
```

> Substitua pelo IP da m√°quina infectada no cen√°rio simulado.

---

### 4. Identificar beaconing / comunica√ß√£o com C2

```wireshark
tcp.port == 80 || tcp.port == 443
```

Observe conex√µes frequentes para o mesmo IP, tamanho pequeno de pacotes, poss√≠veis padr√µes de periodicidade (indicadores de **beaconing**).

---

### 5. Extrair arquivos maliciosos

Se o malware fez download de arquivos `.exe` ou `.dll`, voc√™ pode export√°-los via:

```text
File > Export Objects > HTTP
```

Salve os arquivos e, se quiser analisar com seguran√ßa, use uma sandbox isolada (como [Hybrid Analysis](https://www.hybrid-analysis.com)).

---

## üß† Indicadores comuns do Emotet

| Tipo         | Exemplo                                       |
|--------------|-----------------------------------------------|
| User-Agent   | `Mozilla/5.0 (Windows NT 10.0...)`             |
| URLs         | `/temp.php`, `/update.php`, `/image.php`      |
| IPs C2       | 45.76.89.103, 185.234.217.101, etc.            |
| Arquivos     | `.doc`, `.xls`, `.exe`                        |
| Padr√µes      | POST sem resposta, beacon a cada X segundos   |

---

## üìà Dicas de an√°lise

- Use a aba **Follow TCP Stream** para ver a comunica√ß√£o completa de um canal  
- Salve partes da comunica√ß√£o para an√°lise em scripts ou SIEM  
- Combine com IOC hunting (IPs, dom√≠nios, hash MD5 dos arquivos exportados)  
- Documente seus achados: tempo, IP, payload, comportamento

---

## üß© Integra√ß√£o com Blue Team

Essa an√°lise complementa:

- Ca√ßa por IOCs no SIEM  
- Regras de bloqueio no firewall/DNS  
- Correla√ß√£o com logs de endpoint  
- Rea√ß√£o em incidentes reais

---

## ‚úÖ Conclus√£o

Analisar um PCAP malicioso como o do Emotet √© uma habilidade essencial para qualquer analista de defesa. Isso permite entender n√£o apenas **como o ataque aconteceu**, mas tamb√©m **como evit√°-lo, detect√°-lo e respond√™-lo** em tempo real.

# üîµ Blue Team: Mini-Hunting com MITRE ATT&CK + ELK Stack

O **Mini-Hunting** √© uma pr√°tica de ca√ßa a amea√ßas focada, onde se utiliza um conjunto limitado de t√©cnicas para detectar comportamentos suspeitos em dados coletados. Combinando o framework **MITRE ATT&CK** e a poderosa plataforma **ELK Stack** (Elasticsearch, Logstash e Kibana), o analista pode realizar buscas eficientes para identificar atividades maliciosas no ambiente.

Ca√ßar amea√ßas √© mais do que reagir ‚Äî √© antecipar os passos do advers√°rio com dados e metodologia.

---

## üéØ Objetivo do Mini-Hunting

- Focar em t√©cnicas espec√≠ficas do MITRE ATT&CK  
- Realizar buscas direcionadas em logs armazenados no Elasticsearch  
- Identificar padr√µes suspeitos com rapidez  
- Validar hip√≥teses simples para investiga√ß√£o inicial  

---

## üîç Passos para realizar Mini-Hunting com ATT&CK + ELK

### 1. Escolha t√©cnicas ATT&CK relevantes

Exemplos para ca√ßa r√°pida:

| T√°tica               | T√©cnica                  | C√≥digo ATT&CK  |
|----------------------|--------------------------|---------------|
| Execution            | PowerShell               | T1059.001     |
| Defense Evasion      | Masquerading             | T1036         |
| Credential Access    | Brute Force              | T1110         |
| Persistence          | Registry Run Keys        | T1547         |

---

### 2. Preparar consultas no Kibana usando DSL Elasticsearch

Exemplo de consulta para detectar execu√ß√£o de PowerShell com comandos codificados:

```json
GET /sysmon-*/_search
{
  "query": {
    "bool": {
      "must": [
        { "match": { "process_name": "powershell.exe" }},
        { "wildcard": { "command_line": "*-enc*" }}
      ]
    }
  }
}
```

---

### 3. Executar buscas e analisar resultados

- Filtrar por eventos com anomalias (comandos codificados, caminhos suspeitos)  
- Observar frequ√™ncia, usu√°rios envolvidos, hor√°rios e endere√ßos IP  
- Correlacionar com outras t√©cnicas para aumentar confian√ßa

---

### 4. Criar visualiza√ß√µes simples no Kibana

- Gr√°fico de barras: n√∫mero de execu√ß√µes PowerShell por usu√°rio  
- Tabela: eventos de cria√ß√£o de chaves de registro (persist√™ncia)  
- Linha do tempo: tentativas de brute-force ao longo do dia

---

### 5. Documentar hip√≥teses e resultados

Registre:

- T√©cnica investigada  
- Query usada  
- Eventos identificados  
- Pr√≥ximos passos para aprofundar ou mitigar

---

## üß† Dicas para Mini-Hunting efetivo

- Comece por t√©cnicas conhecidas que causam impacto alto  
- Use Sigma para criar regras port√°veis e convert√™-las para consultas Elasticsearch  
- Periodicamente atualize as consultas com novas t√©cnicas do ATT&CK  
- Combine dados de endpoints, rede e logs de sistema

---

## ‚úÖ Benef√≠cios do Mini-Hunting com ATT&CK + ELK

- Aumento da visibilidade sem necessidade de alertas complexos  
- Processo r√°pido e focado para triagem inicial  
- Base s√≥lida para escalar para ca√ßas mais detalhadas  
- Facilita alinhamento entre equipe e frameworks reconhecidos

---



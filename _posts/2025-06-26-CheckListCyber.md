---
title: "CheckListCyber"
date: 2025-06-26 16:30:00 -0300
categories: [Blue Team, Nivel 1]
tags: [Teorica]
description: "Profissional em início de carreira, responsável por monitoramento básico, identificação preliminar de ameaças e suporte às operações de segurança. Atua seguindo procedimentos estabelecidos e orientações de profissionais mais experientes, desenvolvendo habilidades técnicas e conhecimento do ambiente de segurança."
image:
  path: /assets/img/PROJsiem.png
  alt: Ilustração de um computador moderno com elementos de código e processamento
---



## Casos de uso SIEM

| CAMADA | NOME DA REGRA | CATEGORIA DA REGRA | DESCRIÇÃO DA REGRA | REGRA PARA WAZUH | AÇÃO RECOMENDADA |
| --- | --- | --- | --- | --- | --- |
| Sysmon | Windows Defender executado de caminho suspeito | Security | Detecta execução do Windows Defender a partir de caminho não padrão, possível carregamento de DLL malicioso. | <rule id="80001" level="10"><field name="data.win.eventdata.Image">*\\Windows Defender\\*</field><description>Windows Defender executado de caminho suspeito.</description></rule> | Investigar execuções fora do caminho padrão; aplicar bloqueios; reforçar monitoramento de execução de antivírus. |
| Sysmon | Arquivo copiado via pscp.exe | Security | Detecta cópia de arquivos via pscp.exe, com possível exfiltração de dados para sistemas remotos via SSH. | <rule id="80002" level="10"><field name="data.win.eventdata.Image">*\\pscp.exe</field><description>Arquivo copiado via pscp.exe detectado.</description></rule> | Auditar transferências SSH; bloquear ferramentas de transferência não autorizadas; aplicar DLP. |
| Sysmon | Powershell deletando arquivos | Security | Detecta comandos do Powershell que apagam arquivos ou diretórios, possível ação de limpeza maliciosa. | <rule id="80003" level="12"><field name="data.win.eventdata.CommandLine">*Remove-Item*</field><description>Powershell deletando arquivos detectado.</description></rule> | Revisar políticas de execução de script; alertar sobre exclusões massivas; aplicar restrições de acesso. |
| Sysmon | Coleta de informações via sessões RDP | Security | Detecta comandos como `query user` usados em sessões RDP para mapear sessões de usuário. | <rule id="80004" level="8"><field name="data.win.eventdata.CommandLine">*query user*</field><description>Coleta de usuário via RDP detectada.</description></rule> | Restringir uso de comandos administrativos; alertar sobre consultas em massa. |
| Sysmon | Powershell com VSS e hive SAM | Security | Detecta uso do Powershell acessando VSS e arquivos do registro como o hive SAM, possível roubo de credenciais. | <rule id="80005" level="15"><field name="data.win.eventdata.CommandLine">*vssadmin* *sam*</field><description>Atividade suspeita Powershell VSS e hive SAM.</description></rule> | Bloquear scripts que acessam VSS; investigar acessos não autorizados. |
| Sysmon | Cópia do hive SAM via Powershell | Security | Detecta comando `Copy-Item` utilizado para copiar o hive SAM a partir de VSS, com foco em dumping de credenciais. | <rule id="80006" level="15"><field name="data.win.eventdata.CommandLine">*Copy-Item* *SAM*</field><description>Powershell copiando hive SAM do VSS.</description></rule> | Monitorar cópias de arquivos sensíveis; auditar acesso ao sistema de backup. |
| Sysmon | Execução do reg.exe | Security | Detecta inicialização do binário reg.exe, usado para manipular o registro do Windows, podendo ser legítimo ou malicioso. | <rule id="80007" level="12"><field name="data.win.eventdata.Image">*\\reg.exe</field><description>Execução do Reg.exe detectada.</description></rule> | Investigar uso fora de horários e perfis esperados; correlacionar com tentativas de dumping. |
| Sysmon | Reg.exe despejando hive SAM | Security | Detecta reg.exe sendo usado com comandos para salvar o hive SAM localmente. | <rule id="80008" level="15"><field name="data.win.eventdata.CommandLine">*save* *SAM*</field><description>Reg.exe despejando hive SAM.</description></rule> | Bloquear exportação de registros críticos; aplicar regras de controle de acesso. |
| Sysmon | Powershell iniciou outro powershell | Security | Detecta powershell como pai de outro powershell, padrão comum em scripts encadeados ou ofuscados. | <rule id="80009" level="10"><field name="data.win.eventdata.ParentImage">*\\powershell.exe</field><field name="data.win.eventdata.Image">*\\powershell.exe</field><description>Powershell invocou outra instância de Powershell.</description></rule> | Auditar scripts; restringir encadeamento de shells. |
| Sysmon | Execução de script Powershell | Security | Detecta execução de arquivos `.ps1` via parâmetro `-File`, indicando scripts automatizados. | <rule id="80010" level="10"><field name="data.win.eventdata.CommandLine">*-File *</field><description>Powershell executou script.</description></rule> | Controlar execução de scripts com GPO; usar whitelist de scripts assinados. |
| Sysmon | Execução de script em local suspeito | Security | Detecta scripts Powershell em diretórios como `Temp`, comum em malwares fileless. | <rule id="80011" level="12"><field name="data.win.eventdata.CommandLine">*\\temp\\*.ps1</field><description>Script Powershell em local suspeito.</description></rule> | Bloquear execução em diretórios temporários; aplicar política de restrição de caminho. |
| Sysmon | Coleta de informações via RDP (repetida) | Security | Detecta novamente coleta de informações com comandos administrativos em sessões RDP. | <rule id="80012" level="8"><field name="data.win.eventdata.CommandLine">*query session*</field><description>Coleta de informações de sessão RDP.</description></rule> | Consolidar alertas similares; aplicar supressão se necessário. |
| Sysmon | Atividade de descoberta executada | Security | Detecta execução de comandos de enumeração de rede, processos, usuários ou domínios. | <rule id="80013" level="10"><field name="data.win.eventdata.CommandLine">*whoami*|*net user*|*tasklist*</field><description>Comando de descoberta executado.</description></rule> | Correlacionar com contexto do host; distinguir administração legítima de atividades suspeitas. |
| Sysmon | Execução suspeita de shell cmd | Security | Detecta inicialização do `cmd.exe`, especialmente se iniciado de fontes não convencionais. | <rule id="80014" level="10"><field name="data.win.eventdata.Image">*\\cmd.exe</field><description>Execução suspeita de shell cmd.</description></rule> | Bloquear shells não autorizados; auditar execuções por usuários não administrativos. |
| Sysmon | Descoberta via Powershell | Security | Detecta comandos Powershell com funções de enumeração (`Get-*`), utilizados em reconhecimento. | <rule id="80015" level="10"><field name="data.win.eventdata.CommandLine">*Get-LocalUser*|*Get-AD*</field><description>Descoberta executada via Powershell.</description></rule> | Restringir módulos de AD para scripts; aplicar monitoração detalhada em estações críticas. |
| Sysmon | Descoberta via cmd.exe | Security | Detecta uso de comandos como `net view`, `ipconfig`, `whoami` por cmd.exe. | <rule id="80016" level="10"><field name="data.win.eventdata.CommandLine">*net view*|*whoami*</field><description>Descoberta executada via cmd.exe.</description></rule> | Correlacionar com contexto de login; identificar padrões repetitivos de enumeração. |
| Sysmon | Binário iniciado por cmd.exe | Security | Detecta binário qualquer sendo iniciado diretamente pelo cmd.exe, típico em execuções encadeadas ou scripts. | <rule id="80017" level="12"><field name="data.win.eventdata.ParentImage">*\\cmd.exe</field><description>Binário iniciado por shell cmd do Windows.</description></rule> | Investigar cadeia de execução; auditar binários invocados diretamente pelo shell. |
| Sysmon | CertUtil.exe usado para decodificar arquivo binário. | Security | Detecta o uso do utilitário CertUtil para decodificar arquivos base64, comportamento comum em técnicas de persistência e exfiltração. | <rule id="8001" level="8"><field name="win.eventdata.image">CertUtil.exe</field><field name="win.eventdata.commandLine">*decode*</field><description>CertUtil usado para decodificar arquivos binários.</description></rule> | Investigar se o uso foi administrativo. Aplicar bloqueio de uso indevido via GPO ou AppLocker. |
| Sysmon | O Windows Defender foi executado de um caminho suspeito, possível carregamento DLL. | Security | Detecta execução do Defender fora do caminho padrão, podendo indicar tentativa de spoofing ou DLL hijacking. | <rule id="8002" level="10"><field name="win.eventdata.image">*\\Windows Defender\\*.exe</field><field name="win.eventdata.originalFileName">MsMpEng.exe</field><description>Windows Defender executado de caminho suspeito.</description></rule> | Verificar hash da execução. Validar assinatura digital. Monitorar persistência. |
| Sysmon | Um arquivo foi copiado para outro sistema via SSH usando pscp.exe. | Change | Detecta uso do utilitário pscp para cópia remota de arquivos, o que pode indicar exfiltração de dados. | <rule id="8003" level="7"><field name="win.eventdata.image">*\\pscp.exe</field><description>Arquivo copiado via pscp.exe.</description></rule> | Auditar uso da ferramenta. Permitir apenas administradores ou automatizações aprovadas. |
| Sysmon | Powershell foi usado para deletar arquivos ou diretórios. | Security | Identifica comando de remoção executado via PowerShell, potencial indicador de atividade maliciosa. | <rule id="8004" level="9"><field name="win.eventdata.commandLine">*Remove-Item*</field><description>Powershell usado para deletar arquivos.</description></rule> | Restringir acesso ao PowerShell. Ativar modo restrito e transcrição de logs. |
| Sysmon | Informações do usuário foram coletadas de sessões do Serviço de Área de Trabalho Remota. | Discovery | Detecta comandos de enumeração de sessão via quser/query user no contexto do RDP. | <rule id="8005" level="8"><field name="win.eventdata.commandLine">*quser*|*query user*</field><description>Coleta de informações de sessões RDP.</description></rule> | Verificar se o usuário é legítimo. Monitorar tentativas correlacionadas com movimentação lateral. |
| Sysmon | Atividade suspeita de Powershell com VSS e o hive SAM do Windows. | Security | Detecta uso do VSS para copiar o SAM, técnica usada para obter senhas. | <rule id="8006" level="10"><field name="win.eventdata.commandLine">*vssadmin*|*copy*|*SAM*</field><description>Uso de VSS com objetivo de copiar hive SAM.</description></rule> | Restringir uso do vssadmin. Monitorar uso fora de janelas de backup. |
| Sysmon | Powershell usado para copiar o hive SAM do VSS. | Security | Detecta comando para copiar arquivos críticos como o SAM, LSA ou SYSTEM de snapshots. | <rule id="8007" level="10"><field name="win.eventdata.commandLine">*copy*SAM*|*SYSTEM*</field><description>Cópia do hive SAM do VSS via Powershell.</description></rule> | Ativar proteção de arquivos críticos e revisar acessos administrativos. |
| Sysmon | Execução do Reg.exe | Change | Monitora execução de utilitário reg.exe, usado para editar o registro do Windows. | <rule id="8008" level="5"><field name="win.eventdata.image">*\\reg.exe</field><description>Execução de reg.exe detectada.</description></rule> | Verificar padrão de uso da ferramenta. Avaliar alteração e origem da execução. |
| Sysmon | Reg.exe usado para despejar o hive SAM | Security | Detecta uso do reg.exe para exportar dados sensíveis do registro. | <rule id="8009" level="10"><field name="win.eventdata.commandLine">*save*SAM*</field><description>reg.exe usado para despejar hive SAM.</description></rule> | Investigar contexto e origem. Monitorar por exportações similares. |
| Sysmon | O processo Powershell gerou uma instância do powershell. | Security | Detecta auto-spawn de powershell, que pode indicar execução obfuscada ou de scripts remotos. | <rule id="8010" level="9"><field name="win.eventdata.parentImage">*powershell.exe</field><field name="win.eventdata.image">*powershell.exe</field><description>Powershell invocando nova instância de powershell.</description></rule> | Verificar se há execução de payloads. Analisar argumentos e origem. |
| Sysmon | Powershell executou um script. | Security | Detecta execução de script via PowerShell, usado em ataques para automatizar ações maliciosas. | <rule id="8011" level="8"><field name="win.eventdata.commandLine">*powershell* -File *</field><description>Powershell executou um script.</description></rule> | Habilitar transcrição de PowerShell e monitorar uso de scripts externos. |
| Sysmon | Powershell executou script de localização suspeita. | Security | Detecta execução de scripts PowerShell a partir de pastas incomuns (ex: Temp, AppData). | <rule id="8012" level="9"><field name="win.eventdata.commandLine">*AppData*\\*.ps1</field><description>Script PowerShell executado de local suspeito.</description></rule> | Aplicar política de execução restrita. Monitorar acesso a diretórios temporários. |
| Sysmon | Informações do usuário foram coletadas de sessões do Serviço de Área de Trabalho Remota. | Discovery | Identificação repetida de enumeração de usuários conectados, possivelmente como reconhecimento. | <rule id="8013" level="7"><field name="win.eventdata.commandLine">*qwinsta*|*query user*</field><description>Coleta de sessões remotas RDP.</description></rule> | Correlacionar com logs de autenticação e uso de ferramentas administrativas. |
| Sysmon | Atividade de descoberta executada. | Discovery | Detecta execução genérica de comandos de enumeração do ambiente, como systeminfo ou net config. | <rule id="8014" level="6"><field name="win.eventdata.commandLine">*systeminfo*|*net config*</field><description>Atividade de descoberta executada.</description></rule> | Monitorar padrão de execução e origem do processo pai. |
| Sysmon | Execução suspeita de shell cmd do Windows. | Security | Identifica execução de cmd.exe por processo não usual ou com parâmetros suspeitos. | <rule id="8015" level="9"><field name="win.eventdata.image">*\\cmd.exe</field><field name="win.eventdata.parentImage">!C:\\Windows\\System32\\*</field><description>Shell cmd executado de forma suspeita.</description></rule> | Validar processo pai. Bloquear uso via políticas de integridade de código. |
| Sysmon | Atividade de descoberta gerada via execução de powershell. | Discovery | Detecta comandos de enumeração como Get-NetUser, Get-NetGroup executados via PowerShell. | <rule id="8016" level="8"><field name="win.eventdata.commandLine">*Get-Net*</field><description>Descoberta via PowerShell.</description></rule> | Auditar instalação de frameworks de ofensiva como PowerView. Monitorar lateral movement. |
| Sysmon | Atividade de descoberta gerada por execução do shell cmd | Discovery | Detecta comandos como net view, net user, ipconfig, via cmd.exe. | <rule id="8017" level="7"><field name="win.eventdata.commandLine">*net view*|*ipconfig*</field><description>Descoberta via cmd.exe.</description></rule> | Relacionar a sessões suspeitas ou fora de horário comercial. |
| Sysmon | Um comando de descoberta de domínio net.exe foi executado | Discovery | Detecta uso de net.exe com argumentos para enumerar o domínio. | <rule id="8018" level="7"><field name="win.eventdata.commandLine">net* domain*</field><description>Comando net.exe para descoberta de domínio.</description></rule> | Validar se foi administrador. Correlacionar com histórico de execução. |
| Sysmon | Um binário $(win.eventdata.image) foi iniciado por um shell cmd do Windows | Security | Detecta execução de binários por cmd.exe, indicando possível abuso de terminal. | <rule id="8019" level="9"><field name="win.eventdata.parentImage">*cmd.exe</field><description>Execução de binário via cmd.exe.</description></rule> | Verificar o binário executado e origem da sessão. |
| Sysmon | Uma conexão net.exe para um recurso remoto foi iniciada por $(win.eventdata.parentImage) | Network | Detecta mapeamento ou uso de compartilhamento remoto com net.exe. | <rule id="8020" level="8"><field name="win.eventdata.commandLine">*net use*</field><description>Conexão remota via net.exe.</description></rule> | Monitorar mapeamento de drives não autorizados. |
| Sysmon | Uma conexão com recurso em nuvem foi iniciada por $(win.eventdata.parentImage) | Network | Detecta acessos ou montagens de pastas em serviços de nuvem via linha de comando. | <rule id="8021" level="8"><field name="win.eventdata.commandLine">*onedrive*|*dropbox*</field><description>Acesso a recurso em nuvem.</description></rule> | Controlar acesso a serviços de nuvem. Verificar movimentação de arquivos. |
| Sysmon | Um comando de descoberta de conta net.exe foi iniciado | Discovery | Detecta uso do net.exe para listar usuários ou grupos. | <rule id="8022" level="7"><field name="win.eventdata.commandLine">net user*</field><description>Descoberta de contas com net.exe.</description></rule> | Verificar padrões de auditoria e perfil do usuário. |
| Sysmon | $(win.eventdata.originalFileName) executou um comando de criação de usuário | Security | Detecta criação de novo usuário via linha de comando, possivelmente persistência. | <rule id="8023" level="10"><field name="win.eventdata.commandLine">net user * /add</field><description>Criação de usuário detectada.</description></rule> | Auditar origem e validar necessidade. Ativar alertas para criação de contas locais. |
| Sysmon | Valor adicionado à chave do registro tem um padrão semelhante ao Base64 | Security | Detecta adição de valor ao registro com conteúdo semelhante a base64, comum em persistência ou exfiltração. | <rule id="8024" level="8"><field name="win.eventdata.details">*[A-Za-z0-9+/=]{20,}*</field><description>Valor no registro com padrão Base64.</description></rule> | Verificar chave modificada. Identificar se valor representa payload ou configuração persistente. |
| Sysmon | Comando Netsh invocado | Change | Detecta uso da ferramenta netsh, usada para manipular configurações de rede e firewall. | <rule id="8025" level="6"><field name="win.eventdata.commandLine">*netsh*</field><description>Netsh invocado.</description></rule> | Auditar uso administrativo. Monitorar por alterações suspeitas em firewall ou proxy. |
| Sysmon | Netsh usado para adicionar regra de firewall | Security | Detecta comando netsh com argumentos que indicam adição de regras no firewall. | <rule id="8026" level="9"><field name="win.eventdata.commandLine">*netsh*firewall*add*</field><description>Netsh adicionando regra de firewall.</description></rule> | Verificar origem e justificativa da alteração. Validar integridade da regra criada. |
| Sysmon | Netsh usado para adicionar regra de firewall referenciando a porta 5900, geralmente usada para VNC | Security | Detecta criação de regra de firewall para porta 5900, possível túnel VNC malicioso. | <rule id="8027" level="10"><field name="win.eventdata.commandLine">*netsh*add*5900*</field><description>Firewall liberando porta 5900 (VNC).</description></rule> | Bloquear uso de VNC não autorizado. Verificar persistência via serviço. |
| Sysmon | Reg.exe modificou o registro usando arquivo .reg em localização suspeita | Security | Detecta execução de reg.exe com argumento para importar chave de local não usual. | <rule id="8028" level="9"><field name="win.eventdata.commandLine">*reg import*AppData*</field><description>reg.exe importando .reg de local suspeito.</description></rule> | Monitorar arquivos .reg em locais não padrões. Bloquear execução via GPO. |
| Sysmon | Possível uso de fodhelper.exe para contornar o UAC e executar software malicioso | Security | Detecta execução do fodhelper.exe com possível uso para bypass de UAC. | <rule id="8029" level="10"><field name="win.eventdata.image">*\\fodhelper.exe</field><description>Possível bypass UAC via fodhelper.</description></rule> | Auditar alterações no registro relacionadas ao fodhelper. Bloquear via AppLocker. |
| Sysmon | Aplicação do Office iniciou mshta.exe | Security | Detecta spawn de mshta.exe a partir de processos do Office, padrão de ataque via macro. | <rule id="8030" level="10"><field name="win.eventdata.parentImage">*\\winword.exe|excel.exe*</field><field name="win.eventdata.image">*\\mshta.exe</field><description>Office invocou mshta.exe.</description></rule> | Bloquear mshta.exe via política. Restringir macros e add-ins desconhecidos. |
| Sysmon | Aplicação do Office iniciou mshta.exe e executou comando de script | Security | Detecta mshta.exe executando comandos, possivelmente via HTA malicioso. | <rule id="8031" level="10"><field name="win.eventdata.commandLine">*mshta*javascript*</field><description>Mshta executando script.</description></rule> | Bloquear mshta. Verificar arquivos temporários HTA. Isolar máquina para análise. |
| Sysmon | Verclsid.exe pode ter sido usado para executar carga útil COM | Security | Detecta execução do verclsid.exe fora de contexto, possível execução de payload COM. | <rule id="8032" level="9"><field name="win.eventdata.image">*verclsid.exe</field><description>Uso suspeito de verclsid.exe.</description></rule> | Correlacionar com processo pai. Verificar comportamento anômalo ou persistência. |
| Sysmon | Aplicação do Office invocou Verclsid.exe, possível execução de carga útil COM | Security | Detecta verclsid.exe iniciado pelo Office, técnica conhecida de execução indireta. | <rule id="8033" level="10"><field name="win.eventdata.parentImage">*winword.exe|excel.exe*</field><field name="win.eventdata.image">*verclsid.exe</field><description>Office iniciou Verclsid.exe.</description></rule> | Rever documentos manipulados. Executar análise estática de arquivos recebidos. |
| Sysmon | Executou uma cópia renomeada do wscript.exe | Security | Detecta execução de wscript.exe com nome alterado, comum em evasão. | <rule id="8034" level="10"><field name="win.eventdata.originalFileName">wscript.exe</field><field name="win.eventdata.image">!*\\wscript.exe</field><description>Wscript renomeado detectado.</description></rule> | Bloquear execução de cópias renomeadas. Monitorar assinatura e hash do binário. |
| Sysmon | Execução de script via wscript em local incomum | Security | Detecta execução de scripts .vbs por wscript.exe em diretórios suspeitos. | <rule id="8035" level="9"><field name="win.eventdata.commandLine">*wscript*AppData*</field><description>Script VBS executado em local suspeito.</description></rule> | Restringir acesso a execução de scripts. Validar conteúdo do VBS. |
| Sysmon | Uso do rundll32 para executar DLL suspeita | Security | Detecta execução de DLL por rundll32 fora do caminho padrão. | <rule id="8036" level="9"><field name="win.eventdata.commandLine">*rundll32.exe*AppData*</field><description>DLL suspeita via rundll32.</description></rule> | Investigar argumentos da DLL. Bloquear locais não confiáveis na política. |
| Sysmon | Rundll32 executando javascript via comsvcs.dll | Security | Detecta técnica de execução de JavaScript via rundll32 e COM. | <rule id="8037" level="10"><field name="win.eventdata.commandLine">*rundll32.exe*comsvcs.dll*</field><description>Execução de JS via comsvcs.dll.</description></rule> | Bloquear comportamento via AppLocker. Correlacionar com download prévio. |
| Sysmon | Execução do script encoded com PowerShell -EncodedCommand | Security | Detecta execução de comandos obfuscados base64 com PowerShell. | <rule id="8038" level="10"><field name="win.eventdata.commandLine">*EncodedCommand*</field><description>PowerShell com comando codificado.</description></rule> | Aplicar logging com desofuscação. Bloquear uso do parâmetro. |
| Sysmon | Uso de PowerShell com Bypass, Hidden ou WindowStyle | Security | Detecta parâmetros que escondem a execução e tentam burlar políticas. | <rule id="8039" level="10"><field name="win.eventdata.commandLine">*bypass*|*hidden*|*WindowStyle*</field><description>PowerShell com parâmetros de evasão.</description></rule> | Revisar contexto. Ativar logs completos e bloquear execuções automatizadas. |
| Sysmon | Uso de bitsadmin para baixar arquivo | Security | Detecta uso do bitsadmin, ferramenta de transferência usada para download de payloads. | <rule id="8040" level="9"><field name="win.eventdata.image">*bitsadmin.exe</field><description>Bitsadmin executando download.</description></rule> | Bloquear ferramenta. Monitorar conexões de saída anômalas. |
| Sysmon | Uso do certreq.exe fora de contexto administrativo | Security | Detecta certreq executando solicitação de certificado, potencial persistência. | <rule id="8041" level="8"><field name="win.eventdata.image">*certreq.exe</field><description>Solicitação de certificado fora de contexto.</description></rule> | Verificar presença de certificados anômalos. Auditoria de Autoridade Certificadora local. |
| Sysmon | Uso do msiexec para execução de payload | Security | Detecta execução de binários maliciosos via msiexec (ex: via URL). | <rule id="8042" level="9"><field name="win.eventdata.commandLine">*msiexec*http*</field><description>Execução via msiexec com URL.</description></rule> | Bloquear instalação remota via política. Monitorar via proxy. |
| Sysmon | Executável foi iniciado com nome similar ao do sistema (ex: svch0st.exe) | Security | Detecta tentativa de camuflagem usando nomes similares aos processos legítimos. | <rule id="8043" level="10"><field name="win.eventdata.image">*svch0st.exe|lsasss.exe*</field><description>Nome de processo similar ao sistema.</description></rule> | Analisar nome, hash e local do binário. Reforçar alertas por typo-squatting. |
| Sysmon | Processo iniciou com nome legítimo, mas sem assinatura digital | Security | Detecta processos com nomes do sistema, mas sem assinatura válida. | <rule id="8044" level="9"><field name="win.eventdata.originalFileName">*svchost.exe*</field><field name="win.eventdata.signatureStatus">Unsigned</field><description>Nome legítimo, mas sem assinatura digital.</description></rule> | Validar assinatura digital em todos os binários críticos. Ativar AppLocker. |
| Sysmon | Serviço foi criado ou modificado fora do contexto administrativo | Security | Detecta criação de novo serviço sem autorização esperada. | <rule id="8045" level="9"><field name="win.eventdata.eventID">7045</field><description>Criação de serviço anômala.</description></rule> | Auditar contas com permissão de criação de serviço. Verificar persistência. |
| Sysmon | Processo tentou injetar código em outro processo (EventID 10) | Security | Detecta tentativa de injeção de código, comum em RATs. | <rule id="8046" level="10"><field name="win.eventdata.eventID">10</field><description>Injeção de código detectada.</description></rule> | Investigar processo origem e destino. Correlacionar com anomalias comportamentais. |
| Sysmon | Imagem de processo foi modificada após execução | Security | Detecta técnica de process hollowing. | <rule id="8047" level="10"><field name="win.eventdata.eventID">1</field><field name="win.eventdata.imageLoaded">!matchOriginal*</field><description>Processo alterado após carregamento.</description></rule> | Monitorar integridade de processos. Reforçar endpoint protection. |
| Sysmon | Conexão de processo com IP externo anômalo | Network | Detecta comunicação com endereço IP fora do escopo corporativo. | <rule id="8048" level="8"><field name="win.eventdata.destinationIp">!192.168.*|10.*|172.16.*</field><description>Conexão externa anômala.</description></rule> | Verificar reputação do IP. Correlacionar com horário de execução. |
| Sysmon | Processo filho iniciado por navegador (ex: Chrome → PowerShell) | Security | Detecta spawn de processos perigosos a partir do navegador. | <rule id="8049" level="9"><field name="win.eventdata.parentImage">*chrome.exe*</field><field name="win.eventdata.image">*powershell.exe*</field><description>Navegador iniciou PowerShell.</description></rule> | Isolar endpoint. Verificar histórico de navegação e arquivos baixados. |
| Sysmon | Uso de ferramenta de rede não autorizada (ex: nmap) | Security | Detecta execução de binários de varredura localmente. | <rule id="8050" level="9"><field name="win.eventdata.image">*nmap.exe*</field><description>Execução de ferramenta de varredura.</description></rule> | Remover binários suspeitos. Auditar instalação e justificar presença. |
| Sysmon | Processo tentou acessar credenciais armazenadas (ex: LSASS) | Security | Detecta tentativa de acesso ao processo lsass.exe. | <rule id="8051" level="10"><field name="win.eventdata.image">*mimikatz.exe*</field><description>Acesso a LSASS por ferramenta suspeita.</description></rule> | Isolar host. Reforçar Proteção de Credenciais via Credential Guard. |
| Sysmon | Script HTA foi executado via mshta.exe | Security | Detecta execução de payload HTA com mshta.exe. | <rule id="8052" level="10"><field name="win.eventdata.image">*mshta.exe</field><description>Execução de HTA via mshta.</description></rule> | Bloquear mshta.exe. Verificar conteúdo de scripts HTA. |
| Sysmon | Uso de processo LOLBin para evasão (ex: regsvr32 com URL) | Security | Detecta uso de living-off-the-land binaries com argumentos maliciosos. | <rule id="8053" level="10"><field name="win.eventdata.commandLine">*regsvr32*http*</field><description>LOLBin usado para evasão.</description></rule> | Aplicar bloqueio via AppLocker. Monitorar uso não interativo de binários do sistema. |
| Sysmon | Prompt de comando do Windows iniciado por um processo anômalo | Security | Detecta o cmd.exe sendo iniciado por um processo não usual, indicando possível execução maliciosa via dropper. | <rule id="8054" level="9"><field name="win.eventdata.image">*\\cmd.exe</field><field name="win.eventdata.parentImage">!*\\Windows\\*</field><description>Cmd.exe iniciado por processo anômalo.</description></rule> | Verificar processo pai. Auditar execução com cmd via políticas de integridade. |
| Sysmon | Processo suspeito lançado com assinatura de mecanismo jscript | Security | Detecta processos que possuem assinatura indicando JScript como mecanismo, comumente usado para execução de payloads. | <rule id="8055" level="10"><field name="win.eventdata.originalFileName">jscript.dll</field><description>Processo com assinatura jscript.dll.</description></rule> | Investigar origem do script. Bloquear execução de scripts não assinados. |
| Sysmon | Execução suspeita de arquivo .js por $(win.eventdata.image) | Security | Detecta execução de scripts .js via mecanismos como wscript ou mshta. | <rule id="8056" level="9"><field name="win.eventdata.commandLine">*.js*</field><description>Execução suspeita de arquivo .js.</description></rule> | Restringir execução de .js. Monitorar processos relacionados como wscript e cscript. |
| Sysmon | Utilitário conhecido auto-elevado $(win.eventdata.originalFileName) pode ter sido usado para contornar o UAC | Security | Detecta execução de binário com capacidade de autoelevação (ex: eventvwr.exe, fodhelper.exe). | <rule id="8057" level="10"><field name="win.eventdata.originalFileName">*eventvwr.exe|fodhelper.exe*</field><description>Possível bypass de UAC via autoelevado.</description></rule> | Auditar uso desses binários. Remover permissões desnecessárias. |
| Sysmon | Processo Powershell invocou utilitário auto-elevado $(win.eventdata.originalFileName), pode ter sido usado para contornar o UAC | Security | Detecta PowerShell lançando binários conhecidos por contornar UAC. | <rule id="8058" level="10"><field name="win.eventdata.parentImage">*powershell.exe*</field><field name="win.eventdata.originalFileName">fodhelper.exe|eventvwr.exe</field><description>Bypass UAC via PowerShell e autoelevado.</description></rule> | Aplicar AppLocker. Correlacionar com execução anterior. |
| Sysmon | Powershell.exe gerou um processo Powershell que executou um comando codificado em base64 | Security | Detecta execução de comandos codificados via PowerShell spawnando outra instância. | <rule id="8059" level="10"><field name="win.eventdata.parentImage">*powershell.exe*</field><field name="win.eventdata.commandLine">*EncodedCommand*</field><description>Powershell com comando codificado base64.</description></rule> | Ativar desofuscação de logs. Limitar execução em cascata. |
| Sysmon | Banco de Dados de Compatibilidade de Aplicativos lançado | Change | Detecta execução de sdbinst.exe, usado para instalar shims de compatibilidade. | <rule id="8060" level="7"><field name="win.eventdata.image">*sdbinst.exe*</field><description>Lançamento de banco de dados de compatibilidade.</description></rule> | Verificar se há instalação de shim malicioso. Monitorar persistência. |
| Sysmon | Possível Shimming. Banco de Dados de Compatibilidade de Aplicativos lançado de um comando powershell codificado | Security | Detecta instalação de shim via PowerShell com comando codificado. | <rule id="8061" level="10"><field name="win.eventdata.image">*sdbinst.exe*</field><field name="win.eventdata.parentImage">*powershell.exe*</field><field name="win.eventdata.commandLine">*EncodedCommand*</field><description>Shim instalado via PowerShell codificado.</description></rule> | Bloquear sdbinst para usuários padrão. Monitorar shims aplicados. |
| Sysmon | Processo suspeito (caractere de substituição de direita para esquerda) gerou um subprocesso | Security | Detecta mascaramento de arquivos com uso de caracteres especiais unicode. | <rule id="8062" level="10"><field name="win.eventdata.image">*\\*.exe*</field><field name="win.eventdata.originalFileName">*&#x202E;*</field><description>Processo com RTL override gerando subprocesso.</description></rule> | Inspecionar nome real do executável. Bloquear nomes com caracteres unicode perigosos. |
| Sysmon | Ferramenta de backup e restauração do Windows $(win.eventdata.originalFileName) lançada por $(win.eventdata.parentImage) com nível de integridade $(win.eventdata.integrityLevel) | Security | Detecta execução de ferramentas sensíveis com nível de integridade elevado. | <rule id="8063" level="9"><field name="win.eventdata.originalFileName">sdclt.exe|wbadmin.exe</field><description>Ferramenta de backup executada com integridade elevada.</description></rule> | Restringir execução a administradores. Verificar contexto de uso. |
| Sysmon | Powershell iniciado com nível de integridade $(win.eventdata.integrityLevel) por $(win.eventdata.parentImage) | Security | Detecta PowerShell executado com alta integridade por processos inusuais. | <rule id="8064" level="9"><field name="win.eventdata.image">*powershell.exe*</field><field name="win.eventdata.integrityLevel">High</field><description>PowerShell iniciado com alta integridade.</description></rule> | Bloquear PowerShell em alta integridade fora de sessões administrativas. |
| Sysmon | Exclusão de arquivo por $(win.eventdata.originalFileName). Comando: $(win.eventdata.commandLine) | Change | Detecta uso de comandos de exclusão, indicando limpeza de rastros. | <rule id="8065" level="8"><field name="win.eventdata.commandLine">*del*|*Remove-Item*</field><description>Exclusão de arquivos detectada.</description></rule> | Correlacionar com ações anteriores. Verificar se houve exfiltração antes. |
| Sysmon | Processo suspeito executado com caractere de substituição de direita para esquerda no arquivo binário, possível mascaramento de arquivo malicioso | Security | Detecta binário com nome mascarado via técnica de RTL override. | <rule id="8066" level="10"><field name="win.eventdata.image">*&#x202E;*</field><description>Mascaramento de nome de arquivo com RTL override.</description></rule> | Bloquear caracteres especiais em nomes de arquivos executáveis. |
| Sysmon | Powershell.exe iniciado por binário $(win.eventdata.parentImage) em localização suspeita | Security | Detecta spawn de PowerShell por processo não confiável em local anômalo. | <rule id="8067" level="9"><field name="win.eventdata.image">*powershell.exe*</field><field name="win.eventdata.parentImage">*AppData*|*Temp*</field><description>PowerShell iniciado por binário em local suspeito.</description></rule> | Reforçar proteção em AppData. Isolar binário pai para análise. |
| Sysmon | Binário $(win.eventdata.image) em localização suspeita iniciado por $(win.eventdata.parentImage) | Security | Detecta execução de binários em diretórios não convencionais. | <rule id="8068" level="9"><field name="win.eventdata.image">*AppData*|*Temp*</field><description>Binário em localização suspeita executado.</description></rule> | Auditar processos. Bloquear execução em diretórios temporários. |
| Sysmon | $(win.eventdata.image) iniciado por $(win.eventdata.parentImage) executou um comando de criação de arquivo comprimido | Security | Detecta uso de ferramentas como makecab, compact, compress-archive via spawn indireto. | <rule id="8069" level="8"><field name="win.eventdata.commandLine">*makecab*|*Compress-Archive*</field><description>Criação de arquivo comprimido detectada.</description></rule> | Auditar conteúdo do arquivo gerado. Verificar possíveis exfiltrações. |
| Sysmon | Atividade suspeita de DCOM/RPC do processo PowerShell | Security | Detecta uso do PowerShell para executar comandos remotos via DCOM/RPC, possível vetor lateral de movimentação. | <rule id="11001" level="10"> <if_sid>4104</if_sid> <field name="win.eventdata.scriptBlockText">DCOM</field> <description>PowerShell com atividade DCOM/RPC suspeita.</description> </rule> | Investigar origem da execução. Restringir uso de DCOM/RPC via PowerShell. |
| Sysmon | Atividade LDAP do processo PowerShell, possível descoberta remota de sistema | Security | Detecta comandos de enumeração LDAP executados por PowerShell, geralmente usados para descobrir ativos na rede. | <rule id="11002" level="10"> <if_sid>4104</if_sid> <field name="win.eventdata.scriptBlockText">LDAP://</field> <description>PowerShell com comandos de enumeração LDAP.</description> </rule> | Monitorar comandos, restringir execução de scripts desconhecidos. |
| Sysmon | Binário suspeito criado conectando-se à rede com $(win.eventdata.destinationIp):$(win.eventdata.destinationPort) | Security | Detecta binário gerando tráfego de rede suspeito, possível malware ou beacon. | <rule id="11003" level="10"> <if_sid>3</if_sid> <field name="win.eventdata.destinationPort">.*</field> <description>Binário gerando tráfego de rede suspeito.</description> </rule> | Analisar o binário, aplicar bloqueios por reputação/IP. |
| Sysmon | Acesso suspeito aos compartilhamentos administrativos do Windows | Security | Detecta acesso não autorizado aos compartilhamentos como ADMIN$, C$, etc. | <rule id="11004" level="10"> <if_sid>3</if_sid> <field name="win.eventdata.shareName">ADMIN$</field> <description>Acesso suspeito aos compartilhamentos administrativos.</description> </rule> | Aplicar segmentação de rede e autenticação forte. |
| Sysmon | Atividade do processo do sistema do Windows via porta SMB - Possível acesso suspeito aos compartilhamentos administrativos do Windows | Security | Detecta uso de SMB por processos inesperados para acessar recursos administrativos. | <rule id="11005" level="10"> <if_sid>3</if_sid> <field name="win.eventdata.destinationPort">445</field> <description>Uso anômalo da porta SMB.</description> </rule> | Restringir portas SMB para usuários e processos não autorizados. |
| Sysmon | Script gerou atividade suspeita na rede via protocolo TCP | Security | Detecta script executando conexão TCP, sinal potencial de beaconing ou C2. | <rule id="11006" level="10"> <if_sid>3</if_sid> <field name="win.eventdata.image">powershell.exe</field> <description>Script gerou tráfego de rede suspeito via TCP.</description> </rule> | Monitorar IPs de destino e comportamento do script. |
| Sysmon | Atividade de rede detectada via porta RDP de $(win.eventdata.sourceIp) para $(win.eventdata.destinationIp) | Security | Detecta uso de RDP a partir de hosts incomuns ou automatizados. | <rule id="11007" level="10"> <if_sid>3</if_sid> <field name="win.eventdata.destinationPort">3389</field> <description>Atividade de rede via RDP suspeita.</description> </rule> | Investigar origens, aplicar MFA e lista de controle de acesso. |
| Sysmon | Atividade de rede via porta RDP de endereço de loopback, possível exploração usando túnel reverso | Security | Detecta conexões RDP locais usando 127.0.0.1 como destino. | <rule id="11008" level="10"> <if_sid>3</if_sid> <field name="win.eventdata.destinationIp">127.0.0.1</field> <description>Uso de loopback em conexão RDP.</description> </rule> | Verificar se há túnel reverso ativo e processos associados. |
| Sysmon | Atividade de WinRM detectada de $(win.eventdata.sourceIp) para $(win.eventdata.destinationIp) | Security | Detecta uso de WinRM entre máquinas, vetor comum de movimentação lateral. | <rule id="11009" level="10"> <if_sid>3</if_sid> <field name="win.eventdata.destinationPort">5985</field> <description>Conexão suspeita via WinRM.</description> </rule> | Verificar se máquinas deveriam se comunicar via WinRM. |
| Sysmon | Binário carregou biblioteca de automação PowerShell - Possível execução não gerenciada do PowerShell por processo suspeito | Security | Detecta uso de DLLs de automação do PowerShell fora de contexto normal. | <rule id="11010" level="10"> <if_sid>7</if_sid> <field name="win.eventdata.imageLoaded">System.Management.Automation.dll</field> <description>DLL de automação PowerShell carregada por processo suspeito.</description> </rule> | Verificar processo pai, restringir uso externo do PowerShell. |
| Sysmon | Serviço de spooler de impressora carregou um arquivo DLL. Possível exploração do PrintNightmare: CVE-2021-34527 | Security | Detecta tentativa de exploração do PrintNightmare via spoolsv.exe. | <rule id="11011" level="12"> <if_sid>7</if_sid> <field name="win.eventdata.image">spoolsv.exe</field> <description>Spooler carregou DLL – possível CVE-2021-34527.</description> </rule> | Atualizar patches, monitorar atividade do spoolsv.exe. |
| Sysmon | Processo suspeito carregou o módulo VaultCli.dll. Possível uso para despejar senhas armazenadas. | Security | Detecta tentativa de acesso ao Gerenciador de Credenciais via DLL. | <rule id="11012" level="12"> <if_sid>7</if_sid> <field name="win.eventdata.imageLoaded">VaultCli.dll</field> <description>VaultCli.dll carregado por processo suspeito.</description> </rule> | Bloquear ferramentas não autorizadas, monitorar acessos. |
| Sysmon | Processo carregou o módulo taskschd.dll. Pode ser usado para criar execução atrasada de malware | Security | Detecta abuso da DLL do Agendador de Tarefas do Windows para persistência. | <rule id="11013" level="10"> <if_sid>7</if_sid> <field name="win.eventdata.imageLoaded">taskschd.dll</field> <description>taskschd.dll carregada por processo incomum.</description> </rule> | Verificar persistência e agendamentos novos. |
| Sysmon | Mshta carregou o módulo taskschd.dll. Pode ser usado para criar execução atrasada de malware | Security | Detecta uso de mshta.exe com DLLs de agendamento, vetor comum de malware. | <rule id="11014" level="12"> <if_sid>7</if_sid> <field name="win.eventdata.image">mshta.exe</field> <description>mshta.exe com DLL de agendamento.</description> </rule> | Bloquear mshta onde não for necessário. |
| Sysmon | Aplicativo Office carregou o módulo vbeui.dll. Pode ser usado para executar código de script | Security | Detecta macros do Office ativando execução de script via vbeui.dll. | <rule id="11015" level="10"> <if_sid>7</if_sid> <field name="win.eventdata.imageLoaded">vbeui.dll</field> <description>Office carregando vbeui.dll – possível macro maliciosa.</description> </rule> | Desabilitar macros e alertar sobre execuções suspeitas. |
| Sysmon | Um executável - $(win.eventdata.image) - carregou $(win.eventdata.imageLoaded) do diretório Temp | Security | Detecta binários carregando DLLs da pasta Temp – comportamento anômalo. | <rule id="11016" level="10"> <if_sid>7</if_sid> <field name="win.eventdata.imageLoaded">.*Temp.*</field> <description>DLL carregada de diretório Temp.</description> </rule> | Investigar origem e assinatura digital do binário. |
| Sysmon | Arquivo de script criado na pasta Temp ou de usuário do Windows | Change | Detecta criação de arquivos .ps1/.vbs/.js em locais suspeitos. | <rule id="11017" level="8"> <if_sid>11</if_sid> <field name="win.eventdata.targetFilename">.*\\Temp\\.*</field> <description>Script criado em pasta temporária.</description> </rule> | Aplicar controles de escrita por usuário e monitorar alterações. |
| Sysmon | $(win.eventdata.image) criou um novo arquivo de script na pasta Temp ou de dados de usuário do Windows | Change | Detecta processo criando scripts em local temporário, potencial vetor de execução maliciosa. | <rule id="11018" level="8"> <if_sid>11</if_sid> <field name="win.eventdata.targetFilename">.*\\Users\\.*\\Temp.*</field> <description>Criação de script por processo suspeito.</description> </rule> | Aplicar monitoramento em tempo real e resposta a IOC. |
| Sysmon | Executável foi criado na pasta raiz do Windows pelo processo $(win.eventdata.image). Possível abuso de compartilhamentos administrativos do Windows | Security | Detecta criação de executáveis em C:\ por processos remotos. | <rule id="11019" level="12"> <if_sid>11</if_sid> <field name="win.eventdata.targetFilename">C:\\.*\.exe</field> <description>Criação de executável na raiz do sistema.</description> </rule> | Auditar compartilhamentos administrativos. |
| Sysmon | Arquivo executável criado pelo PowerShell: $(win.eventdata.targetFilename) | Security | Detecta scripts PowerShell que geram binários executáveis, sinal comum de malware. | <rule id="11020" level="12"> <if_sid>11</if_sid> <field name="win.eventdata.image">powershell.exe</field> <description>PowerShell criando binário executável.</description> </rule> | Restringir permissões de gravação e execução. |
| Sysmon | Processo PowerShell criou arquivo executável na pasta temporária do AppData | Security | Detecta escrita de binários em local privilegiado via PowerShell. | <rule id="11021" level="12"> <if_sid>11</if_sid> <field name="win.eventdata.targetFilename">.*\\AppData\\Local\\Temp.*\.exe</field> <description>Binário criado por PowerShell no AppData.</description> </rule> | Bloquear execução em caminhos temporários e revisar políticas. |
| Sysmon | Novo serviço do Windows criado para iniciar da pasta raiz do Windows | Security | Detecta criação de serviço que inicia a partir da raiz do sistema, indicando possível uso de compartilhamentos administrativos por malware. | <rule id="10001" level="10"> <if_sid>61601</if_sid> <field name="win.system.providerName">Service Control Manager</field> <field name="win.eventdata.imagePath">C:\*</field> <description>Novo serviço criado a partir da raiz do Windows</description> </rule> | Investigar o serviço criado, verificar origem do binário e reforçar controle sobre compartilhamentos administrativos. |
| Sysmon | Logon remoto bem-sucedido pelo usuário | Security | Detecta logons remotos que podem indicar acesso lateral, uso indevido de credenciais ou administração remota. | <rule id="10002" level="7"> <if_sid>61602</if_sid> <field name="win.eventdata.ipAddress">*</field> <description>Logon remoto bem-sucedido pelo usuário</description> </rule> | Validar IPs remotos, cruzar com horário e atividades, e aplicar MFA para acessos externos. |
| Sysmon | Logon remoto com autenticação NTLM | Security | Autenticação NTLM em logons remotos pode indicar ataque pass-the-hash. | <rule id="10003" level="10"> <if_sid>61603</if_sid> <field name="win.eventdata.authenticationPackageName">NTLM</field> <description>Logon remoto via NTLM</description> </rule> | Desabilitar NTLM sempre que possível e reforçar auditoria de credenciais privilegiadas. |
| Sysmon | Login via RDP com IP externo | Security | Detecta acesso via RDP com IP externo, comum em casos de brute-force ou exploração via credenciais vazadas. | <rule id="10004" level="10"> <if_sid>61604</if_sid> <field name="win.eventdata.logonType">10</field> <description>Login via RDP com IP externo</description> </rule> | Restringir RDP por firewall, usar VPN, habilitar alertas de falha de logon e aplicar MFA. |
| Sysmon | Consulta WMI para inventário de sistema | Recon | Detecta tentativa de mapeamento de sistema via WMI, técnica comum em movimentação lateral. | <rule id="10005" level="7"> <if_sid>61605</if_sid> <field name="win.eventdata.query">Select * from Win32_*</field> <description>Consulta WMI suspeita</description> </rule> | Investigar origem da consulta e correlacionar com outros sinais de enumeração ou lateral movement. |
| Sysmon | Erro no driver de impressora - possível PrinterNightmare | Security | Falha ao carregar driver de impressora pode ser indicativo de exploração CVE-2021-34527. | <rule id="10006" level="10"> <if_sid>61606</if_sid> <field name="win.eventdata.eventID">808</field> <description>Possível exploração PrinterNightmare</description> </rule> | Desabilitar spooler quando não necessário e aplicar patch do CVE-2021-34527. |
| Sysmon | Login via RDP usando endereço de loopback | Security | Indicador de uso de túnel reverso, possivelmente após uso de credenciais roubadas. | <rule id="10007" level="10"> <if_sid>61607</if_sid> <field name="win.eventdata.ipAddress">127.0.0.1</field> <description>Login RDP via loopback</description> </rule> | Verificar se há túnel reverso ativo e revisar segurança de contas com histórico de uso RDP. |
| Sysmon | Conexão RDP com NTLM suspeita + workstationName | Security | Combinação de logon via NTLM e workstationName pode indicar ataque lateral ou sequestro de sessão RDP. | <rule id="10008" level="9"> <if_sid>61608</if_sid> <field name="win.eventdata.authenticationPackageName">NTLM</field> <field name="win.eventdata.workstationName">*</field> <description>Possível uso indevido de RDP com NTLM</description> </rule> | Auditar sessões RDP abertas, revisar contas de serviço e aplicar segmentação de rede. |
| Audit | Script Python executado | Security | Execução de script Python pode indicar automação, testes ou movimento lateral em ambientes Linux. | <rule id="10009" level="7"> <if_sid>61609</if_sid> <field name="audit.process.name">python</field> <description>Script Python executado</description> </rule> | Revisar contexto do script, validar usuários e restringir execução remota não autorizada. |
| Audit | Script Python executado da pasta /tmp/ | Security | Scripts em /tmp são frequentemente usados por malware por serem áreas temporárias e sem restrição. | <rule id="10010" level="9"> <if_sid>61610</if_sid> <field name="audit.process.path">/tmp/*</field> <description>Python executado de /tmp</description> </rule> | Monitorar scripts em áreas temporárias, configurar AppArmor/SELinux e criar alertas proativos. |
| Audit | Script Python semelhante ao Impacket | Security | Detecta padrões conhecidos de ferramentas de pentest como Impacket. | <rule id="10011" level="10"> <if_sid>61611</if_sid> <field name="audit.command">impacket*</field> <description>Assinatura de Impacket</description> </rule> | Investigar origem do script, bloquear lateral movement e reforçar segmentação da rede. |
| Audit | Arquivo copiado via SCP | Recon | Transferência de arquivos por SCP pode indicar movimentação lateral ou exfiltração. | <rule id="10012" level="7"> <if_sid>61612</if_sid> <field name="audit.process.name">scp</field> <description>Transferência de arquivo via SCP</description> </rule> | Monitorar transferências SCP entre hosts internos e aplicar controle de tráfego SSH. |
| Audit | Execução do comando ps | Recon | Listagem de processos pode indicar coleta de informações por atacante. | <rule id="10013" level="6"> <if_sid>61613</if_sid> <field name="audit.command">ps aux</field> <description>Consulta de processos suspeita</description> </rule> | Validar origem do comando e rastrear atividade do usuário no tempo. |
| Audit | Execução do comando ls recursivo | Recon | Comando `ls -R` pode indicar enumeração agressiva de arquivos e diretórios. | <rule id="10014" level="6"> <if_sid>61614</if_sid> <field name="audit.command">ls -R</field> <description>Enumeração de arquivos via ls</description> </rule> | Verificar shell/script que executou a consulta e analisar objetivo da ação. |
| Audit | Uso do PsExec via CMD | Lateral Movement | Uso do PsExec é comum em movimentações laterais por atacantes. | <rule id="10015" level="9"> <if_sid>61615</if_sid> <field name="audit.command">PsExec.exe</field> <description>Execução de PsExec</description> </rule> | Bloquear PsExec via políticas de aplicação e auditar uso em estações críticas. |
| Audit | Uso do Nmap detectado | Recon | Detecta scanner de rede. Possível reconhecimento pré-ataque. | <rule id="10016" level="7"> <if_sid>61616</if_sid> <field name="audit.command">nmap</field> <description>Uso de Nmap</description> </rule> | Correlacionar com tráfego de rede e revisar logs para determinar objetivo do escaneamento. |
| Sysmon | Registro modificado para execução no próximo logon | Persistence | Entrada no registro pode garantir persistência para malware ou ferramentas remotas. | <rule id="10017" level="9"> <if_sid>61617</if_sid> <field name="win.eventdata.targetObject">*Run*</field> <description>Persistência via registro</description> </rule> | Auditar entradas Run e RunOnce, validar integridade de chaves e bloquear executáveis suspeitos. |
| Sysmon | Extensão de arquivo incomum em chave de inicialização | Persistence | Uso de extensões incomuns em chaves de registro pode indicar evasão de detecção. | <rule id="10018" level="8"> <if_sid>61618</if_sid> <field name="win.eventdata.targetObject">*.jpg</field> <description>Extensão incomum em inicialização</description> </rule> | Verificar conteúdo real do arquivo e impedir execução de extensões não autorizadas. |
| Sysmon | Entrada no registro alterada via reg.exe | Persistence | Modificação de chave de inicialização usando reg.exe pode indicar script automatizado ou malware. | <rule id="10019" level="8"> <if_sid>61619</if_sid> <field name="win.eventdata.image">reg.exe</field> <description>Modificação de chave de inicialização via reg.exe</description> </rule> | Auditar comandos com reg.exe e revisar contexto do processo pai. |
| Sysmon | Registro aponta para ferramenta de acesso remoto | Persistence | Entradas do registro que executam ferramentas como TeamViewer, AnyDesk, etc. podem ser suspeitas. | <rule id="10020" level="9"> <if_sid>61620</if_sid> <field name="win.eventdata.details">AnyDesk</field> <description>Persistência via ferramenta de acesso remoto</description> </rule> | Validar uso autorizado da ferramenta e revisar logs de acesso remoto. |
| Sysmon | Chave de registro modificada associada ao bypass de UAC por processos autoelevados | Security | Detecta modificações suspeitas em chaves de registro que indicam tentativas de bypass de UAC por elevação de privilégio automatizada | <rule id="20010" level="10"> <if_sid>61600</if_sid> <field name="win.eventdata.targetObject">.*(uac)|(elevation)</field> <description>Chave de registro suspeita modificada para bypass de UAC</description> </rule> | Verificar a origem do processo responsável e aplicar política de bloqueio para alterações não autorizadas nas chaves de execução automática. |
| Sysmon | Interpretador de comandos adicionado à chave do registro associada ao bypass de UAC por processos autoelevados | Security | Uso de cmd.exe ou powershell.exe em chaves do registro que iniciam com privilégios elevados pode indicar persistência ou escalonamento de privilégio | <rule id="20011" level="12"> <if_sid>61600</if_sid> <field name="win.eventdata.details">.*(cmd\.exe|powershell\.exe)</field> <description>Adição de interpretador de comandos em chave de registro com privilégios elevados</description> </rule> | Revisar o autor da modificação, bloquear execução automática, e aplicar hardening das permissões do registro. |
| Sysmon | $(win.eventdata.image) adicionado ao registro uma subchave associada ao bypass de UAC por processos autoelevados | Security | Identifica programas adicionando entradas de inicialização automática com privilégios elevados | <rule id="20012" level="10"> <if_sid>61600</if_sid> <field name="win.eventdata.image">.*</field> <description>Programa adicionado a subchave de inicialização com bypass UAC</description> </rule> | Investigar qual aplicação fez a modificação e se corresponde a atividade legítima. |
| Sysmon | Evidência de criação de novo serviço encontrada no registro sob $(win.eventdata.targetObject) o binário é: $(win.eventdata.details). | Security | Detecta criação de serviços via modificação de chaves de registro, comum em ataques de persistência | <rule id="20013" level="11"> <if_sid>61600</if_sid> <field name="win.eventdata.targetObject">.*\\Services\\.*</field> <description>Criação de serviço no registro</description> </rule> | Verificar se o serviço é autorizado e validar integridade do binário indicado. |
| Sysmon | Possível evidência de Hijacking de COM encontrada no registro sob $(win.eventdata.targetObject) o binário é: $(win.eventdata.details). | Security | Detecta possível persistência por meio de COM hijacking através de manipulação de CLSID | <rule id="20014" level="12"> <if_sid>61600</if_sid> <field name="win.eventdata.targetObject">.*CLSID.*</field> <description>Suspeita de COM hijacking via modificação no registro</description> </rule> | Auditar atividade do usuário e impedir alteração indevida de entradas CLSID. |
| Sysmon | Evidência de Hijacking de COM encontrada no registro sob $(win.eventdata.targetObject) binário suspeito é: $(win.eventdata.details). | Security | Confirma manipulação de CLSID com caminho para binários não autorizados, indicando persistência ou execução maliciosa | <rule id="20015" level="13"> <if_sid>61600</if_sid> <field name="win.eventdata.details">.*(AppData|Temp|Downloads).*\.exe</field> <description>COM Hijacking confirmado com binário não confiável</description> </rule> | Isolar o host e remover entrada de registro maliciosa; aplicar GPOs que previnam modificações em CLSID. |
| Sysmon | Possível injeção de código no explorer.exe por $(win.eventdata.sourceImage). | Security | Detecta tentativa de injeção no processo do Windows Explorer, uma técnica comum para execução encoberta | <rule id="20016" level="13"> <if_sid>61700</if_sid> <field name="win.eventdata.targetImage">.*explorer.exe</field> <description>Injeção detectada no explorer.exe</description> </rule> | Investigar se o processo injetor é legítimo; considerar bloqueio via AppLocker ou WDAC. |
| Sysmon | Possível injeção de código no mstsc.exe (utilitário RDP do Windows) por $(win.eventdata.sourceImage). | Security | Detecta tentativa de injeção no Remote Desktop Client, possível ataque de coleta de credenciais | <rule id="20017" level="14"> <if_sid>61700</if_sid> <field name="win.eventdata.targetImage">.*mstsc.exe</field> <description>Injeção no mstsc.exe detectada</description> </rule> | Validar se houve conexão remota em paralelo; revisar origem do processo injetor. |
| Sysmon | Possível injeção de código por $(win.eventdata.sourceImage) em $(win.eventdata.targetImage). | Security | Gatilho genérico para detecção de injeções entre processos | <rule id="20018" level="12"> <if_sid>61700</if_sid> <field name="win.eventdata.sourceImage">.*</field> <description>Injeção de processo detectada</description> </rule> | Analisar relação entre processos; considerar isolamento e uso de EDR para rastrear cadeia de execução. |
| Sysmon | Chave de registro modificada associada ao bypass de UAC por processos autoelevados | Security | Detecta alterações no registro relacionadas a bypass de Controle de Conta de Usuário (UAC) por processos que executam com privilégios elevados automaticamente, possível atividade maliciosa de elevação de privilégios. | <rule id="11022" level="12"> <if_sid>13</if_sid> <field name="win.eventdata.targetObject">.*UAC.*</field> <description>Bypass de UAC detectado por modificação no registro.</description> </rule> | Monitorar alterações no registro, restringir privilégios de execução e validar assinaturas digitais. |
| Sysmon | Interpretador de comandos adicionado à chave do registro associada ao bypass de UAC por processos autoelevados | Security | Detecta inclusão de interpretadores de comando no registro de bypass de UAC, indicando possível execução de comandos maliciosos com elevação. | <rule id="11023" level="12"> <if_sid>13</if_sid> <field name="win.eventdata.details">.*cmd.exe|powershell.exe.*</field> <description>Interpretador de comando adicionado no bypass de UAC.</description> </rule> | Bloquear alterações indevidas no registro e monitorar execução de scripts suspeitos. |
| Sysmon | $(win.eventdata.image) adicionado ao registro uma subchave associada ao bypass de UAC por processos autoelevados | Security | Detecta processos que adicionam entradas no registro para persistência com bypass de UAC, possível técnica de malware. | <rule id="11024" level="12"> <if_sid>13</if_sid> <field name="win.eventdata.image">.*</field> <description>Subchave adicionada ao registro para bypass de UAC.</description> </rule> | Auditar processos que modificam registro, alertar alterações suspeitas. |
| Sysmon | Evidência de criação de novo serviço encontrada no registro sob $(win.eventdata.targetObject) o binário é: $(win.eventdata.details). | Security | Detecta criação de serviço do Windows via registro, que pode ser legítimo ou usado por malware para persistência. | <rule id="11025" level="10"> <if_sid>13</if_sid> <field name="win.eventdata.targetObject">.*services.*</field> <description>Criação de novo serviço detectada no registro.</description> </rule> | Validar serviço criado, revisar permissões e origem do binário. |
| Sysmon | Possível evidência de Hijacking de COM encontrada no registro sob $(win.eventdata.targetObject) o binário é: $(win.eventdata.details). | Security | Detecta manipulação de entradas COM no registro, técnica usada para injeção e persistência maliciosa. | <rule id="11026" level="12"> <if_sid>13</if_sid> <field name="win.eventdata.targetObject">.*COM.*</field> <description>Hijacking de COM detectado no registro.</description> </rule> | Investigar alterações, bloquear processos suspeitos. |
| Sysmon | Evidência de Hijacking de COM encontrada no registro sob $(win.eventdata.targetObject) binário suspeito é: $(win.eventdata.details). | Security | Detecta entradas COM com binários não confiáveis, indicativo de malware tentando controle de componentes. | <rule id="11027" level="12"> <if_sid>13</if_sid> <field name="win.eventdata.details">.*suspeito.*</field> <description>Hijacking de COM com binário suspeito.</description> </rule> | Revisar assinaturas dos binários, alertar equipe de segurança. |
| Sysmon | Possível injeção de código no explorer.exe por $(win.eventdata.sourceImage). | Security | Detecta processos que tentam injetar código dentro do processo explorer.exe, técnica usada para persistência e evasão. | <rule id="11028" level="12"> <if_sid>8</if_sid> <field name="win.eventdata.targetImage">explorer.exe</field> <description>Injeção de código detectada em explorer.exe.</description> </rule> | Monitorar processos e suas injeções, bloquear ferramentas suspeitas. |
| Sysmon | Possível injeção de código no mstsc.exe (utilitário RDP do Windows) por $(win.eventdata.sourceImage). | Security | Detecta tentativa de injeção de código no mstsc.exe, pode indicar manipulação de sessão RDP. | <rule id="11029" level="12"> <if_sid>8</if_sid> <field name="win.eventdata.targetImage">mstsc.exe</field> <description>Injeção de código detectada em mstsc.exe.</description> </rule> | Auditar conexões RDP e processos associados. |
| Sysmon | Possível injeção de código por $(win.eventdata.sourceImage) em $(win.eventdata.targetImage). | Security | Detecta injeção de código genérica entre processos, indício forte de atividade maliciosa. | <rule id="11030" level="12"> <if_sid>8</if_sid> <field name="win.eventdata.sourceImage">.*</field> <field name="win.eventdata.targetImage">.*</field> <description>Injeção de código entre processos detectada.</description> </rule> | Implementar monitoramento e bloqueio de injeção de código. |
| Audit | Grupo de regras para monitorar execução de comandos PowerShell, útil para auditoria e investigação. | <rule id="20108" level="5"><if_sid>91000</if_sid><field name="win.system.channel">Microsoft-Windows-PowerShell/Operational</field><description>Monitoramento canal PowerShell/Operational</description></rule> | Habilitar auditoria de script e alertas para comandos suspeitos. Windows PowerShell | Grupo de regras do Windows para o canal Powershell/Operational. |  |

## CIS CONTROL